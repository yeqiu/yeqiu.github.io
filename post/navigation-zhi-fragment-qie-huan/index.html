<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Navigation ä¹‹ Fragment åˆ‡æ¢ | Jiang</title>
<link rel="shortcut icon" href="https://cherrylover.github.io/favicon.ico?v=1565058747395">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cherrylover.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143284233-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143284233-1');
</script>

  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://cherrylover.github.io">
  <img class="avatar" src="https://cherrylover.github.io/images/avatar.png?v=1565058747395" alt="">
  </a>
  <h1 class="site-title">
    Jiang
  </h1>
  <p class="site-description">
    æˆ‘å…è®¸ä½ èµ°è¿›æˆ‘çš„ä¸–ç•Œï¼Œä½†ä¸è®¸ä½ åœ¨æˆ‘çš„ä¸–ç•Œé‡Œèµ°æ¥èµ°å»ã€‚
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/CherryLover" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
        <a href="https://juejin.im/user/576d73cd0a2b58006a09ad87" target="_blank">
          <i class="fab fa-weibo"></i>
        </a>
      
    
      
    
      
    
  </div>
</div>

      
        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Navigation ä¹‹ Fragment åˆ‡æ¢
            </h2>
            <div class="post-info">
              <time class="post-time">
                Â· 2019-07-24 Â·
              </time>
              
                <a href="https://cherrylover.github.io/tag/J97-m2V0f" class="post-tags">
                  # Jetpack è¿½æ–°
                </a>
              
                <a href="https://cherrylover.github.io/tag/37yorOBW4" class="post-tags">
                  # æŒç»­å­¦ä¹ 
                </a>
              
                <a href="https://cherrylover.github.io/tag/Mk4HmBIQ7" class="post-tags">
                  # Android
                </a>
              
            </div>
            
              <div class="post-feature-image" style="background-image: url('https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_nav_state.jpg')">
              </div>
            
            <div class="post-content">
              <p>æœ¬ç¯‡æ˜¯æœ‰å…³ Navigation çš„ç¬¬äºŒç¯‡ï¼Œå¦‚æœ‰å¯¹ Navigation ä¸äº†è§£çš„æœ‹å‹è¯·å…ˆé˜…è¯»<a href="https://jiangjiwei.site/post/lai-xue-yi-bo-navigation/">æ¥å­¦ä¸€æ³¢ Navigation</a>ã€‚</p>
<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ Navigation ä¸ BottomNavigationView åšå‡ºäº†ä¸€ä¸ªæœ‰ä¸‰ä¸ª Tab çš„é¡µé¢ï¼Œåˆ†åˆ«æ˜¯ Feedã€Timerã€Mineï¼Œè¿™ä¸‰ä¸ª Fragment éƒ½æ˜¯åªåœ¨å½“å‰é¡µé¢æ˜¾ç¤ºå„è‡ªçš„åç§°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥ç»™ TimerFragment åŠ ç‚¹å†…å®¹ï¼Œæˆ‘ä»¬åœ¨ TimerFragment çš„ onCreateView æ–¹æ³•ä¸­å¯åŠ¨ä¸€ä¸ªå€’è®¡æ—¶ã€‚</p>
<pre><code class="language-java">private void startTimer() {
    new CountDownTimer(10 * 1000, 1000) {

        @Override
        public void onTick(long millisUntilFinished) {
            tvLabel.setText(String.valueOf((millisUntilFinished / 1000) + 1));
        }

        @Override
        public void onFinish() {
            tvLabel.setText(&quot;Finished&quot;);
        }
    }.start();
}
</code></pre>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_nav_tab.gif" alt=""></p>
<p>ä»”ç»†çœ‹ä¸Šé¢çš„æ•ˆæœå¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡åˆ‡æ¢åˆ° TimerFragment æ—¶ï¼Œå€’è®¡æ—¶æ€»ä¼šé‡æ–°å¼€å§‹ï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä»…å¼€å§‹ä¸€æ¬¡ã€‚è¿™æ˜¯ä»€ä¹ˆé—®é¢˜å¯¼è‡´çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ TimerFragment æ‰§è¡Œäº†å¤šæ¬¡çš„ onCreateViewï¼Œä¸ºä»€ä¹ˆæ˜¯ä¼šæ‰§è¡Œå¤šæ¬¡ï¼ŒFragment ä¸ºä»€ä¹ˆä¼šåŠ è½½å¤šæ¬¡ï¼Ÿæˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ“ä½œå‘€ã€‚æ˜¯ä¸æ˜¯å› ä¸º Navigationï¼Ÿ</p>
<p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥åˆ° Navigation çš„æºç çœ‹ä¸€çœ‹è¿™åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œä»¥åŠæˆ‘ä»¬æ”¹å¦‚ä½•è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®æˆ‘ä»¬çš„æ–¹å‘ï¼Œå°±æ˜¯ Navigation åˆ°åº•æ˜¯æ€ä¹ˆåš Fragment åˆ‡æ¢çš„ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´ Fragment çš„ onCreateView è¢«å¤šæ¬¡æ‰§è¡Œã€‚</p>
<p>ä»å“ªé‡Œä½œä¸ºå…¥å£å‘¢ï¼Ÿäº†è§£è¿‡ Navigation çš„æœ‹å‹å¯¹ä¸‹é¢è¿™è¡Œä»£ç åº”è¯¥ä¸ä¼šé™Œç”Ÿï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ª View è·å–åˆ° NavControllerï¼Œç„¶åé€šè¿‡æ‰§è¡Œ NavController çš„ navigate è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±ä»è¿™ä¸ªæ–¹æ³•å¼€å§‹ã€‚</p>
<pre><code class="language-java">Navigation.findNavController(view)
        .navigate(id);
</code></pre>
<p>è¿™ä¸ª navigate æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬å¼€å§‹çš„ navigate æ–¹æ³•æœ€ç»ˆä¹Ÿæ˜¯æ‰§è¡Œåˆ°ä¸‹é¢è¿™ä¸ªé‡è½½æ–¹æ³•ã€‚</p>
<pre><code class="language-java">navigate(NavDestination node, Bundle args, NavOptions navOptions, Navigator.Extras navigatorExtras)
</code></pre>
<p>æ–¹æ³•çš„å…·ä½“å†…å®¹å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_code_navigate.png" alt=""></p>
<p>å…¶ä¸­åœ¨ç¬¬ 9 è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡ mNavigatorProvider è·å–åˆ°äº†ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º NavDestination çš„ Navigator å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨ç¬¬ 12 è¡Œæ—¶ï¼Œé€šè¿‡è°ƒç”¨åˆšè·å–åˆ°çš„ navigator çš„ navigate æ–¹æ³•ï¼Œå¾—åˆ°äº† NavDestination è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p>è¿™ä¸¤è¡Œæ˜¯å…³é”®ä»£ç ï¼Œä¸€ä¸ªæ˜¯è·å–åˆ°æ‰§è¡Œ navigate çš„å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯å®é™…æ‰§è¡Œ navigate çš„æ–¹æ³•ã€‚çœ‹åˆ°è¿™ï¼Œæˆ‘ä»¬å°±åªéœ€è¦æ‰¾åˆ° Navigator çš„ navigate æ–¹æ³•å³å¯ã€‚ä¸è¿‡ï¼ŒNavigator è¿™ä¸ªåªæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»§ç»­å¯»æ‰¾å®ƒçš„å®ç°ç±»ã€‚</p>
<blockquote>
<p>å¿«æ·é”®ï¼šImplementation(s) Mac: option(âŒ¥) + command(âŒ˜)+B</p>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/image-20190724110340568.png" alt="image-20190724110340568"></p>
<p>Navigator æŠ½è±¡ç±»çš„å…³é”®ä»£ç ï¼š</p>
<pre><code class="language-java">public abstract class Navigator&lt;D extends NavDestination&gt; {
    @Retention(RUNTIME)
    @Target({TYPE})
    @SuppressWarnings(&quot;UnknownNullness&quot;)
    public @interface Name {
        String value();
    }

    @NonNull
    public abstract D createDestination();

    @Nullable
    public abstract NavDestination navigate(@NonNull D destination, @Nullable Bundle args,
            @Nullable NavOptions navOptions, @Nullable Extras navigatorExtras);

    public abstract boolean popBackStack();

    @Nullable
    public Bundle onSaveState() {
        return null;
    }

    public void onRestoreState(@NonNull Bundle savedState) {
    }

    public interface Extras {
    }
}
</code></pre>
<p>é€šè¿‡å¿«æ·é”®æˆ‘ä»¬èƒ½æ‰¾åˆ°å¤šä¸ªå®ç°ç±»ï¼Œæœ‰ ActivityNavigatorã€DialogFragmentNavigator è¿˜æœ‰ FragmentNavigator ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³æ³¨ FragmentNavigator è¿™ä¸ªç±»ä¸­çš„ navigate è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_code_navigate_real.png" alt=""></p>
<p>åˆ«çœ‹è¿™ä¹ˆå¤šä»£ç ï¼Œåˆ«å®³æ€•ï¼Œå…¶å®å…³é”®éƒ¨åˆ†çš„ä»£ç å°±æ˜¯ç¬¬ 32 è¡Œ <code>ft.replace(mContainerId, frag)</code> è¿™é‡Œä½¿ç”¨çš„æ˜¯ FragmentTransaction çš„ replace æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ç”¨è¯´äº†å§ã€‚ replace æ˜¯ç§»é™¤äº†ç›¸åŒ id çš„ fragment ç„¶åå†è¿›è¡Œ add çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œçœ‹åˆ°è¿™ï¼Œæˆ‘ä»¬ä¹Ÿå°±çŸ¥é“äº†ï¼Œä¸ºä»€ä¹ˆ TimerFragment çš„ onCreateView æ–¹æ³•ä¼šè¢«æ‰§è¡Œå¤šæ¬¡äº†ï¼ŒåŸå› å°±æ˜¯åœ¨è¿™ã€‚</p>
<p>æ‰¾åˆ°åŸå› äº†ï¼Œé‚£æˆ‘ä»¬æœ‰ä»€ä¹ˆæ–¹æ³•å»è§„é¿ï¼Œæˆ–è€…è¯´å»ç»•è¿‡è¿™ä¸ª replace å—ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ã€‚</p>
<p>è¿˜è®°å¾—åˆšæ‰æˆ‘ä»¬æ‰¾çš„ä¸‹é¢è¿™è¡Œä»£ç å§ï¼ˆå¿˜è®°çš„ï¼Œè¯·çœ‹ç¬¬ä¸€å¼ ä»£ç å›¾çš„ç¬¬ 9 è¡Œï¼‰ï¼Œåˆšæ‰æˆ‘è¯´ï¼Œé€šè¿‡ mNavigatorProvider æ‰¾åˆ°ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º NavDestination çš„ Navigator å¯¹è±¡ï¼Œé‚£å®ƒå®é™…ä¸Šæ˜¯æ€ä¹ˆæ‰¾åˆ°çš„å‘¢ï¼Ÿæ˜¯é€šè¿‡ node.getNavigatorName() ç„¶åæ‰¾çš„ï¼Œè¿™ä¸ª node æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿä»¥åŠ mNavigatorProvider.getNavigator å†…éƒ¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="language-java">Navigator&lt;NavDestination&gt; navigator = mNavigatorProvider.getNavigator(
        node.getNavigatorName());
</code></pre>
<p>å®é™…ä¸Šè¿™é‡Œçš„ node å°±æ˜¯ä¸€ä¸ª NavDestination å¯¹è±¡ï¼Œè€Œä¸€ä¸ª NavDestination å¯¹è±¡å°±æ˜¯å¯¹åº”ç€ navigation graph ä¸­çš„èŠ‚ç‚¹ä¿¡æ¯ã€‚æˆ‘ç”¨æ¥æ¼”ç¤ºçš„ Demo çš„ navigation graph æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/tab_navigation&quot;
    app:startDestination=&quot;@id/feedFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/feedFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.FeedFragment&quot;
        android:label=&quot;fragment_feed&quot;
        tools:layout=&quot;@layout/fragment_feed&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/timerFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.TimerFragment&quot;
        android:label=&quot;fragment_timer&quot;
        tools:layout=&quot;@layout/fragment_timer&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/mineFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.MineFragment&quot;
        android:label=&quot;fragment_mine&quot;
        tools:layout=&quot;@layout/fragment_mine&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>node.getNavigatorName è¿”å›çš„å°±æ˜¯ fragment èŠ‚ç‚¹çš„èŠ‚ç‚¹åç§° <code>fragment</code>ï¼Œè€Œ getNavigator å…¶å®å†…éƒ¨å°±æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªç±»å‹ä¸º HashMap çš„ mNavigatorsï¼Œè¿™ä¸ª HashMap å­˜çš„ key å°±æ˜¯èŠ‚ç‚¹åç§°ï¼Œvalue å°±æ˜¯æŠ½è±¡ç±» Navigator çš„å®ç°ç±»ã€‚è€Œ fragment å¯¹åº”çš„ FragmentNavigator ä¹Ÿå­˜å‚¨åœ¨å…¶ä¸­ã€‚</p>
<p>æ—¢ç„¶æ˜¯å­˜åœ¨ä¸€ä¸ª mapï¼Œå¹¶ä»ä¸­å–å‡ºç›¸å¯¹äºçš„ Navigator å®ç°ç±»ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½åˆ›å»ºä¸€ä¸ªç±»å¹¶å®ç° Navigatorï¼Œç„¶åå°† keyã€value æ·»åŠ åˆ°é‚£ä¸ª HashMap ä¸­ã€‚ç­”æ¡ˆæ˜¯å¯è¡Œçš„ã€‚åœ¨NavigatorProvider è¿™ä¸ªç±»ä¸­æœ‰ä¸¤ä¸ªå…¬å…±æ–¹æ³•ï¼š</p>
<ul>
<li>addNavigator(Navigator navigator)</li>
<li>addNavigator(String name, Navigator navigator)</li>
</ul>
<p>å…¶ä¸­ï¼Œä¸€ä¸ªå‚æ•°çš„ addNavigator ä¹Ÿæ˜¯è°ƒç”¨äº† ä¸¤ä¸ªå‚æ•°çš„ addNavigator æ–¹æ³•ï¼Œé‚£ä¸ª name ä¹Ÿå°±æ˜¯ navigation graph ä¸­ fragment èŠ‚ç‚¹çš„èŠ‚ç‚¹åç§°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Navigator è¿™ä¸ªæŠ½è±¡ç±»ä¸­æ³¨è§£ <code>Name</code> å®šä¹‰çš„å€¼ã€‚è€Œä¸”åœ¨ NavController è¿™ä¸ªç±»ï¼ˆæœ€åˆæˆ‘ä»¬æ‰¾åˆ°çš„ navigate æ‰€åœ¨çš„ç±»ï¼‰ä¸­æœ‰ä¸€ä¸ª getNavigatorProvider() æ–¹æ³•ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/uml_blog_navigation.jpg" alt=""></p>
<p>çœ‹åˆ°è¿™ï¼Œå…³ç³»åº”è¯¥å°±æ¯”è¾ƒæ¸…æ¥šäº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®ç° Navigator å¹¶æœª Name æ³¨è§£æ·»åŠ ä¸€ä¸ªå€¼ï¼Œç„¶ååœ¨ä½¿ç”¨ Navigation è¿™ä¸ªæ¨¡å—çš„ Activity è·å–åˆ° NavController å¹¶è°ƒç”¨å…¶ getNavigatorProvider æ–¹æ³•åå†è°ƒç”¨ addNavigator å³å¯ã€‚</p>
<p>Github ä¸Šå·²ç»æœ‰ä¸€ä¸ªæ¼”ç¤ºè‡ªå®šä¹‰å®ç° Navigator çš„é¡¹ç›®äº†ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯ä»¥ Kotlin è¯­è¨€ç¼–å†™çš„ã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š https://github.com/STAR-ZERO/navigation-keep-fragment-sampleã€‚</p>
<blockquote>
<p>è¯´èµ·æ¥è¿™ä¸ªé¡¹ç›®è¿˜æ˜¯ <a href="https://github.com/drakeet">Drakeet</a> åœ¨ä»–çš„çŸ¥è¯†æ˜Ÿçƒä¸­åˆ†äº«çš„ã€‚æ„Ÿè°¢ Drakeet çš„åˆ†äº«ã€‚</p>
</blockquote>
<p>æˆ‘æ ¹æ®æŒ‰ç…§ä»–çš„ä»£ç å†™äº†ä¸€ä»½ Java ç‰ˆæœ¬çš„ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­æ”¹äº†ä¸¤è¡Œä»£ç ï¼ˆæ³¨é‡Šéƒ¨åˆ†ï¼‰ã€‚æ³¨é‡Šçš„å†…å®¹å…¶å®å°±æ˜¯ä½¿ç”¨ FragmentTranslation å¯¹ Fragment è¿›è¡Œæ§åˆ¶ã€‚åŸä½œè€…å†™çš„æ˜¯ detach ä¸ attach æ–¹æ³•ï¼Œæˆ‘æ”¹æˆäº†ä½¿ç”¨ hide å’Œ show æ–¹æ³•ã€‚</p>
<pre><code class="language-java">@Navigator.Name(&quot;keep_state_fragment&quot;)
public class KeepStateNavigator extends FragmentNavigator {
    private Context context;
    private FragmentManager manager;
    private int containerId;

    public KeepStateNavigator(@NonNull Context context, @NonNull FragmentManager manager, int containerId) {
        super(context, manager, containerId);
        this.context = context;
        this.manager = manager;
        this.containerId = containerId;
    }

    @Nullable
    @Override
    public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
        String tag = String.valueOf(destination.getId());
        FragmentTransaction transaction = manager.beginTransaction();
        boolean initialNavigate = false;
        Fragment currentFragment = manager.getPrimaryNavigationFragment();
        if (currentFragment != null) {
//            transaction.detach(currentFragment);
            transaction.hide(currentFragment);
        } else {
            initialNavigate = true;
        }
        Fragment fragment = manager.findFragmentByTag(tag);
        if (fragment == null) {
            String className = destination.getClassName();
            fragment = manager.getFragmentFactory().instantiate(context.getClassLoader(), className);
            transaction.add(containerId, fragment, tag);
        } else {
//            transaction.attach(fragment);
            transaction.show(fragment);
        }

        transaction.setPrimaryNavigationFragment(fragment);
        transaction.setReorderingAllowed(true);
        transaction.commitNow();
        return initialNavigate ? destination : null;
    }
}
</code></pre>
<p>æ³¨æ„ï¼Œä½¿ç”¨è‡ªå®šä¹‰ Navigator çš„æ—¶å€™ navigation graph éœ€è¦æŠŠ fragment èŠ‚ç‚¹åç§°æ”¹ä¸º keep_state_fragmentï¼Œå¹¶ä¸”åœ¨æ‰¿è½½çš„ Activity ä¸­è¿›è¡Œè®¾ç½®å¹¶ä¸”è¿˜éœ€è¦æŠŠ Activity å¸ƒå±€æ–‡ä»¶ä¸­ fragment çš„ navGraph å±æ€§ç§»é™¤ã€‚</p>
<pre><code class="language-java">NavController navController = Navigation.findNavController(this, R.id.fragment3);
NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragment3);
KeepStateNavigator navigator = new KeepStateNavigator(this, navHostFragment.getChildFragmentManager(), R.id.fragment3);
navController.getNavigatorProvider().addNavigator(navigator);
navController.setGraph(R.navigation.tab_navigation);
</code></pre>
<p>æœ€åæ¥çœ‹ä¸€ä¸‹ä½¿ç”¨è‡ªå®šä¹‰ Navigator æ—¶çš„ TabActivityã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_nav_tab_state.gif" alt=""></p>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://jiangjiwei.site/">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­å…¨éƒ¨æºä»£ç å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œä»£ç åˆ†æ”¯ä¸º masterã€‚å–œæ¬¢æœ¬æ–‡çš„éº»çƒ¦ç‚¹ä¸ªğŸŒŸã€‚</p>
<p>æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@joaosilas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">JoÃ£o Silas</a> on <a href="https://unsplash.com/search/photos/translation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>

            </div>
          </article>
        </div>
    
        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://cherrylover.github.io/post/kan-yi-kan-databinding">
              <h3 class="post-title">
                çœ‹ä¸€çœ‹ DataBinding
              </h3>
            </a>
          </div>  
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: 'f5cc70d7d50fba65cf69',
    clientSecret: '1d018e38ce9cdd399682bdd76690decfef00a051',
    repo: 'CherryLover.github.io',
    owner: 'CherryLover',
    admin: ['CherryLover'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        
    
        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
