<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æ¥å­¦ä¸€æ³¢ Navigation | Jiang</title>
<link rel="shortcut icon" href="https://cherrylover.github.io/favicon.ico?v=1565058747395">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cherrylover.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-143284233-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-143284233-1');
</script>

  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://cherrylover.github.io">
  <img class="avatar" src="https://cherrylover.github.io/images/avatar.png?v=1565058747395" alt="">
  </a>
  <h1 class="site-title">
    Jiang
  </h1>
  <p class="site-description">
    æˆ‘å…è®¸ä½ èµ°è¿›æˆ‘çš„ä¸–ç•Œï¼Œä½†ä¸è®¸ä½ åœ¨æˆ‘çš„ä¸–ç•Œé‡Œèµ°æ¥èµ°å»ã€‚
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/CherryLover" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
        <a href="https://juejin.im/user/576d73cd0a2b58006a09ad87" target="_blank">
          <i class="fab fa-weibo"></i>
        </a>
      
    
      
    
      
    
  </div>
</div>

      
        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              æ¥å­¦ä¸€æ³¢ Navigation
            </h2>
            <div class="post-info">
              <time class="post-time">
                Â· 2019-06-29 Â·
              </time>
              
                <a href="https://cherrylover.github.io/tag/J97-m2V0f" class="post-tags">
                  # Jetpack è¿½æ–°
                </a>
              
                <a href="https://cherrylover.github.io/tag/37yorOBW4" class="post-tags">
                  # æŒç»­å­¦ä¹ 
                </a>
              
                <a href="https://cherrylover.github.io/tag/Mk4HmBIQ7" class="post-tags">
                  # Android
                </a>
              
            </div>
            
              <div class="post-feature-image" style="background-image: url('https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog_navigation.jpg')">
              </div>
            
            <div class="post-content">
              <p>Navigation æ˜¯ä¸€ä¸ªè°·æ­Œå®˜æ–¹æ¨å‡ºçš„ä¸€ä¸ªç”¨äº APP å†…éƒ¨ä¾¿æ·åˆ‡æ¢å†…å®¹ï¼ˆFragment æˆ– Activityï¼‰çš„åº“ã€‚ä»è€Œä½¿å¾— APP å†…çš„é¡µé¢è·³è½¬æ›´ç®€å•ã€‚</p>
<p>æˆ‘çŸ¥é“å®ƒçš„æ—¶å€™å®ƒçš„ç‰ˆæœ¬å·²ç»æ˜¯ 2.0.0 äº†ï¼Œä¹Ÿæ˜¯æ—¶å€™æ¥å­¦ä¹ ä¸€æ³¢äº†ã€‚</p>
<!-- more --> 
<p>æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œå­¦ä¹ çš„ç¬¬ä¸€æ‰‹èµ„æ–™ä¸èƒ½ç¼ºäº†å®˜æ–¹å‡ºå“çš„ <a href="https://codelabs.developers.google.com/codelabs/android-navigation/#0">CodeLab</a>ã€‚ç›¸ä¿¡ä½ ï¼Œçœ‹äº† CodeLab ä¹‹åå°±èƒ½å¯¹ Navigation æœ‰ä¸€ä¸ªç®€å•çš„äº†è§£ã€‚æœ¬äººä¹Ÿæ˜¯å¯¹ CodeLab å­¦ä¹ ä¹‹åæ‰å†™ä¸‹äº†è¿™ç¯‡åšå®¢ï¼Œä¸»è¦å†…å®¹éƒ½èƒ½åœ¨ CodeLab ä¸Šæ‰¾åˆ°ã€‚ä¸è¿‡ CodeLab é‡Œé¢æ˜¯è‹±æ–‡çš„è®²è§£ï¼Œè€Œä¸”å…¶ä¸­çš„ä»£ç æ˜¯ä½¿ç”¨ Kotlin ç¼–å†™çš„ï¼Œè¿™ç¯‡åšå®¢æ˜¯ä»¥ Java ä»£ç çš„æ–¹å¼è¿›è¡Œçš„ã€‚</p>
<p>è¿˜ä¸€ä»¶äº‹æƒ…ï¼ŒNavigation çš„åŸç”Ÿæ”¯æŒæ˜¯ä» Android Studio 3.3 å¼€å§‹çš„ï¼Œ3.2 ç‰ˆæœ¬çš„éœ€è¦åœ¨è®¾ç½®é¢æ¿çš„ Experimental æ¨¡å—ä¸­å¯ç”¨ Navigation ç¼–è¾‘å™¨ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628144412075.png" alt="image-20190628144412075"></p>
<blockquote>
<p>å›¾ç‰‡æ¥è‡ª CodeLabã€‚</p>
</blockquote>
<p>ä¸‹é¢å¼€å§‹æ­£é¢˜</p>
<h2 id="navigation-graph-å’Œ-navhostfragment">Navigation Graph å’Œ NavHostFragment</h2>
<p>é¦–å…ˆï¼Œæ·»åŠ ä¾èµ–ã€‚</p>
<pre><code>implementation 'androidx.navigation:navigation-fragment:2.0.0'
implementation 'androidx.navigation:navigation-ui:2.0.0'
</code></pre>
<p>ä¹‹åï¼Œåœ¨ res æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç±»å‹ä¸º navigation çš„èµ„æºæ–‡ä»¶å¤¹ï¼ŒAndroid Studio ä¼šè‡ªåŠ¨åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç”Ÿäº§ä¸€ä¸ªåä¸º navigation.xml çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯ç”¨äºæè¿° Fragment åŠç›¸åº”çš„è·³è½¬é€»è¾‘ã€åŠ¨ç”»ã€å‚æ•°ç­‰ä¿¡æ¯ã€‚è¿™ä¸ªæ–‡ä»¶ä¹Ÿå«åš <strong>Navigation Graph</strong>ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628144907092.png" alt="create_navigation_folder"></p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
            android:id=&quot;@+id/navigation&quot;&gt;

&lt;/navigation&gt;
</code></pre>
<p>é»˜è®¤çš„ Navigation Graph æ–‡ä»¶å°±åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ›´å¤šçš„ Fragmentï¼Œæ·»åŠ è¿›æ¥ï¼Œä¼šæœ‰ä¸åŒçš„å­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹ä»£è¡¨çš„å°±æ˜¯ Fragmentï¼Œfragment èŠ‚ç‚¹ä¸­æè¿°å…³äº Fragment çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ fragment èŠ‚ç‚¹ä¸­è¿˜å¯ä»¥å…¶ä»–å­èŠ‚ç‚¹ï¼Œæ¯”å¦‚ï¼Œactionã€argumentã€deepLinkã€‚ä»–ä»¬åˆ†åˆ«ç”¨äºè¡¨ç¤º Fragment çš„ç›¸å…³ä¿¡æ¯ã€‚å¾€åä¼šè®²åˆ°çš„ã€‚ç°åœ¨æˆ‘ä»¬ç°åœ¨åˆ›å»ºä¸€ä¸ª Fragment ï¼Œå°±å« RootFragment å¥½äº†ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
             xmlns:tools=&quot;http://schemas.android.com/tools&quot;
             android:layout_width=&quot;match_parent&quot;
             android:layout_height=&quot;match_parent&quot;
             tools:context=&quot;.fragment.RootFragment&quot;&gt;
    &lt;TextView
            android:layout_gravity=&quot;center&quot;
            android:gravity=&quot;center&quot;
            android:layout_width=&quot;match_parent&quot;
            android:textSize=&quot;24sp&quot;
            android:layout_height=&quot;match_parent&quot;
            android:text=&quot;Root Fragment&quot;/&gt;

&lt;/FrameLayout&gt;
</code></pre>
<p>åªæ˜¯åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå‡ºè¿™ä¸ª Fragment çš„åå­—ï¼ŒJava ä»£ç ä¸­æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚ç°åœ¨è®©æˆ‘ä»¬å›åˆ° Navigation Graph ä¸­ï¼Œæˆ‘ä»¬æ˜¯åˆå­¦è€…ï¼Œä¸çŸ¥é“æˆ–è€…è¯´ä¸äº†è§£ Fragment èŠ‚ç‚¹æœ‰å“ªäº›å±æ€§å¯ä»¥å»ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ Navigation Graph çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œåˆšæ‰æˆ‘ä»¬çœ‹äº† Navigation Graph çš„ä»£ç ï¼Œç°åœ¨æ¥çœ‹ä¸€ä¸‹ï¼Œå›¾å½¢åŒ–ç¼–è¾‘é¡µé¢ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628150519705.png" alt="graph_design"></p>
<blockquote>
<p>å·¦è¾¹åŒºåŸŸï¼šæ˜¯å·²ç»æ·»åŠ è¿›æ¥çš„ Fragment ä»¥åŠæ‰¿è½½è¿™äº› Fragment çš„é¡µé¢ï¼›</p>
<p>ä¸­é—´åŒºåŸŸï¼šFragment çš„è·³è½¬ç¤ºæ„å›¾ï¼›</p>
<p>å³è¾¹åŒºåŸŸï¼šæ˜¯å½“å‰é€‰ä¸­çš„ Fragment çš„å±æ€§å±•ç¤ºåŒºï¼›</p>
</blockquote>
<p>é¡µé¢ä¸­é—´å·²ç»æç¤ºæˆ‘ä»¬äº†ï¼Œç‚¹å‡»é‚£ä¸ªå›¾æ ‡ï¼Œæ·»åŠ ä¸€ä¸ªç›®æ ‡ã€‚è¯•è¯•çœ‹å§ï¼Œä» Android Studio å±•ç¤ºå‡ºçš„åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ RootFragmentã€‚è¿™æ—¶ï¼Œé¡µé¢å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ RootFragment çš„æ ·å­å·²ç»å‡ºç°äº†ï¼Œè€Œä¸”åç§°å‰è¿˜æœ‰ä¸€ä¸ªå°å›¾æ ‡ï¼Œè¿™è¡¨ç¤º RootFragment æ˜¯ Navigation ç®¡ç†é¡µé¢çš„ç¬¬ä¸€ä¸ªé¡µé¢ä¹Ÿæ˜¯å¼€å§‹é¡µé¢ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628150937246.png" alt="image-20190628150937246"></p>
<p>é¡µé¢å³ä¾§å‡ºç°äº†ä¸€äº›å±æ€§ï¼Œæˆ‘ä»¬æš‚æ—¶å¯ä»¥ä¸ç”¨ç®¡ï¼Œç°åœ¨æˆ‘åªæƒ³å…ˆè¿è¡Œèµ·æ¥ï¼Œçœ‹çœ‹æ•ˆæœã€‚ä¸è¿‡åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¹é€ ä¸€ä¸‹ï¼Œä¹‹å‰æ–°å»ºé¡¹ç›®è‡ªåŠ¨ç”Ÿæˆçš„ MainActivityã€‚å…ˆæ‰“å¼€ activity_main.xml çš„å›¾å½¢åŒ–ç¼–è¾‘é¡µé¢ï¼Œç„¶ååœ¨ Palette ç±»å‹åˆ—è¡¨ä¸­æ‰¾åˆ° <strong>NavHostFragment</strong> å¹¶æ‹–æ‹½åˆ°é¡µé¢ä¸Šï¼Œæ­¤æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œè®©ä½ é€‰æ‹© Navigation Graphï¼Œæˆ‘ä»¬é€‰æ‹©åˆšæ‰è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶å³å¯ã€‚</p>
<blockquote>
<p>Android Studio çš„å¸ƒå±€æ–‡ä»¶çš„æ‹–æ‹½ï¼Œä¸æ˜¯å¤ªå¥½ç”¨ï¼Œéœ€è¦æ‰‹åŠ¨åˆ‡æ¢åˆ°æºä»£ç å½¢å¼ï¼Œç®€å•æ”¹åŠ¨ä¸€ä¸‹é¡µé¢ä»£ç ï¼Œæˆ‘ä»¬è®©è¿™ä¸ª NavHostFrgament ç»„ä»¶å¡«å……æ»¡æ•´ä¸ªå®¹å™¨å³å¯ã€‚</p>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628151745388.png" alt="image-20190628151745388"></p>
<p>æœ€ç»ˆçš„ activity_main.xml çš„æºæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/fragment&quot;
        android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        app:defaultNavHost=&quot;true&quot;
        app:navGraph=&quot;@navigation/navigation&quot; /&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>ç„¶åè¿è¡Œé¡¹ç›®å³å¯ã€‚è¿™å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ä½¿ç”¨ Navigation çš„ä¾‹å­ï¼Œè€Œä¸”å…¶ä¸­æ ¹æœ¬å°±æ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628161622969.png" alt="image-20190628161622969"></p>
<p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬æ¥å›è¿‡å¤´æ¥çœ‹çœ‹ï¼Œåˆšåˆšæˆ‘ä»¬éƒ½åšä»€ä¹ˆã€‚æˆ‘ä»¬çœŸæ­£æœ‰æ•ˆçš„å†…å®¹æ˜¯ä»æŠŠ RootFragment æ·»åŠ åˆ° Navigation Graph ä¸­ï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹ï¼ŒNavigation Graph çš„æºä»£ç ã€‚è¯´ä¸å®šèƒ½ä»é‚£é‡Œå‘ç°ç‚¹ä»€ä¹ˆä¸œè¥¿ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/navigation&quot;
    app:startDestination=&quot;@id/rootFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/rootFragment&quot;
        android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
        android:label=&quot;fragment_root&quot;
        tools:layout=&quot;@layout/fragment_root&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>è¿™ä¸ªæ–‡ä»¶è·Ÿä¹‹å‰è‡ªåŠ¨ç”Ÿæˆçš„æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ— éå°±æ˜¯å¤šäº†ä¸€ä¸ª fragment èŠ‚ç‚¹ï¼Œä»¥åŠæ ¹èŠ‚ç‚¹ä¸Šå¤šäº†ä¸€ä¸ª startDestination å±æ€§ã€‚éš¾é“å°±æ˜¯å› ä¸ºè¿™ä¸ªå±æ€§ï¼Ÿæ˜¯çš„ï¼Œæ²¡é”™ï¼Œåœ¨ Navigation ä¸­æˆ‘ä»¬ä½¿ç”¨ Destination(ç›®æ ‡)æ¥æè¿° Fragment ä¹‹é—´çš„è·³è½¬å…³ç³»ã€‚è¿™é‡Œçš„ startDestination ä»£è¡¨çš„å°±æ˜¯è¿™ä¸ªæ˜¯ Navigation æ•´ä¸ªé¡µé¢è·³è½¬ç®¡ç†æ ˆçš„æœ€æ ¹çº§é¡µé¢ã€‚</p>
<p>å†æ¥çœ‹çœ‹é‚£ä¸ªæ·»åŠ åˆ° MainActivity é¡µé¢çš„ NavHostFragment ç»„ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ä¸­çš„ fragmen ç»„ä»¶ï¼Œè·Ÿæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨çš„æ²¡ä»€ä¹ˆä¸åŒï¼Œéè¦è¯´ä¸åŒï¼Œé‚£å°±æ˜¯å…¶ä¸­çš„ nameã€defaultNavHost ä»¥åŠ navGraph è¿™ä¸‰ä¸ªå±æ€§äº†ã€‚</p>
<p>name å±æ€§æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒnavGraph å±æ€§é‡Œé¢çš„å€¼æ˜¯åˆšæ‰åˆ›å»º Navigation Graphï¼ŒçŒœä¸€ä¸‹ï¼Œå°±æ˜¯æŠŠ Navigation Graph å¼•ç”¨åˆ°äº†è¿™ä¸ª NavHostFragment ä¸­ã€‚é‚£æœ€åä¸€ä¸ª defaultNavHost å±æ€§å‘¢ï¼Ÿé‚£å°±æ˜¯æ‹¦æˆªç³»ç»Ÿè¿”å›æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶çš„ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/fragment&quot;
    android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    app:defaultNavHost=&quot;true&quot;
    app:navGraph=&quot;@navigation/navigation&quot; /&gt;
</code></pre>
<h2 id="navcontroller">NavController</h2>
<p>å•å•ä¸€ä¸ª Fragment æ²¡å•¥æ„æ€ï¼Œä¸å¥½ç©ï¼Œè¿™å›æˆ‘ä»¬å†åŠ ä¸€ä¸ªé¡µé¢(SettingsFragment)ã€‚å°è¯•ç€ä» RootFragment é¡µé¢ç‚¹å‡»æŒ‰é’®åˆ‡æ¢åˆ° SettingsFragment é¡µé¢ã€‚ç„¶ååœ¨ SettingsFragment é¡µé¢ç‚¹å‡»æŒ‰é’®è¿”å›åˆ° RootFragment é¡µé¢ã€‚</p>
<blockquote>
<p>è¯´æ˜¯ SettingsFragmentï¼Œé‡Œé¢å°±ä¸€ä¸ª Button ä¸€ä¸ª TextViewï¼Œå¸ƒå±€ä»£ç å°±ä¸è´´äº†ã€‚</p>
</blockquote>
<p>Fragment å‡†å¤‡å¥½äº†ï¼Œè¯¥å¾€ Navigation Graph é‡Œæ·»åŠ äº†ï¼ŒæŒ‰ç…§åˆšæ‰æ·»åŠ  RootFragment çš„æ–¹å¼å†æ¥ä¸€æ¬¡ï¼Œä¸è¿‡ï¼Œè¿™æ¬¡æ¯”ä¸Šæ¬¡å¤šä¸€æ­¥ã€‚é€‰ä¸­ RootFragmentï¼Œç‚¹å‡» RootFragment å³è¾¹çš„å°åœ†ç‚¹ç„¶åç‰µå¼•åˆ°å³ä¾§çš„ SettingsFragmentã€‚è¿™æ ·ä»–ä»¬ä¸¤ä¸ªå°±å»ºç«‹ä¸€ç§å…³ç³»ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628160038102.png" alt="image-20190628160038102"></p>
<p>æ¥çœ‹ä¸€ä¸‹æºä»£ç å§ã€‚æˆ‘ä»¬å‘ç°ï¼Œé™¤äº†å¢åŠ äº†ä¸€ä¸ª fragment èŠ‚ç‚¹ä¹‹å¤–ï¼ŒåŸæ¥çš„ RootFragment çš„èŠ‚ç‚¹ä¸Šè¿˜å¢åŠ äº†ä¸€ä¸ªå­èŠ‚ç‚¹ action ã€‚äº‹å®ä¸Šï¼Œaction èŠ‚ç‚¹å°±æ˜¯ç”¨æ¥æè¿° Fragmen ä¹‹é—´çš„é¡µé¢è·³è½¬çš„å…³ç³»çš„ï¼Œå…¶ä¸­ destination å±æ€§çš„å€¼å°±æ˜¯ç›®æ ‡ fragment çš„ idã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot; /&gt;

&lt;!--ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç --&gt;

&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot; &gt;
    &lt;action
        android:id=&quot;@+id/action_rootFragment_to_settingsFragment2&quot;
        app:destination=&quot;@id/settingsFragment&quot; /&gt;
&lt;/fragment&gt;
&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot; /&gt;
</code></pre>
<p>ç»§ç»­å¾€ä¸‹ï¼Œæˆ‘ä»¬ä¸º RootFragment é¡µé¢ç»‘å®šç‚¹å‡»äº‹ä»¶ã€‚</p>
<pre><code class="language-java">private void toSettings() {
    btnToSettings.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Navigation.findNavController(btnToSettings)
                    .navigate(R.id.action_rootFragment_to_settingsFragment);
        }
    });
}
</code></pre>
<p>è¿™ä¸€çœ‹å°±çŸ¥é“äº†ï¼Œé€šè¿‡ Navigation æ‰¾åˆ°ä¸€ä¸ªå« <strong>NavController</strong> çš„ä¸œè¥¿ï¼Œç„¶åæ‰§è¡Œ navigate æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢ä¼ çš„å€¼å°±æ˜¯åˆšæ‰ RootFragment å­èŠ‚ç‚¹ action çš„ id çš„å€¼ã€‚å…ˆè¿è¡Œä¸€ä¸‹çœ‹çœ‹æ•ˆæœã€‚</p>
<blockquote>
<ol>
<li>äº²æµ‹ç‚¹å‡»æŒ‰é’®èƒ½è·³è½¬åˆ° SettingsFragment é¡µé¢ã€‚ä¸‹é¢çš„ Gif åŠ¨å›¾åªæ˜¯è¡¨ç¤ºèƒ½ä» RootFragment åˆ° SettingsFragmentï¼Œé—ªå›åˆ° RootFragment é¡µé¢åªæ˜¯ Gif çš„é‡æ–°æ’­æ”¾ã€‚</li>
<li>å¦‚æœä½ åœ¨ SettingsFragment ç‚¹å‡»ç³»ç»Ÿçš„è¿”å›é”®ï¼Œæ˜¯èƒ½è¿”å›åˆ° RootFragmentã€‚è¿™å°±æ˜¯ MainActivity ä¸­ NavHostFragment ç»„ä»¶çš„å±æ€§ <code>app:defaultNavHost=&quot;true&quot;</code> èµ·åˆ°çš„ä½œç”¨ï¼Œæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥æ”¹æˆ false ç„¶åå†è¯•ä¸€ä¸‹æ•ˆæœã€‚</li>
</ol>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_toSettings.gif" alt=""></p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†æ¬¡ä¸º SettingsFragment æ·»åŠ æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å§ã€‚</p>
<pre><code class="language-java">private void goBack() {
    btnToRoot.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Navigation.findNavController(btnToRoot)
                    .popBackStack();
        }
    });
}
</code></pre>
<p>å’Œä¹‹å‰è·³è½¬åˆ°è¿™ä¸ªé¡µé¢çš„æ–¹å¼å·®ä¸å¤šï¼Œåªæ˜¯æœ€åæ‰§è¡Œçš„æ–¹æ³•å˜æˆäº† <code>popBackStack</code> ã€‚</p>
<p>å—¯ï¼ŒæŒºå¥½çš„ï¼Œä¸è¿‡ï¼Œæˆ‘ä»¬æœ‰äº›æ—¶å€™éœ€è¦åœ¨ä¸¤ä¸ª Fragment ä¹‹é—´åšåˆ‡æ¢åŠ¨ç”»ï¼Œè¿™ä¸ªæ€ä¹ˆåŠï¼Ÿè¿™ä¸ªä¹Ÿä¸éš¾ï¼Œåœ¨Navigation Graph ä¸­è·³è½¬çš„ action å†…å¢åŠ å±æ€§å³å¯ã€‚å‘ï¼Œè¿™æ ·å°±è¡Œäº†ï¼Œè€Œä¸”è¿˜å¯ä»¥ç”¨è¿‡ Java ä»£ç æ¥å®ç°ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot;&gt;
    &lt;action
        android:id=&quot;@+id/action_rootFragment_to_settingsFragment&quot;
        app:destination=&quot;@id/settingsFragment&quot;
        app:enterAnim=&quot;@anim/slide_in_right&quot;
        app:exitAnim=&quot;@anim/slide_out_left&quot;
        app:popEnterAnim=&quot;@anim/slide_in_left&quot;
        app:popExitAnim=&quot;@anim/slide_out_right&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<p>Java ä»£ç </p>
<pre><code class="language-java">Navigation.findNavController(btnToSettings)
    .navigate(R.id.action_rootFragment_to_settingsFragment);
//                ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç 

NavOptions options = new NavOptions.Builder()
    .setEnterAnim(R.anim.slide_in_right)
    .setExitAnim(R.anim.slide_out_left)
    .setPopEnterAnim(R.anim.slide_in_left)
    .setPopExitAnim(R.anim.slide_out_right)
    .build();

Navigation.findNavController(btnToSettings)
    .navigate(R.id.action_rootFragment_to_settingsFragment, null, options);
</code></pre>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬è°ƒç”¨äº† navigate è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯ Bundle ç±»å‹ï¼Œæˆ‘ä»¬å¡«å…¥äº† null</p>
<p>ï¼Œé‚£å¦‚æœæ­£å¸¸å¡«äº†å€¼ï¼ŒBundle æ˜¯ä¸æ˜¯å°±æ˜¯ä¼ é€’åˆ° SettingsFragment äº†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ä¸è¿‡ Navigation è¿˜æœ‰å¦ä¸€ç§æ–¹å¼æ¥ä¼ å€¼â€”â€” <strong>Safe Args</strong>ã€‚</p>
<h3 id="safe-args">Safe Args</h3>
<blockquote>
<p>ä¸ºå•¥è¦ç”¨ Safe Args å‘¢ï¼Ÿ</p>
<p>æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥å­¦ï¼Œæ„Ÿè§‰å¦‚æœå•çº¯ä¸ºäº†ä¿è¯ key å®‰å…¨çš„è¯ï¼ŒæŠŠ Bundle é‡Œé¢çš„ key æŠ½å–æˆå¸¸é‡å€¼ä¸ä¹Ÿè¡Œå—ï¼Ÿä¸å¤ªæ‡‚ä¸ºå•¥è¦é€šè¿‡è¿™ç§å½¢å¼æ¥åšï¼Œä¸è¿‡å‘¢ï¼Œè€è¯è¯´å¾—å¥½ï¼ŒæŠ€å¤šä¸å‹èº«ã€‚</p>
</blockquote>
<p>Safe Args æ˜¯é…åˆ Navigation ä½¿ç”¨çš„ä¸€ä¸ª Gradle æ’ä»¶ã€‚é¦–å…ˆä½ å¾—å…ˆå»é…ç½®ï¼š</p>
<p>é¦–å…ˆåœ¨ä½ é¡¹ç›®çš„æ ¹ç›®å½•çš„ build.gradle æ–‡ä»¶ä¸­åŠ ä¸Šè¿™äº›ä¸œè¥¿ï¼š</p>
<pre><code>repositories {
    google()
}
dependencies {
    classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:2.0.0&quot;
}
</code></pre>
<p>ç„¶åè¿˜å¾—åœ¨ä½ çš„ app æˆ–æ˜¯ module çš„ç›®å½•ä¸‹çš„ build.gradle æ–‡ä»¶å¤¹åŠ å…¥ï¼š</p>
<pre><code>apply plugin: &quot;androidx.navigation.safeargs&quot;
</code></pre>
<p>å¦‚æœä½ æƒ³ç”¨ safe Args ç”Ÿæˆçš„ä»£ç æ—¶ Kotlin çš„è¯ï¼Œè¿˜éœ€è¦åŠ å…¥ï¼š</p>
<pre><code>aapply plugin: &quot;androidx.navigation.safeargs.kotlin&quot;
</code></pre>
<p>æœ€æœ€æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œä½ è¦ç¡®è®¤ä½ çš„ build.properties æ–‡ä»¶ä¸­æœ‰è¿™ä¹ˆä¸€è¡Œï¼š</p>
<pre><code class="language-java">android.useAndroidX=true
</code></pre>
<p>å½“ç„¶äº†ï¼Œå¦‚æœä½ çš„é¡¹ç›®æœ¬èº«å°±æ˜¯ç”¨æ˜¯ AndroidX çš„ä¾èµ–ï¼Œå°±ä¸ç”¨å»ç¡®è®¤äº†ï¼Œè‚¯å®šèƒ½é€šè¿‡çš„å˜›ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°±æ¥ä» RootFragmet ä¼ é€’ä¸€ä¸ªç±»å‹ä¸º String çš„å¤‡æ³¨ååˆ° SettingsFragmen å§ã€‚è¿˜æ˜¯å…ˆé€šè¿‡å›¾å½¢åŒ–ç•Œé¢è¿›è¡Œè®¾ç½®å§ï¼Œé€‰ä¸­ SettingsFragmentï¼Œç„¶åå†å³ä¾§å±æ€§é¢æ¿ä¸Šæ‰¾åˆ° Argments ç‚¹å‡»æ—è¾¹çš„â•ã€‚</p>
<p>å¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œæˆ‘ä»¬å¡«å…¥ä¸€ä¸‹ä¿¡æ¯ï¼Œç„¶åç‚¹å‡» addã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628191327486.png" alt="image-20190628191327486"></p>
<p>å®Œæˆä¹‹åçš„ Navigation Graph ä¸­ SettingsFragment èŠ‚ç‚¹çš„å†…å®¹å˜äº†ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot;/&gt;

&lt;!--ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç --&gt;

&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot;&gt;
    &lt;argument
        android:name=&quot;nickName&quot;
        android:defaultValue=&quot;æœªè®¾ç½®&quot;
        app:argType=&quot;string&quot;
        app:nullable=&quot;true&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<blockquote>
<p>è¿™ä¸ªæ—¶å€™ï¼ŒGradle ä¼šè‡ªåŠ¨ç”Ÿæˆ SettingFragmentArgs ä»¥åŠ RootFragmentDirections è¿™ä¸¤ä¸ªç±»ï¼Œåœ¨ generatedJava è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„åŒ…å†…ã€‚å¦‚æœæ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆçš„è¯ï¼Œclean ä¸€ä¸‹æˆ–æ˜¯ rebuild é¡¹ç›®éƒ½è¡Œã€‚</p>
</blockquote>
<p>ç°åœ¨å°±èƒ½ç›´æ¥é€šè¿‡ setNickName çš„å½¢å¼æ¥è®¾ç½®å¾…ä¼ é€’çš„å€¼äº†ã€‚</p>
<pre><code class="language-java">String nickName = &quot;master&quot;;
RootFragmentDirections.ActionRootFragmentToSettingsFragment action =
        RootFragmentDirections.actionRootFragmentToSettingsFragment().setNickName(nickName);

Navigation.findNavController(btnToSettings)
        .navigate(action);
</code></pre>
<p>åœ¨ SettingsFragment æˆ‘ä»¬éœ€è¦æŠŠå€¼å–å‡ºæ¥ï¼Œç„¶åæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p>
<pre><code class="language-java">String nickName = SettingsFragmentArgs.fromBundle(getArguments()).getNickName();
tvNickName.setText(nickName);
</code></pre>
<p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œè¿™æ¯”ä¹‹å‰æˆ‘ä»¬ç”¨ Bundle ä¼ å€¼è¦æ–¹ä¾¿çš„å¤šå•¦ï¼Œè€Œä¸”å†ä¹Ÿä¸ç”¨æ‹…å¿ƒ Key å†™é”™çš„é—®é¢˜äº†ã€‚çœŸé¦™ã€‚</p>
<p>å¥½äº†ï¼ŒNavigation çš„åŸºæœ¬å­¦ä¹ å°±åˆ°è¿™äº†ï¼Œæ„Ÿè§‰çœŸçš„æŒºä¸é”™çš„ã€‚å¯ä»¥è€ƒè™‘ç”¨ç”¨äº†ï¼Œä¸è¿‡ç°åœ¨å¥½åƒä¸»é¡µé¢éƒ½æ˜¯å››ä¸ªæˆ–æ˜¯äº”ä¸ª Tab é¡µé¢ï¼Œè¿™ç”¨ Navigation æ€ä¹ˆå®ç°å‘€ï¼ŸGoogle æ—©å°±æ›¿æˆ‘ä»¬æƒ³å¥½äº†ã€‚</p>
<h2 id="bottomnavigationview">BottomNavigationView</h2>
<p>æ¥ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª Activityï¼Œç„¶åæ‰“å¼€å¸ƒå±€æ–‡ä»¶çš„å›¾å½¢åŒ–å·¥å…·é¡µé¢ï¼Œç”¨ä¹‹å‰æˆ‘ä»¬æ·»åŠ  NavHostFragment ç»„ä»¶çš„æ–¹å¼æ¥æ·»åŠ ä¸€ä¸ª BottomNavigationViewï¼Œç„¶åè®©è¿™ä¸ªç»„ä»¶ä½äºæ•´ä¸ªé¡µé¢çš„åº•éƒ¨ã€‚é¡µé¢çš„å…¶ä½™éƒ¨åˆ†å…¨éƒ¨éƒ½ç•™ç»™ NavHostFragmentã€‚å› ä¸ºæˆ‘ä»¬åˆå¼•å…¥äº†ä¸€ä¸ªæ–°çš„ Fragment ç®¡ç†æ ˆï¼Œæ‰€ä»¥ï¼Œéœ€è¦å†æ¬¡æ–°å»ºä¸€ä¸ª Navigation Graph æ–‡ä»¶ tab_navigationã€‚</p>
<p>ä¸‹é¢å°±æ˜¯ activity_tab.xml ä»¥åŠ tab_navigation.xml çš„ä»£ç ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.TabActivity&quot;&gt;

    &lt;com.google.android.material.bottomnavigation.BottomNavigationView
        android:id=&quot;@+id/nv_bottom_menu&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;48dp&quot;
        app:itemHorizontalTranslationEnabled=&quot;false&quot;
        app:layout_constraintBottom_toBottomOf=&quot;parent&quot; /&gt;

    &lt;fragment
        android:id=&quot;@+id/fragment3&quot;
        android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;0dp&quot;
        app:defaultNavHost=&quot;true&quot;
        app:layout_constraintBottom_toTopOf=&quot;@+id/nv_bottom_menu&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:navGraph=&quot;@navigation/tab_navigation&quot; /&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;

&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:id=&quot;@+id/tab_navigation&quot;&gt;

&lt;/navigation&gt;
</code></pre>
<p>æ¥ä¸‹æ¥å¹²ä»€ä¹ˆå‘¢ï¼Ÿåˆšæ‰æˆ‘ä»¬åˆ›å»ºæ˜¯å®¹å™¨ï¼Œç”¨äºå®¹çº³ Fragment çš„ï¼Œç°åœ¨æ¥åˆ›å»ºä¸‰ä¸ª Fragmentï¼Œè¿™ä¸‰ä¸ª Fragment æ˜¯ç”¨äºå¡«å……è¿›å®¹å™¨çš„å†…å®¹ã€‚</p>
<p>åˆ†åˆ«æ˜¯ FeedFragmentã€TimerFragmentã€MineFragmentã€‚è¿™ä¸‰ä¸ª Fragment æˆ‘ä»¬è¿˜æ˜¯åˆ†åˆ«æ˜¾ç¤ºè‡ªå·±çš„åç§°ã€‚å¸ƒå±€æ–‡ä»¶é‡Œä¹Ÿå°±ä¸€ä¸ª TextViewï¼ŒJava ä»£ç ä¸­ä»€ä¹ˆä¹Ÿä¸åšï¼Œä»…ä»…æ˜¯ç”¨æ¥æ˜¾ç¤ºã€‚</p>
<p>æœ‰äº†ä¸‰ä¸ª Fragmentï¼Œæˆ‘ä»¬ç°åœ¨å» tab_navigation æŠŠè¿™ä¸‰ä¸ª Fragment éƒ½æ·»åŠ è¿›å»ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/tab_navigation&quot;
    app:startDestination=&quot;@id/feedFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/feedFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.FeedFragment&quot;
        android:label=&quot;fragment_feed&quot;
        tools:layout=&quot;@layout/fragment_feed&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/timerFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.TimerFragment&quot;
        android:label=&quot;fragment_timer&quot;
        tools:layout=&quot;@layout/fragment_timer&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/mineFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.MineFragment&quot;
        android:label=&quot;fragment_mine&quot;
        tools:layout=&quot;@layout/fragment_mine&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å®¹å™¨æœ‰äº†ï¼Œå†…å®¹æœ‰äº†ï¼Œåªå·®ä¸€ä¸ªåª’ä»‹ï¼ŒæŠŠå®ƒä»¬è¿›è¡Œå…³è”äº†ã€‚æ‰“å¼€ activity_tab çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œåœ¨å·¦ä¾§æœ‰ä¸€äº›å±æ€§ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§æ˜¯ menuã€‚menuï¼Ÿå°±æ˜¯é‚£ä¸ªç»å¸¸ç”¨äºé¡µé¢å³ä¸Šè§’çš„ menuï¼Ÿå®ƒæ€ä¹ˆä¼šå‡ºç°åœ¨è¿™è¾¹ï¼Ÿç‚¹å‡» menu è¡Œæœ€å³è¾¹çš„æŒ‰é’®ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628235937692.png" alt="image-20190628235937692"></p>
<p>å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¥½åƒå’Œä¸€å¼€å§‹åˆ›å»º NavHostFragment æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯ï¼Œå½“æ—¶æœ‰å¾…é€‰æ‹©çš„ Navigation Graph æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æ²¡æœ‰ menu æ–‡ä»¶ï¼Œé‚£å°±åˆ›å»ºä¸€ä¸ªå§ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629000519557.png" alt="image-20190629000519557"></p>
<p>ç°åœ¨æˆ‘ä»¬ä¹Ÿæœ‰äº† menu æ–‡ä»¶ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;item
        android:id=&quot;@+id/feedFragment&quot;
        android:icon=&quot;@drawable/ic_tab_feed&quot;
        android:title=&quot;Feed&quot; /&gt;
    &lt;item
        android:id=&quot;@+id/timerFragment&quot;
        android:icon=&quot;@drawable/ic_tab_timer&quot;
        android:title=&quot;Timer&quot; /&gt;
    &lt;item
        android:id=&quot;@+id/mineFragment&quot;
        android:icon=&quot;@drawable/ic_tab_mine&quot;
        android:title=&quot;Mine&quot; /&gt;
&lt;/menu&gt;
</code></pre>
<p>ç°åœ¨å†å›å»çœ‹ tab_activity.xml å‘ç° preview å·²ç»å˜æˆäº†è¿™æ ·çš„ã€‚Cool</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629110347302.png" alt="image-20190629110347302"></p>
<p>éš¾é“ Menu å°±æ˜¯é‚£ä¸ªæŠŠå†…å®¹ (Fragment) ä¸å®¹å™¨ (NavHostFragment) è¿›è¡Œå»ºç«‹å…³ç³»çš„åª’ä»‹ï¼Ÿæ˜¯ä¹Ÿä¸æ˜¯ï¼Œæœ‰é‚£ä¹ˆä¸€ç‚¹å…³ç³»ï¼Œä¸è¿‡ä¸å¤ªå‡†ç¡®ã€‚è¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬ç”¨ä¸ RootFragment å’Œ SettingsFragment è¿›è¡Œåˆ‡æ¢é¡µé¢çš„æ–¹å¼å—ï¼Ÿä¸€ä¸ªæ˜¯å‰è¿›åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œä¸€ä¸ªæ˜¯è¿”å›ä¸Šä¸€ä¸ªé¡µé¢ï¼Œè™½ç„¶æœ€ç»ˆçš„è¡Œä¸ºä¸åŒï¼Œä½†æ˜¯å®ƒä»¬éƒ½ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå« <strong>NavController</strong> çš„ç±»ï¼Œè¿™ä¸ªç±»å®é™…ä¸Šå°±æ˜¯å®ç°åœ¨ Fragment ä¹‹é—´è¿›è¡Œè·³è½¬çš„ç±»ã€‚</p>
<pre><code class="language-java">Navigation.findNavController(btnToSettings).navigate(action);
Navigation.findNavController(btnToRoot).popBackStack();
</code></pre>
<p>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ Navigation Controller å¹¶ç»“åˆåº•éƒ¨å¯¼èˆªèœå•çš„ç‚¹å‡»äº‹ä»¶æ¥å¯¹ Fragment è¿›è¡Œæ§åˆ¶ï¼Œä»è€Œå®ç° Fragment ä¹‹é—´çš„åˆ‡æ¢ï¼Ÿæ˜¯è¿™æ ·çš„ï¼Œæ²¡é”™ï¼Œä¸è¿‡ Google å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†å¾ˆå¤šå¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ TabActivity ä¸­æ·»åŠ ä¸‹é¢è¿™äº›ä»£ç å³å¯ã€‚</p>
<pre><code class="language-java">private void setUpNavBottom() {
    NavHostFragment hostFragment = (NavHostFragment) getSupportFragmentManager()
        .findFragmentById(R.id.fragment3);
    BottomNavigationView navMenu = findViewById(R.id.nv_bottom_menu);
    if (hostFragment != null) {
        NavController navController = hostFragment.getNavController();
        NavigationUI.setupWithNavController(navMenu, navController);
    }
}
</code></pre>
<p>ç¬¬ä¸€è¡Œï¼ŒfindFragmentById é‡Œå¡«å†™çš„ id å°±æ˜¯æˆ‘ä»¬åœ¨ tab_activity.xml ä¸­ name å±æ€§æ˜¯ NavHostFragment èŠ‚ç‚¹çš„ idã€‚</p>
<p>ç„¶åå†é€šè¿‡ <code>NavigationUI.setupWithNavController()</code> å°†äºŒè€…è¿›è¡Œæƒ³ç®¡ç†ï¼Œè¿™æ ·åªè¦æˆ‘ä»¬ç‚¹å‡»åº•éƒ¨å¯¼èˆªèœå•å°±æ˜¯è‡ªåŠ¨å®ç° Fragment çš„ä¹‹é—´çš„åˆ‡æ¢ï¼Œå®Œå…¨ä¸éœ€è¦å¼€å‘è€…è‡ªå·±å»å†™é‚£ä¹ˆæ§åˆ¶é€»è¾‘ã€‚äº‹å®ä¸Šï¼Œ<code>NavigationUI.setupWithNavController()</code> è¿™ä¸ªæ–¹æ³•æœ‰å¾ˆå¤šé‡è½½æ–¹æ³•ï¼Œä¸ä»…ä»…åªæ˜¯ç”¨åœ¨ BottomNavigationViewï¼Œè¿˜æœ‰ NavigationView ç­‰ï¼Œåœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯•è¯•ã€‚ç°åœ¨æ¥çœ‹çœ‹æ•ˆæœã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_bottomNav-1779718.gif" alt="Blognav_bottomNav"></p>
<h2 id="deeplink">DeepLink</h2>
<p>æ¥æ¥æ¥ï¼Œå›é¡¾ä¸€ä¸‹åˆšæ‰æˆ‘ä»¬ä»‹ç»çš„ Navigation Graphï¼Œå®ƒå°±æ˜¯ç”¨äºæè¿° Fragment æˆ–è€…è¯´ç”¨äºæè¿°å†…å®¹ä¿¡æ¯çš„ï¼Œåˆšæ‰æˆ‘ä»¬å°è¯•äº†å­èŠ‚ç‚¹ Fragment çš„ actionï¼ˆé¡µé¢è·³è½¬ï¼‰ä¸ argumentsï¼ˆBundle ä¼ å€¼ï¼‰èŠ‚ç‚¹ï¼Œå…¶å®ä»–è¿˜æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ deepLinkã€‚</p>
<p>ä¸çŸ¥é“ï¼Œä½ æœ‰æ²¡æœ‰é‡åˆ°é‚£ç§æƒ…å†µï¼Œæœ‹å‹åœ¨å¾®ä¿¡ä¸Šåˆ†äº«ä½ ä¸€ä¸ªè¿æ¥ï¼Œä½ ä¸€ç‚¹å¼€ï¼Œé¡µé¢ä¸Šæç¤ºä½ ä½¿ç”¨å¾®ä¿¡çš„åœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œä½ åœ¨ä¸€ç‚¹å¼€å‘ç°ï¼Œå‘ç°è·³è½¬åˆ°äº†ä¸€ä¸ªåº”ç”¨çš„é¡µé¢ä¸Šå»äº†ã€‚è¿™ç§è·³è½¬æ–¹å¼åœ¨ Navigation è¿™ä¸ªå¯¼èˆªæ¡†æ¶å†…å«åš deepLinkã€‚è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹å§ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª Fragmentï¼Œå°±å« DeepLinkFragment å¥½äº†ï¼Œè¿™ä¸ªé¡µé¢æˆ‘ä»¬è·Ÿä¹‹å‰çš„ Fragment ä¸€æ ·åªæ˜¾ç¤º DeepLinkFragment è¿™ä¸ªæ–‡å­—å¥½äº†ã€‚layout å¸ƒå±€æ–‡ä»¶åŠ Java ä»£ç å°±ä¸è´´äº†ã€‚ç°åœ¨å†æ¥çœ‹ Navigation Graph ä¸­æ€ä¹ˆå†™ã€‚</p>
<pre><code class="language-xml">fragment
    android:id=&quot;@+id/deepLinkFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.DeepLinkFragment&quot;
    android:label=&quot;fragment_deep&quot;
    tools:layout=&quot;@layout/fragment_deep&quot; &gt;
    &lt;deepLink
        android:id=&quot;@+id/deepLink&quot;
        app:uri=&quot;www.example.com/{myarg}&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<p>æ˜¯çš„ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼Œåœ¨ Navigation Graph ä¸­å°±å¤šäº†è¿™ä¹ˆç‚¹ä¸œè¥¿ï¼Œç„¶åè®°å¾—ä¸€å®šè¦è®°å¾—åœ¨ manifest çš„æ‰¿è½½ DeepLinkFragment çš„ Activity èŠ‚ç‚¹å†…å¼•å…¥ä½ çš„ Navigation Graphã€‚</p>
<blockquote>
<ol>
<li>é‚£é‡Œå¡«çš„ url åé¢å¤§æ‹¬å·åŒ…è£¹ç€çš„æ˜¯ä¼ å…¥ DeepLinkFragment çš„å€¼ï¼Œ<code>myarg</code> æ˜¯ keyï¼Œé€šè¿‡ Bundle è¿›è¡Œä¼ é€’ï¼›</li>
<li>æˆ‘åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œæœ‰ä¸¤ä¸ª Navigation Graph æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ç”¨äº RootFragment ä¸ SettingsFragment è¿›è¡Œè·³è½¬çš„ navigation.xmlï¼Œä¸€ä¸ªæ˜¯ç”¨äºåº•éƒ¨å¯¼èˆªèœå•æ çš„ tab_navigation.xmlï¼Œæˆ‘æŠŠ DeepLinkFragment æ”¾åœ¨äº† navigation.xml ä¸­ï¼Œæ‰€ä»¥ä¸‹é¢çš„å€¼æ˜¯ @navigation/navigationã€‚</li>
</ol>
</blockquote>
<pre><code class="language-xml">&lt;nav-graph android:value=&quot;@navigation/navigation&quot; /&gt;
</code></pre>
<p>æ¥è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹æ•ˆæœå§ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_deepLink.gif" alt="Blognav_deepLink"></p>
<p>å¥½äº†ï¼Œæˆ‘ä»¬æ•´ä¸ª Navigation çš„å­¦ä¹ åˆ°è¿™é‡Œä¹Ÿå‘Šä¸€æ®µè½äº†ï¼Œç»“æŸä¹‹å‰è®©æˆ‘ä»¬ç”¨ä¸€å¹…å›¾æ¥å›é¡¾ä¸€ä¸‹ Navigationã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629150736867.png" alt="image-20190629150736867"></p>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://jiangjiwei.site/">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­å…¨éƒ¨æºä»£ç å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œå–œæ¬¢çš„éº»çƒ¦ç‚¹ä¸ªğŸŒŸã€‚<br>
æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@jbcreate_?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Joseph Barrientos</a> on <a href="https://unsplash.com/search/photos/navigation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>

            </div>
          </article>
        </div>
    
        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://cherrylover.github.io/post/java-fan-xing">
              <h3 class="post-title">
                Java æ³›å‹
              </h3>
            </a>
          </div>  
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: 'f5cc70d7d50fba65cf69',
    clientSecret: '1d018e38ce9cdd399682bdd76690decfef00a051',
    repo: 'CherryLover.github.io',
    owner: 'CherryLover',
    admin: ['CherryLover'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        
    
        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
