<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://cherrylover.github.io</id>
    <title>Jiang</title>
    <updated>2019-08-06T02:32:30.901Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://cherrylover.github.io"/>
    <link rel="self" href="https://cherrylover.github.io/atom.xml"/>
    <subtitle>æˆ‘å…è®¸ä½ èµ°è¿›æˆ‘çš„ä¸–ç•Œï¼Œä½†ä¸è®¸ä½ åœ¨æˆ‘çš„ä¸–ç•Œé‡Œèµ°æ¥èµ°å»ã€‚</subtitle>
    <logo>https://cherrylover.github.io/images/avatar.png</logo>
    <icon>https://cherrylover.github.io/favicon.ico</icon>
    <rights>All rights reserved 2019, Jiang</rights>
    <entry>
        <title type="html"><![CDATA[[è½¬] ç›®æ ‡æ–¹æ³•å‰ç½®æ£€éªŒæ¨¡å‹è®¾è®¡ä¸å®ç°]]></title>
        <id>https://cherrylover.github.io/post/zhuan-biao-fang-fa-qian-zhi-jian-yan-mo-xing-she-ji-yu-shi-xian</id>
        <link href="https://cherrylover.github.io/post/zhuan-biao-fang-fa-qian-zhi-jian-yan-mo-xing-she-ji-yu-shi-xian">
        </link>
        <updated>2019-08-06T02:15:22.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡è½¬è½½è‡ª <a href="https://feelschaotic.github.io/">feelschaotic çš„ä¸ªäººåšå®¢</a></p>
</blockquote>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p><a href="https://www.jianshu.com/p/ed880f35f97f">ç»§ä¸Šæ¬¡çš„æŒ‡çº¹éªŒè¯</a>åï¼Œäº§å“åˆæå‡ºäº†ä¸ªé¡¹ç›®å…¸å‹éœ€æ±‚ï¼šç”¨æˆ·åœ¨æœªç™»å½•çŠ¶æ€ä¸‹ï¼Œç‚¹å‡»å…³æ³¨ï¼Œè·³è½¬ç™»å½•ï¼Œç™»å½•æˆåŠŸåè‡ªåŠ¨æ‰§è¡Œå…³æ³¨ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªéœ€æ±‚ï¼š</p>
<ol>
<li>è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•ç•Œé¢</li>
<li>ç™»å½•æˆåŠŸåå†è‡ªåŠ¨æ‰§è¡Œå…³æ³¨è¡Œä¸º</li>
</ol>
<p>æ€è€ƒä¸‹æŠ½è±¡å‡ºé€šç”¨æ€§ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯æ‰§è¡Œå…³æ³¨è¡Œä¸ºï¼Œä½†æ˜¯å…³æ³¨è¡Œä¸ºéœ€è¦ç”¨æˆ·å¤„äºç™»å½•çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´æ‰§è¡ŒæŸä¸ªæ“ä½œæ—¶éœ€è¦æ»¡è¶³ä¸€äº›å‰ææ¡ä»¶ï¼Œè€Œè¿™äº›å‰ææ¡ä»¶æ˜¯éœ€è¦ç”¨æˆ·å‚ä¸æ‰èƒ½æ»¡è¶³ã€‚å¯èƒ½å­˜åœ¨å¤šä¸ªå‰ææ¡ä»¶çš„éœ€æ±‚ï¼Œè¿™é‡Œå¯ä»¥åˆ†ç¦»å‡ºç›®æ ‡è¡Œä¸ºå’Œå‰ææ¡ä»¶è¡Œä¸ºã€‚</p>
<h2 id="æŠ€æœ¯é€‰å‹">æŠ€æœ¯é€‰å‹</h2>
<p>é‚£å°±ç™»å½•é¡µé¢åŠ ä¸ªå›è°ƒå–½ï¼Œç™»å½•æˆåŠŸå°±å›è°ƒå›å»ï¼Œä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä¸æƒ³åœ¨ç™»å½•ç•Œé¢ä¾µå…¥å¤ªå¤šé€»è¾‘ä»£ç ï¼Œè€Œä¸”ä¹Ÿè¿èƒŒäº†å¯ç»´æŠ¤æ€§å’Œé€šç”¨æ€§ï¼Œéš¾é“ä»¥åæ‰©å±•æ—¶ï¼Œæ¯ä¸ªå‰ç½®æ¡ä»¶éƒ½è¦åŠ å›è°ƒï¼Ÿ</p>
<p>å†æ€è€ƒï¼Œç¬¬ä¸€æƒ³æ³•æ˜¯åˆ©ç”¨äº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼ˆEventBusã€BroadcastReceiverï¼‰ï¼ŒæŠŠç™»å½•æˆåŠŸè¿™ä¸ªäº‹ä»¶ post å‡ºå»ï¼Œå¼‚æ­¥æ‰§è¡Œå…³æ³¨è¡Œä¸ºã€‚ä½†å¦‚æœå‰ææ¡ä»¶æœ‰å¤šä¸ªå‘¢ï¼Œæ˜¯ä¸æ˜¯å¾—å‘é€å¤šä¸ªäº‹ä»¶ï¼Ÿæ˜¯ä¸æ˜¯å¾—ç›‘å¬å¤šä¸ªäº‹ä»¶ï¼Ÿè€Œä¸”ï¼Œå¦‚æœä¸‹æ¬¡éœ€æ±‚æ”¹äº†ï¼Œç›®æ ‡äº‹ä»¶ä¸æ˜¯æ‰§è¡Œå…³æ³¨äº‹ä»¶äº†ï¼Œè€Œæ˜¯æ‰§è¡Œå‘å¸–æˆ–è€…è·³è½¬åˆ°æŸä¸ªé¡µé¢ï¼Œé‚£ä¹‹å‰å…³æ³¨è¡Œä¸ºå·²ç»æ³¨å†Œäº†ï¼Œè¿˜æ˜¯ä¼šé€šçŸ¥åˆ°å…³æ³¨äº‹ä»¶ï¼Œéš¾é“è¦é€šè¿‡ msg æ ‡å¿—ä½æ¥åŒºåˆ†ä¸åŒçš„ç›®æ ‡è¡Œä¸ºå—ï¼Ÿæœ‰æ²¡æœ‰æ›´ä¼˜é›…ç®€æ´çš„æ–¹å¼å‘¢ï¼Ÿ</p>
<p>å†æ€è€ƒï¼Œå¦‚æœç”¨æ‹¦æˆªå™¨å‘¢ï¼Ÿ</p>
<p>è¿™ç§è¡Œä¸ºæ¨¡å¼å’Œæ‹¦æˆªå™¨éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ˜¯åœ¨æ‰§è¡Œç›®æ ‡å‰ï¼Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚</p>
<p>ä½†æ˜¯æ‹¦æˆªå™¨ä¼¼ä¹å¹¶ä¸èƒ½ç›´æ¥å®Œæˆæˆ‘ä»¬çš„éœ€æ±‚ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æ’å…¥ä¸€ä¸ªéªŒè¯è¡Œä¸ºåï¼ˆä¾‹å¦‚è¿›å…¥ç™»å½•ç•Œé¢ï¼‰ï¼Œè¿˜è¦æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œä¿è¯è¿™ä¸ªéªŒè¯è¡Œä¸ºé€šè¿‡åï¼Œæ‰èƒ½çœŸæ­£æ‰§è¡Œæˆ‘ä»¬çš„ç›®æ ‡è¡Œä¸ºã€‚æ‹¦æˆªå™¨æ‰§è¡Œå®Œåï¼Œé©¬ä¸Šä¼šæ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚ä¸­é—´å¹¶ä¸ä¼šç­‰å¾…ã€‚æ‰€ä»¥æˆ‘ä»¬æ ¹æœ¬æ²¡æœ‰åŠæ³•å»æ‰§è¡Œæˆ‘ä»¬çš„ç™»å½•æ“ä½œï¼Œæ‰€ä»¥passäº†ã€‚</p>
<p>é‚£è®¾è®¡æ¨¡å¼é‡Œçš„è´£ä»»é“¾æ¨¡å¼ï¼Œèƒ½ä¸èƒ½æä¾›ç‚¹ä»€ä¹ˆæ€è·¯å‘¢ï¼Ÿ</p>
<p>åœ¨è´£ä»»é“¾æ¨¡å¼é‡Œï¼Œå¾ˆå¤šçš„å¤„ç†å¯¹è±¡ç”±æ¯ä¸€ä¸ªå¯¹è±¡å¯¹å…¶ä¸‹å®¶çš„å¼•ç”¨è€Œè”æ¥èµ·æ¥å½¢æˆä¸€æ¡é“¾ã€‚è¯·æ±‚åœ¨è¿™ä¸ªé“¾ä¸Šä¼ é€’ï¼Œç›´åˆ°é“¾ä¸Šçš„<strong>æŸä¸€ä¸ª</strong>å¯¹è±¡å†³å®šå¤„ç†æ­¤è¯·æ±‚ã€‚<strong>æ³¨æ„ï¼Œæ˜¯æŸä¸€ä¸ª</strong>ï¼è€Œæˆ‘ä»¬çš„åœºæ™¯æ˜¯ï¼Œéœ€è¦é€šè¿‡<strong>æ‰€æœ‰çš„</strong>å‰ç½®æ¡ä»¶éªŒè¯ï¼Œæ‰èƒ½æ‰§è¡Œç›®æ ‡æ–¹æ³•ã€‚</p>
<h2 id="è®¾è®¡ä¸å®ç°">è®¾è®¡ä¸å®ç°</h2>
<p>æ€è€ƒå¯ä»¥æ”¹è‰¯ä¸€ä¸‹è´£ä»»é“¾ï¼Œæ¯ä¸€ä¸ªå‰ç½®æ¡ä»¶å¯¹è±¡ï¼ˆ<code>Valid</code>ç±»ï¼‰ä¸å†æŒæœ‰å…¶ä¸‹å®¶çš„å¼•ç”¨ï¼Œè€Œæ˜¯é‡‡ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨æ‰€æœ‰çš„å‰ç½®æ¡ä»¶å¯¹è±¡ï¼Œä»¥å…ˆè¿›å…ˆå‡ºçš„é¡ºåºä¾æ¬¡éªŒè¯æ¡ä»¶ã€‚</p>
<pre><code class="language-java">private Queue&lt;Valid&gt; validQueue = new ArrayDeque&lt;&gt;();
</code></pre>
<p>å‰ç½®æ¡ä»¶å¯¹è±¡æŠ½è±¡ä¸ºæ¥å£<code>Valid</code></p>
<pre><code class="language-java">public interface Valid {
    /**
     * æ˜¯å¦æ»¡è¶³æ£€éªŒå™¨çš„è¦æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³çš„è¯ï¼Œåˆ™æ‰§è¡ŒdoValid()æ–¹æ³•ã€‚å¦‚æœæ»¡è¶³ï¼Œåˆ™æ‰§è¡Œç›®æ ‡action.call
     * @return
     */
    boolean preCheck();

    /**
     * å»æ‰§è¡ŒéªŒè¯å‰ç½®è¡Œä¸ºï¼Œä¾‹å¦‚è·³è½¬åˆ°ç™»å½•ç•Œé¢ã€‚ï¼ˆä½†å¹¶æœªå®ŒæˆéªŒè¯ã€‚æ‰€ä»¥éœ€è¦åœ¨ç™»é™†æˆåŠŸæ—¶è°ƒç”¨preCheck()å†æ¬¡æ£€æŸ¥ï¼‰
     */
    void doValid();

}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠå‰ç½®æ¡ä»¶å¯¹è±¡çš„éªŒè¯æ¡ä»¶å’Œæ“ä½œåˆ†ç¦»å¼€æ¥ã€‚</p>
<p>ç›®æ ‡å¯¹è±¡<code>Action</code>å°±å¾ˆç®€å•äº†ï¼Œä»…æ‹¥æœ‰ä¸€ä¸ªç›®æ ‡æ‰§è¡Œæ–¹æ³•ã€‚</p>
<pre><code class="language-java">public interface Action {
    void call();
}
</code></pre>
<p>æ•´ä½“çš„éªŒè¯æµç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/delay-action/delay_action_process.png" alt="éªŒè¯æµç¨‹"></p>
<p>å¾ªç¯ä»å‰ç½®æ¡ä»¶å¯¹è±¡é˜Ÿåˆ— <code>validQueue</code> é‡Œå–å‡ºéªŒè¯å¯¹è±¡ï¼Œè°ƒç”¨ check æ–¹æ³•åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œä¸æ»¡è¶³åˆ™è¿›å…¥è¯¥éªŒè¯å¯¹è±¡çš„éªŒè¯æµç¨‹ï¼ŒéªŒè¯å®Œæ¯•ï¼Œå†æ¬¡è°ƒç”¨ check æ–¹æ³•åˆ¤æ–­æ»¡è¶³æ¡ä»¶ï¼Œå¦‚æœæ»¡è¶³åˆ™å–ä¸‹ä¸€ä¸ªï¼Œç›´è‡³é˜Ÿåˆ—ä¸ºç©ºï¼Œå°±å¯ä»¥ç›´æ¥æ‰§è¡Œç›®æ ‡æ–¹æ³•äº†ã€‚</p>
<p>é‚£ä¹ˆå‰ç½®æ¡ä»¶å¯¹è±¡é˜Ÿåˆ— <code>validQueue</code> å’Œç›®æ ‡å¯¹è±¡çš„æŒæœ‰æ–¹ï¼Œæˆ‘ä»¬å°è£…ä¸º <code>Call</code>ï¼Œæ„ä¸ºä¸€æ¬¡æ‰§è¡Œã€‚</p>
<pre><code class="language-java">public class Call {
    //ç›®æ ‡å¯¹è±¡ 
    private Action action;
    //å…ˆè¿›å…ˆå‡ºéªŒè¯æ¨¡å‹
    private Queue&lt;Valid&gt; validQueue = new ArrayDeque&lt;&gt;();
    //ä¸Šä¸€ä¸ªæ‰§è¡Œçš„valid
    private Valid lastValid;

}
</code></pre>
<p>åŒ…è£…ä¸€ä¸ªå•ä¾‹çš„æŒæœ‰Callå¯¹è±¡çš„å¤–è§‚ç±» <code>SingleCall</code>ï¼Œæä¾›ç»™ä¸šåŠ¡å±‚è°ƒç”¨ã€‚</p>
<pre><code class="language-java">public class SingleCall {

    private Call call = new Call();

    public SingleCall addAction(Action action) {
        clear();
        call.setAction(action);
        return this;
    }

    public SingleCall addValid(Valid valid) {
        //åªæ·»åŠ æ— æ•ˆçš„ï¼ŒéªŒè¯ä¸é€šè¿‡çš„
        if (valid.preCheck()) {
            return this;
        }
        call.addValid(valid);
        return this;
    }

    public void doCall() {
        //å¦‚æœä¸Šä¸€æ¡validæ²¡æœ‰é€šè¿‡ï¼Œæ˜¯ä¸å…è®¸å†å‘èµ·callçš„
        if (call.getLastValid() != null &amp;&amp; !call.getLastValid().preCheck()) {
            return;
        }

        //å¦‚æœå…¨éƒ¨éƒ½éªŒè¯é€šè¿‡äº†ï¼Œæ‰§è¡Œaction
        if (call.getValidQueue().size() == 0) {
            if (call.getAction() != null) { //å®¹é”™å¤„ç†
                call.getAction().call();
                clear();
            }
        } else {
            //æ‰§è¡ŒéªŒè¯
            Valid valid = call.getValidQueue().poll();
            call.setLastValid(valid);
            valid.doValid();
        }

    }
    .....
}
</code></pre>
<p>è°ƒç”¨ç¤ºä¾‹ï¼ˆå¸¸ç”¨åœºæ™¯ï¼Œå• Actionï¼‰ï¼š</p>
<p><code>Activity</code> å®ç° <code>Action</code> æ¥å£ï¼Œæˆ– new ä¸€ä¸ª<code>Action</code> å®ç°ç±»ï¼Œå®ç° call ç›®æ ‡è¡Œä¸ºã€‚</p>
<p>å‰ç½®è¡Œä¸ºå®Œæˆåï¼Œè°ƒç”¨ <code>SingleCall.getInstance().doCall();</code> é‡æ–°å¯åŠ¨éªŒè¯æ¨¡å‹ã€‚å› ä¸ºéªŒè¯æ“ä½œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨è§¦å‘å®Œæˆï¼Œæˆ‘ä»¬åªæ˜¯å¼•å¯¼ç”¨æˆ·åˆ°äº†éªŒè¯ä½“é‡Œï¼Œç”±äºæˆ‘ä»¬å› ä¸ºç­‰å¾…ç”¨æˆ·çš„æ“ä½œï¼ŒéªŒè¯æ¨¡å‹å°±åœ¨è¿™é‡Œåœä¸‹æ¥äº†ï¼Œå¦‚æœéªŒè¯æ“ä½œæˆåŠŸäº†ï¼Œæˆ‘ä»¬éœ€è¦è®©æ•´ä¸ªéªŒè¯æ¨¡å‹å†è¿è½¬èµ·æ¥äº†ï¼Œæ‰€ä»¥éªŒè¯åï¼Œæ°¸è¿œå°‘ä¸äº†æ‰‹åŠ¨å¼€å¯éªŒè¯æ¨¡å‹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ•´ä¸ªæ¨¡å‹çš„ç±» UML å›¾ï¼Œé‡ç‚¹æ¢³ç† Validã€Callã€Action ä¸‰è€…çš„å…³ç³»ï¼š</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/delay-action/delay_action_uml.png" alt="ç±» UML å›¾"></p>
<h2 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</h2>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/delay-action/delay_action_since.png" alt=""></p>
<h2 id="æºç åœ°å€">æºç åœ°å€</h2>
<p><a href="https://github.com/feelschaotic/DelayAction">github æºç åœ°å€</a></p>
<ul>
<li>å¢åŠ äº†å®¹é”™å¤„ç†</li>
<li>è¡¥å……äº†åµŒå¥— Call çš„æƒ…å†µ</li>
</ul>
<blockquote>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://www.jianshu.com/p/22a9d4eb07ce">åœ¨æ‰§è¡Œç›®æ ‡æ“ä½œå‰ï¼Œæ’å…¥Nä¸ªéœ€è¦ç”¨æˆ·å‚ä¸çš„æ“ä½œï¼Œç®€åŒ–æ­¤è¿‡ç¨‹</a></li>
<li><a href="https://www.jianshu.com/p/1d0180ec64fb">android ç™»å½•æˆåŠŸåå†è·³è½¬åˆ°ç›®æ ‡ç•Œé¢çš„æ€è€ƒ</a></li>
</ul>
</blockquote>
<p>æœ¬æ–‡è½¬è½½è‡ª <a href="https://feelschaotic.github.io/">feelschaotic çš„ä¸ªäººåšå®¢</a>ï¼Œå°é¢å›¾æ˜¯ç¼–è€…åŠ çš„ï¼Œå°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@chengfengrecord?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">cheng feng</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Navigation ä¹‹ Fragment åˆ‡æ¢]]></title>
        <id>https://cherrylover.github.io/post/navigation-zhi-fragment-qie-huan</id>
        <link href="https://cherrylover.github.io/post/navigation-zhi-fragment-qie-huan">
        </link>
        <updated>2019-07-24T07:13:43.000Z</updated>
        <content type="html"><![CDATA[<p>æœ¬ç¯‡æ˜¯æœ‰å…³ Navigation çš„ç¬¬äºŒç¯‡ï¼Œå¦‚æœ‰å¯¹ Navigation ä¸äº†è§£çš„æœ‹å‹è¯·å…ˆé˜…è¯»<a href="https://jiangjiwei.site/post/lai-xue-yi-bo-navigation/">æ¥å­¦ä¸€æ³¢ Navigation</a>ã€‚</p>
<p>åœ¨ä¸Šä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ Navigation ä¸ BottomNavigationView åšå‡ºäº†ä¸€ä¸ªæœ‰ä¸‰ä¸ª Tab çš„é¡µé¢ï¼Œåˆ†åˆ«æ˜¯ Feedã€Timerã€Mineï¼Œè¿™ä¸‰ä¸ª Fragment éƒ½æ˜¯åªåœ¨å½“å‰é¡µé¢æ˜¾ç¤ºå„è‡ªçš„åç§°ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥ç»™ TimerFragment åŠ ç‚¹å†…å®¹ï¼Œæˆ‘ä»¬åœ¨ TimerFragment çš„ onCreateView æ–¹æ³•ä¸­å¯åŠ¨ä¸€ä¸ªå€’è®¡æ—¶ã€‚</p>
<pre><code class="language-java">private void startTimer() {
    new CountDownTimer(10 * 1000, 1000) {

        @Override
        public void onTick(long millisUntilFinished) {
            tvLabel.setText(String.valueOf((millisUntilFinished / 1000) + 1));
        }

        @Override
        public void onFinish() {
            tvLabel.setText(&quot;Finished&quot;);
        }
    }.start();
}
</code></pre>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_nav_tab.gif" alt=""></p>
<p>ä»”ç»†çœ‹ä¸Šé¢çš„æ•ˆæœå¯ä»¥çœ‹åˆ°ï¼Œæ¯æ¬¡åˆ‡æ¢åˆ° TimerFragment æ—¶ï¼Œå€’è®¡æ—¶æ€»ä¼šé‡æ–°å¼€å§‹ï¼Œä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä»…å¼€å§‹ä¸€æ¬¡ã€‚è¿™æ˜¯ä»€ä¹ˆé—®é¢˜å¯¼è‡´çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ TimerFragment æ‰§è¡Œäº†å¤šæ¬¡çš„ onCreateViewï¼Œä¸ºä»€ä¹ˆæ˜¯ä¼šæ‰§è¡Œå¤šæ¬¡ï¼ŒFragment ä¸ºä»€ä¹ˆä¼šåŠ è½½å¤šæ¬¡ï¼Ÿæˆ‘ä»¬æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„æ“ä½œå‘€ã€‚æ˜¯ä¸æ˜¯å› ä¸º Navigationï¼Ÿ</p>
<p>ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥åˆ° Navigation çš„æºç çœ‹ä¸€çœ‹è¿™åˆ°åº•æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Œä»¥åŠæˆ‘ä»¬æ”¹å¦‚ä½•è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®æˆ‘ä»¬çš„æ–¹å‘ï¼Œå°±æ˜¯ Navigation åˆ°åº•æ˜¯æ€ä¹ˆåš Fragment åˆ‡æ¢çš„ï¼Œä¸ºä»€ä¹ˆä¼šå¯¼è‡´ Fragment çš„ onCreateView è¢«å¤šæ¬¡æ‰§è¡Œã€‚</p>
<p>ä»å“ªé‡Œä½œä¸ºå…¥å£å‘¢ï¼Ÿäº†è§£è¿‡ Navigation çš„æœ‹å‹å¯¹ä¸‹é¢è¿™è¡Œä»£ç åº”è¯¥ä¸ä¼šé™Œç”Ÿï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ª View è·å–åˆ° NavControllerï¼Œç„¶åé€šè¿‡æ‰§è¡Œ NavController çš„ navigate è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±ä»è¿™ä¸ªæ–¹æ³•å¼€å§‹ã€‚</p>
<pre><code class="language-java">Navigation.findNavController(view)
        .navigate(id);
</code></pre>
<p>è¿™ä¸ª navigate æœ‰å¤šä¸ªé‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬å¼€å§‹çš„ navigate æ–¹æ³•æœ€ç»ˆä¹Ÿæ˜¯æ‰§è¡Œåˆ°ä¸‹é¢è¿™ä¸ªé‡è½½æ–¹æ³•ã€‚</p>
<pre><code class="language-java">navigate(NavDestination node, Bundle args, NavOptions navOptions, Navigator.Extras navigatorExtras)
</code></pre>
<p>æ–¹æ³•çš„å…·ä½“å†…å®¹å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_code_navigate.png" alt=""></p>
<p>å…¶ä¸­åœ¨ç¬¬ 9 è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡ mNavigatorProvider è·å–åˆ°äº†ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º NavDestination çš„ Navigator å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨ç¬¬ 12 è¡Œæ—¶ï¼Œé€šè¿‡è°ƒç”¨åˆšè·å–åˆ°çš„ navigator çš„ navigate æ–¹æ³•ï¼Œå¾—åˆ°äº† NavDestination è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p>è¿™ä¸¤è¡Œæ˜¯å…³é”®ä»£ç ï¼Œä¸€ä¸ªæ˜¯è·å–åˆ°æ‰§è¡Œ navigate çš„å¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯å®é™…æ‰§è¡Œ navigate çš„æ–¹æ³•ã€‚çœ‹åˆ°è¿™ï¼Œæˆ‘ä»¬å°±åªéœ€è¦æ‰¾åˆ° Navigator çš„ navigate æ–¹æ³•å³å¯ã€‚ä¸è¿‡ï¼ŒNavigator è¿™ä¸ªåªæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»§ç»­å¯»æ‰¾å®ƒçš„å®ç°ç±»ã€‚</p>
<blockquote>
<p>å¿«æ·é”®ï¼šImplementation(s) Mac: option(âŒ¥) + command(âŒ˜)+B</p>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/image-20190724110340568.png" alt="image-20190724110340568"></p>
<p>Navigator æŠ½è±¡ç±»çš„å…³é”®ä»£ç ï¼š</p>
<pre><code class="language-java">public abstract class Navigator&lt;D extends NavDestination&gt; {
    @Retention(RUNTIME)
    @Target({TYPE})
    @SuppressWarnings(&quot;UnknownNullness&quot;)
    public @interface Name {
        String value();
    }

    @NonNull
    public abstract D createDestination();

    @Nullable
    public abstract NavDestination navigate(@NonNull D destination, @Nullable Bundle args,
            @Nullable NavOptions navOptions, @Nullable Extras navigatorExtras);

    public abstract boolean popBackStack();

    @Nullable
    public Bundle onSaveState() {
        return null;
    }

    public void onRestoreState(@NonNull Bundle savedState) {
    }

    public interface Extras {
    }
}
</code></pre>
<p>é€šè¿‡å¿«æ·é”®æˆ‘ä»¬èƒ½æ‰¾åˆ°å¤šä¸ªå®ç°ç±»ï¼Œæœ‰ ActivityNavigatorã€DialogFragmentNavigator è¿˜æœ‰ FragmentNavigator ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬åªå…³æ³¨ FragmentNavigator è¿™ä¸ªç±»ä¸­çš„ navigate è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_code_navigate_real.png" alt=""></p>
<p>åˆ«çœ‹è¿™ä¹ˆå¤šä»£ç ï¼Œåˆ«å®³æ€•ï¼Œå…¶å®å…³é”®éƒ¨åˆ†çš„ä»£ç å°±æ˜¯ç¬¬ 32 è¡Œ <code>ft.replace(mContainerId, frag)</code> è¿™é‡Œä½¿ç”¨çš„æ˜¯ FragmentTransaction çš„ replace æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ç”¨è¯´äº†å§ã€‚ replace æ˜¯ç§»é™¤äº†ç›¸åŒ id çš„ fragment ç„¶åå†è¿›è¡Œ add çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œçœ‹åˆ°è¿™ï¼Œæˆ‘ä»¬ä¹Ÿå°±çŸ¥é“äº†ï¼Œä¸ºä»€ä¹ˆ TimerFragment çš„ onCreateView æ–¹æ³•ä¼šè¢«æ‰§è¡Œå¤šæ¬¡äº†ï¼ŒåŸå› å°±æ˜¯åœ¨è¿™ã€‚</p>
<p>æ‰¾åˆ°åŸå› äº†ï¼Œé‚£æˆ‘ä»¬æœ‰ä»€ä¹ˆæ–¹æ³•å»è§„é¿ï¼Œæˆ–è€…è¯´å»ç»•è¿‡è¿™ä¸ª replace å—ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ã€‚</p>
<p>è¿˜è®°å¾—åˆšæ‰æˆ‘ä»¬æ‰¾çš„ä¸‹é¢è¿™è¡Œä»£ç å§ï¼ˆå¿˜è®°çš„ï¼Œè¯·çœ‹ç¬¬ä¸€å¼ ä»£ç å›¾çš„ç¬¬ 9 è¡Œï¼‰ï¼Œåˆšæ‰æˆ‘è¯´ï¼Œé€šè¿‡ mNavigatorProvider æ‰¾åˆ°ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º NavDestination çš„ Navigator å¯¹è±¡ï¼Œé‚£å®ƒå®é™…ä¸Šæ˜¯æ€ä¹ˆæ‰¾åˆ°çš„å‘¢ï¼Ÿæ˜¯é€šè¿‡ node.getNavigatorName() ç„¶åæ‰¾çš„ï¼Œè¿™ä¸ª node æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿä»¥åŠ mNavigatorProvider.getNavigator å†…éƒ¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="language-java">Navigator&lt;NavDestination&gt; navigator = mNavigatorProvider.getNavigator(
        node.getNavigatorName());
</code></pre>
<p>å®é™…ä¸Šè¿™é‡Œçš„ node å°±æ˜¯ä¸€ä¸ª NavDestination å¯¹è±¡ï¼Œè€Œä¸€ä¸ª NavDestination å¯¹è±¡å°±æ˜¯å¯¹åº”ç€ navigation graph ä¸­çš„èŠ‚ç‚¹ä¿¡æ¯ã€‚æˆ‘ç”¨æ¥æ¼”ç¤ºçš„ Demo çš„ navigation graph æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/tab_navigation&quot;
    app:startDestination=&quot;@id/feedFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/feedFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.FeedFragment&quot;
        android:label=&quot;fragment_feed&quot;
        tools:layout=&quot;@layout/fragment_feed&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/timerFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.TimerFragment&quot;
        android:label=&quot;fragment_timer&quot;
        tools:layout=&quot;@layout/fragment_timer&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/mineFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.MineFragment&quot;
        android:label=&quot;fragment_mine&quot;
        tools:layout=&quot;@layout/fragment_mine&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>node.getNavigatorName è¿”å›çš„å°±æ˜¯ fragment èŠ‚ç‚¹çš„èŠ‚ç‚¹åç§° <code>fragment</code>ï¼Œè€Œ getNavigator å…¶å®å†…éƒ¨å°±æ˜¯ç»´æŠ¤äº†ä¸€ä¸ªç±»å‹ä¸º HashMap çš„ mNavigatorsï¼Œè¿™ä¸ª HashMap å­˜çš„ key å°±æ˜¯èŠ‚ç‚¹åç§°ï¼Œvalue å°±æ˜¯æŠ½è±¡ç±» Navigator çš„å®ç°ç±»ã€‚è€Œ fragment å¯¹åº”çš„ FragmentNavigator ä¹Ÿå­˜å‚¨åœ¨å…¶ä¸­ã€‚</p>
<p>æ—¢ç„¶æ˜¯å­˜åœ¨ä¸€ä¸ª mapï¼Œå¹¶ä»ä¸­å–å‡ºç›¸å¯¹äºçš„ Navigator å®ç°ç±»ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½åˆ›å»ºä¸€ä¸ªç±»å¹¶å®ç° Navigatorï¼Œç„¶åå°† keyã€value æ·»åŠ åˆ°é‚£ä¸ª HashMap ä¸­ã€‚ç­”æ¡ˆæ˜¯å¯è¡Œçš„ã€‚åœ¨NavigatorProvider è¿™ä¸ªç±»ä¸­æœ‰ä¸¤ä¸ªå…¬å…±æ–¹æ³•ï¼š</p>
<ul>
<li>addNavigator(Navigator navigator)</li>
<li>addNavigator(String name, Navigator navigator)</li>
</ul>
<p>å…¶ä¸­ï¼Œä¸€ä¸ªå‚æ•°çš„ addNavigator ä¹Ÿæ˜¯è°ƒç”¨äº† ä¸¤ä¸ªå‚æ•°çš„ addNavigator æ–¹æ³•ï¼Œé‚£ä¸ª name ä¹Ÿå°±æ˜¯ navigation graph ä¸­ fragment èŠ‚ç‚¹çš„èŠ‚ç‚¹åç§°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Navigator è¿™ä¸ªæŠ½è±¡ç±»ä¸­æ³¨è§£ <code>Name</code> å®šä¹‰çš„å€¼ã€‚è€Œä¸”åœ¨ NavController è¿™ä¸ªç±»ï¼ˆæœ€åˆæˆ‘ä»¬æ‰¾åˆ°çš„ navigate æ‰€åœ¨çš„ç±»ï¼‰ä¸­æœ‰ä¸€ä¸ª getNavigatorProvider() æ–¹æ³•ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/uml_blog_navigation.jpg" alt=""></p>
<p>çœ‹åˆ°è¿™ï¼Œå…³ç³»åº”è¯¥å°±æ¯”è¾ƒæ¸…æ¥šäº†ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®ç° Navigator å¹¶æœª Name æ³¨è§£æ·»åŠ ä¸€ä¸ªå€¼ï¼Œç„¶ååœ¨ä½¿ç”¨ Navigation è¿™ä¸ªæ¨¡å—çš„ Activity è·å–åˆ° NavController å¹¶è°ƒç”¨å…¶ getNavigatorProvider æ–¹æ³•åå†è°ƒç”¨ addNavigator å³å¯ã€‚</p>
<p>Github ä¸Šå·²ç»æœ‰ä¸€ä¸ªæ¼”ç¤ºè‡ªå®šä¹‰å®ç° Navigator çš„é¡¹ç›®äº†ã€‚è¿™ä¸ªé¡¹ç›®æ˜¯ä»¥ Kotlin è¯­è¨€ç¼–å†™çš„ã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š https://github.com/STAR-ZERO/navigation-keep-fragment-sampleã€‚</p>
<blockquote>
<p>è¯´èµ·æ¥è¿™ä¸ªé¡¹ç›®è¿˜æ˜¯ <a href="https://github.com/drakeet">Drakeet</a> åœ¨ä»–çš„çŸ¥è¯†æ˜Ÿçƒä¸­åˆ†äº«çš„ã€‚æ„Ÿè°¢ Drakeet çš„åˆ†äº«ã€‚</p>
</blockquote>
<p>æˆ‘æ ¹æ®æŒ‰ç…§ä»–çš„ä»£ç å†™äº†ä¸€ä»½ Java ç‰ˆæœ¬çš„ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­æ”¹äº†ä¸¤è¡Œä»£ç ï¼ˆæ³¨é‡Šéƒ¨åˆ†ï¼‰ã€‚æ³¨é‡Šçš„å†…å®¹å…¶å®å°±æ˜¯ä½¿ç”¨ FragmentTranslation å¯¹ Fragment è¿›è¡Œæ§åˆ¶ã€‚åŸä½œè€…å†™çš„æ˜¯ detach ä¸ attach æ–¹æ³•ï¼Œæˆ‘æ”¹æˆäº†ä½¿ç”¨ hide å’Œ show æ–¹æ³•ã€‚</p>
<pre><code class="language-java">@Navigator.Name(&quot;keep_state_fragment&quot;)
public class KeepStateNavigator extends FragmentNavigator {
    private Context context;
    private FragmentManager manager;
    private int containerId;

    public KeepStateNavigator(@NonNull Context context, @NonNull FragmentManager manager, int containerId) {
        super(context, manager, containerId);
        this.context = context;
        this.manager = manager;
        this.containerId = containerId;
    }

    @Nullable
    @Override
    public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) {
        String tag = String.valueOf(destination.getId());
        FragmentTransaction transaction = manager.beginTransaction();
        boolean initialNavigate = false;
        Fragment currentFragment = manager.getPrimaryNavigationFragment();
        if (currentFragment != null) {
//            transaction.detach(currentFragment);
            transaction.hide(currentFragment);
        } else {
            initialNavigate = true;
        }
        Fragment fragment = manager.findFragmentByTag(tag);
        if (fragment == null) {
            String className = destination.getClassName();
            fragment = manager.getFragmentFactory().instantiate(context.getClassLoader(), className);
            transaction.add(containerId, fragment, tag);
        } else {
//            transaction.attach(fragment);
            transaction.show(fragment);
        }

        transaction.setPrimaryNavigationFragment(fragment);
        transaction.setReorderingAllowed(true);
        transaction.commitNow();
        return initialNavigate ? destination : null;
    }
}
</code></pre>
<p>æ³¨æ„ï¼Œä½¿ç”¨è‡ªå®šä¹‰ Navigator çš„æ—¶å€™ navigation graph éœ€è¦æŠŠ fragment èŠ‚ç‚¹åç§°æ”¹ä¸º keep_state_fragmentï¼Œå¹¶ä¸”åœ¨æ‰¿è½½çš„ Activity ä¸­è¿›è¡Œè®¾ç½®å¹¶ä¸”è¿˜éœ€è¦æŠŠ Activity å¸ƒå±€æ–‡ä»¶ä¸­ fragment çš„ navGraph å±æ€§ç§»é™¤ã€‚</p>
<pre><code class="language-java">NavController navController = Navigation.findNavController(this, R.id.fragment3);
NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragment3);
KeepStateNavigator navigator = new KeepStateNavigator(this, navHostFragment.getChildFragmentManager(), R.id.fragment3);
navController.getNavigatorProvider().addNavigator(navigator);
navController.setGraph(R.navigation.tab_navigation);
</code></pre>
<p>æœ€åæ¥çœ‹ä¸€ä¸‹ä½¿ç”¨è‡ªå®šä¹‰ Navigator æ—¶çš„ TabActivityã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_nav_tab_state.gif" alt=""></p>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://jiangjiwei.site/">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­å…¨éƒ¨æºä»£ç å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œä»£ç åˆ†æ”¯ä¸º masterã€‚å–œæ¬¢æœ¬æ–‡çš„éº»çƒ¦ç‚¹ä¸ªğŸŒŸã€‚</p>
<p>æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@joaosilas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">JoÃ£o Silas</a> on <a href="https://unsplash.com/search/photos/translation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[çœ‹ä¸€çœ‹ DataBinding]]></title>
        <id>https://cherrylover.github.io/post/kan-yi-kan-databinding</id>
        <link href="https://cherrylover.github.io/post/kan-yi-kan-databinding">
        </link>
        <updated>2019-07-23T05:08:48.000Z</updated>
        <summary type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹ä¸€äº›äººå†™çš„ä»£ç ï¼Œå‘ç°å¾ˆå¤šéƒ½æœ‰ç”¨åˆ° DataBindingï¼Œæ¯æ¯çœ‹åˆ° DataBinding ç›¸å…³çš„ä»£ç çœ‹ä¸æ‡‚ï¼Œæ‘¸ä¸é€ï¼Œå®åœ¨æ˜¯éš¾å—å•Šï¼Œå¯æ˜¯æ€ä¹ˆåŠå‘¢ï¼Œè°è®©è‡ªå·±ä¸ä¼šçš„å‘¢ã€‚æ²¡åŠæ³•å¼€å§‹å­¦å§ï¼Œä¸è¦æ±‚ä¼šå¤ªå¤šï¼Œæ€»å¾—èƒ½çœ‹çš„æ‡‚äººå®¶å†™çš„æ˜¯å•¥æ„æ€å§ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨çœ‹ä¸€äº›äººå†™çš„ä»£ç ï¼Œå‘ç°å¾ˆå¤šéƒ½æœ‰ç”¨åˆ° DataBindingï¼Œæ¯æ¯çœ‹åˆ° DataBinding ç›¸å…³çš„ä»£ç çœ‹ä¸æ‡‚ï¼Œæ‘¸ä¸é€ï¼Œå®åœ¨æ˜¯éš¾å—å•Šï¼Œå¯æ˜¯æ€ä¹ˆåŠå‘¢ï¼Œè°è®©è‡ªå·±ä¸ä¼šçš„å‘¢ã€‚æ²¡åŠæ³•å¼€å§‹å­¦å§ï¼Œä¸è¦æ±‚ä¼šå¤ªå¤šï¼Œæ€»å¾—èƒ½çœ‹çš„æ‡‚äººå®¶å†™çš„æ˜¯å•¥æ„æ€å§ã€‚</p>
<!-- more -->
<blockquote>
<p>æœ¬ç¯‡éš¾åº¦å±äº DataBinding å…¥é—¨çº§åˆ«ï¼Œå¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯ï¼Œè¿˜è¯·æŒ‡æ­£ã€‚è¦å­¦ä¹  DataBinding æœ€å¥½çš„æ•™æè¿˜æ˜¯é€šè¿‡å®˜æ–¹ç»™çš„<a href="https://codelabs.developers.google.com/codelabs/android-databinding/#0">å®ä¾‹æ•™ç¨‹</a>ã€‚</p>
</blockquote>
<p>æ­£å¼å¼€å§‹ä¹‹å‰å‘¢ï¼Œæ€»æ˜¯å¾—æ·»åŠ ä¾èµ–ï¼Œä¸è¿‡ï¼ŒDataBinding çš„ä¾èµ–å¯ä¸åƒ RxJava æˆ–æ˜¯å…¶ä»–åº“é€šè¿‡å¼•å…¥ä¸¤è¡Œä¾èµ–ï¼Œè€Œæ˜¯é€šè¿‡åœ¨ app.gradle æ–‡ä»¶ä¸­å¼•å…¥ä¸‹é¢çš„é…ç½®ï¼š</p>
<pre><code class="language-groovy">android {
    ...
    dataBinding {
        enabled = true
    }
}
</code></pre>
<p>æœ‰äº†ä¾èµ–ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹äº†ï¼Œç°åœ¨æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸€æ®µæ–‡å­—æ˜¾ç¤ºåœ¨ TextView ä¸Šã€‚ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ findViewByIdï¼Œç„¶å setTextï¼Œç°å¦‚ä»Šæ¥ä¸€èµ·çœ‹çœ‹ DataBinding æ˜¯æ€ä¹ˆåšçš„å§ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¸ƒå±€æ–‡ä»¶çš„ç»“æ„è¿›è¡Œæ”¹é€ ä¸€ä¸‹ï¼Œæ”¹é€ æˆè¿™æ ·çš„ç»“æ„ã€‚</p>
<pre><code class="language-xml">&lt;layout&gt;
    &lt;data&gt;
    &lt;/data&gt;
    &lt;ViewGroup&gt;
    &lt;/ViewGroup&gt;
&lt;/layout&gt;
</code></pre>
<blockquote>
<p>Android Studio å¯¹ DataBinding æœ‰è‡ªåŠ¨æ›¿æ¢çš„æ”¯æŒã€‚</p>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/image-20190718101219778.png" alt="image-20190718101219778"></p>
<p>æ›¿æ¢ä¹‹åçš„ ViewGroup å°±æ˜¯ä¹‹å‰çš„æ ¹å¸ƒå±€ï¼Œdata èŠ‚ç‚¹å†…ç”¨äºå®šä¹‰æ•°æ®ã€‚</p>
<pre><code class="language-xml">&lt;data&gt;
    &lt;variable name=&quot;content&quot; type=&quot;String&quot; /&gt;
&lt;/data&gt;
</code></pre>
<p>ä»¥æ­¤å½¢å¼å®šä¹‰çš„å˜é‡ content ç­‰ä»·äº <code>String content</code>ã€‚æ‹¿åˆ°äº† content è¿™ä¸ªå˜é‡ï¼Œç´§æ¥ç€å°±éœ€è¦è®¾ç½®åˆ° TextView ä¸Šã€‚è®¾ç½® Textï¼Œä½¿ç”¨çš„å±æ€§æ˜¯ <code>android:text=&quot;&quot;</code> è‡³äºå¡«å…¥çš„å€¼ï¼Œå°±æ˜¯ contentï¼Œä¸è¿‡è¯­æ³•ä¸Šç¨æœ‰ä¸åŒï¼Œ<code>android:text=&quot;@{content}&quot;</code> å…¶ä¸­ <code>@</code> ä»¥åŠ<code>{}</code>æ˜¯ç”¨äºåŒ…è£¹å…¶ä¸­çš„å€¼ï¼Œä»¥æ­¤æ¥åŒºåˆ†å¼€ <code>android:text=&quot;content&quot;</code>ã€‚</p>
<blockquote>
<p>Databinding ä½¿ç”¨è¿™ç§è¯­æ³•æ¥è®¾ç½®å†…å®¹ï¼Œäº‹å®ä¸Šè¿™ç§è¡¨è¾¾æ–¹æ³•ä¸ä»…ä»…ç”¨äºè®¾ç½®ä¸ªå­—ç¬¦ä¸²ï¼Œè¿˜æ”¯æŒè¡¨è¾¾å¼ï¼Œæ›´å¤šå†…å®¹è¯·å‚<a href="https://developer.android.com/topic/libraries/data-binding/expressions">è€ƒå®˜æ–¹æ–‡æ¡£</a>ã€‚æœ¬æ–‡ä¹Ÿä¼šä»‹ç»ä¸€äº›ã€‚</p>
</blockquote>
<p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ›´å¤šæ—¶å€™ä¼šæŠŠ content ä½œä¸ºä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡ã€‚åªè¦å°† variable çš„ type å±æ€§æ”¹æˆå¯¹åº”çš„ç±»åï¼ŒåŒæ—¶åœ¨ TextView ä¸Šæ”¹ä¸º <code>android:text=&quot;@{detail.content}&quot;</code> å³å¯ã€‚</p>
<pre><code class="language-xml">&lt;data&gt;
    &lt;variable name=&quot;detail&quot; type=&quot;me.monster.blogtest.model.MomentDetail&quot; /&gt;
&lt;/data&gt;
</code></pre>
<p>åœ¨å¸ƒå±€æ–‡ä»¶ä¸­å®šä¹‰å¥½äº†å˜é‡ï¼Œç°åœ¨æˆ‘ä»¬è¯¥å›åˆ° Java æ–‡ä»¶ä¸­å°†å¸ƒå±€æ–‡ä»¶ä½¿ç”¨ DataBinding è¿›è¡Œç»‘å®šä¸Šæ•°æ®äº†ã€‚</p>
<pre><code class="language-java">public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
                             @Nullable Bundle savedInstanceState) {
        FragmentDetailBinding viewDataBinding = DataBindingUtil.inflate(inflater, R.layout.fragment_detail, container, false);
        View root = viewDataBinding.getRoot();
        mMomentDetail = new MomentDetail();
  			mMomentDetail.setContent(&quot;ä½¿ç”¨ DataBinding&quot;);
        viewDataBinding.setDetail(mMomentDetail);
        return root;
    }
</code></pre>
<blockquote>
<ol>
<li>è¿™æ®µä»£ç æ˜¯ä½¿ç”¨åœ¨ Fragment ä¸­çš„ï¼Œå¦‚æœåœ¨ Activity ä¸­ï¼Œåˆ™ä½¿ç”¨ <code>DataBinding.Util.setContentView(Activity activity, int layoutId)</code> è¿™ä¸ªæ–¹æ³•ã€‚</li>
<li>FragmentDetailBinding è¿™ä¸ªç±»æ˜¯æ ¹æ®å¸ƒå±€æ–‡ä»¶ç”Ÿæˆçš„ï¼Œç±»åçš„è§„åˆ™æ˜¯å¸ƒå±€æ–‡ä»¶çš„æ–‡ä»¶å+Bindingï¼›</li>
</ol>
</blockquote>
<p>DataBinding è¿™æ ·ä½¿ç”¨ï¼Œå¥½åƒä¸å¤ªå¤Ÿæ—¥å¸¸ä½¿ç”¨ã€‚å½“ mMomentDetail å†…éƒ¨çš„ content å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒTextView èƒ½è‡ªåŠ¨æ›´æ–°å—ï¼Ÿæš‚æ—¶ä¸è¡Œï¼Œæƒ³è®© TextView è‡ªåŠ¨æ›´æ–° mMomentDetail çš„ content çš„å†…å®¹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¦å¤–çš„ä¸€äº›ä¸œè¥¿ã€‚</p>
<p>è¦æƒ³åŠæ—¶æ›´æ–° mMomentDetail çš„ content å†…å®¹ï¼ŒæŒ‰ç…§ä»¥å¾€çš„åšæ³•ï¼Œå°±æ˜¯åœ¨æ›´æ–° mMomentDetail çš„ content å†…å®¹æ—¶ï¼Œæ‰‹åŠ¨è°ƒç”¨ <code>setText()</code> è¿™ä¸ªæ–¹æ³•ã€‚ç°åœ¨æœ‰äº† DataBinding å°±ä¸ç”¨äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ mMomentDetail çš„ content å®šä¹‰ä¸ºä¸€ç§å¯è§‚å¯Ÿå…¶å˜åŒ–çš„ç±»å‹ï¼Œç„¶åé€šè¿‡ DataBinding å°±èƒ½è‡ªåŠ¨å®Œæˆå¯¹ TextView ä¸Šå†…å®¹çš„æ›´æ–°ã€‚</p>
<pre><code class="language-java">public class MomentDetail {    
    private String content;

    public String getContent() {
        return content == null ? &quot;&quot; : content;
    }

    public void setContent(String content) {
        this.content = content;
    }
}
</code></pre>
<p>è¿™ä¸ªæ˜¯ TextView ä¸èƒ½è‡ªåŠ¨æ›´æ–°å†…å®¹çš„ MomentDetail ç±»ï¼Œè¦æƒ³è®© TextView è‡ªåŠ¨æ›´æ–°ï¼Œåªéœ€è¦æŠŠ content çš„ç±»å‹æ”¹å˜å³å¯ã€‚æ”¹ä¸º <code>ObservableField&lt;String&gt; content</code>ã€‚</p>
<pre><code class="language-java">private ObservableField&lt;String&gt; content = new ObservableField&lt;&gt;();

public ObservableField&lt;String&gt; getContent() {
    return content;
}

public String getContentValue() {
    return content.get();
}

public void setContent(String content) {
    this.content.set(content);
}
</code></pre>
<p>ä¸æ™®é€šçš„ String ç±»å‹ä¸åŒçš„æ˜¯ï¼Œæƒ³è¦æ”¹å˜ content çš„å€¼ï¼Œéœ€è¦è°ƒç”¨ <code>ObservableField.set(T t)</code> æ–¹æ³•ï¼Œè·å–å…¶ä¸­çš„å€¼åˆ™ä½¿ç”¨ <code>ObservableField.get()</code> æ–¹æ³•ã€‚</p>
<p>DataBinding è¿˜åŒ…å«äº†ä¸€äº›å…¶ä»–çš„ç±»ï¼Œéƒ½æ˜¯ä¸€æ ·çš„ç”¨æ³•ã€‚</p>
<ul>
<li>ObservableBoolean</li>
<li>ObservableByte</li>
<li>ObservableChar</li>
<li>ObservableShort</li>
<li>ObservableInt</li>
<li>ObservableLong</li>
<li>ObservableFloat</li>
<li>ObservableDouble</li>
<li>ObservableParcelable</li>
</ul>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/blog_databinding_observable.gif" alt=""></p>
<blockquote>
<p>æˆ‘åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œä½¿ç”¨ Handler å»¶è¿Ÿå‡ ç§’é’Ÿå¯¹ MomentDetail è¿›è¡Œä¿®æ”¹ï¼Œç”¨äºæ¨¡æ‹Ÿç‚¹å‡»äº‹ä»¶ã€‚</p>
</blockquote>
<p>å½“æˆ‘ä»¬ç”¨äºè§‚å¯Ÿçš„æ•°æ®è¾ƒå¤šçš„æ—¶å€™ï¼Œè¿˜å¯ä»¥é€šè¿‡å°†è‡ªå®šä¹‰çš„æ•°æ®ç±»ç»§æ‰¿ BaseObservable ï¼Œäº§ç”Ÿç»§æ‰¿å…³ç³»ä¹‹åï¼Œæ•°æ®ç±»ä¸­çš„æˆå‘˜å˜é‡å‡å¯ä»¥åœ¨å‘ç”Ÿæ”¹å˜æ—¶è‡ªåŠ¨åº”ç”¨åˆ° View ä¸Šã€‚</p>
<pre><code class="language-java">public class MomentDetail extends BaseObservable {
    private String moment;
    private int goodCount;

    @Bindable
    public String getMoment() {
        return moment == null ? &quot;&quot; : moment;
    }

    @Bindable
    public int getGoodCount() {
        return goodCount;
    }

    public void setContent(String msg) {
        this.moment = msg;
        notifyPropertyChanged(BR.moment);
    }

    public void updateGood(int count) {
        goodCount = count;
        notifyPropertyChanged(BR.goodCount);
    }
}
</code></pre>
<p>è·Ÿå…¶ä»–çš„æ•°æ®ç±»æ²¡æœ‰ä»€ä¹ˆå¤ªå¤§çš„å·®è·ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªæ³¨è§£ <code>@Bindable</code> ä»¥åŠåœ¨æˆå‘˜å˜é‡è¿›è¡Œæ›´æ”¹åè¿›è¡Œæ›´æ–° <code>notifyPropertyChanged()</code>ã€‚ä¸è¿‡ï¼ŒGoogle è¿˜æ˜¯æ¨èä½¿ç”¨ LiveData é…åˆä½¿ç”¨ã€‚</p>
<pre><code class="language-java">public class MomentViewModel extends ViewModel {

    private MutableLiveData&lt;String&gt; name = new MutableLiveData&lt;&gt;(&quot;Abs&quot;);
    private MutableLiveData&lt;Integer&gt; good = new MutableLiveData&lt;&gt;();

    public void setNameValue(String value) {
        name.setValue(value);
    }

    public MutableLiveData&lt;String&gt; getName() {
        return name;
    }

    public MutableLiveData&lt;Integer&gt; getGood() {
        return good;
    }

    public void setGoodValue(int goodValue) {
        good.setValue(goodValue);
    }
}
</code></pre>
<p>ç›¸åº”çš„ï¼Œå¸ƒå±€æ–‡ä»¶ä¸­ä¹Ÿè¦è¿›è¡Œæ›´æ”¹æ•°æ®ç±»å‹ã€‚</p>
<pre><code class="language-xml">&lt;variable
    name=&quot;viewModel&quot;
    type=&quot;me.monster.blogtest.model.MomentViewModel&quot; /&gt;
</code></pre>
<p>DataBinding è®¾ç½® View çš„ <code>text</code>ï¼Œ<code>textColor</code> ç­‰å±æ€§éƒ½å¯ä»¥ç›´æ¥é€šè¿‡ç±»ä¼¼ <code>android:text=&quot;@{viewModel.name}&quot;</code> è¿™ç§å½¢å¼æ¥è¿›è¡Œæ“ä½œï¼Œé‚£å¦‚æœæƒ³å¯¹æ§ä»¶è¿›è¡Œç‚¹å‡»äº‹ä»¶çš„ç›‘å¬æ€ä¹ˆåŠå‘¢ï¼Ÿä¹Ÿä¸éº»çƒ¦ï¼Œæˆ‘ä»¬åªéœ€è¦æä¾›ä¸€ä¸ªç”¨äºå¤„ç†ç‚¹å‡»ç»“æœçš„æ–¹æ³•å³å¯ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª TextView ç”¨äºè¿›è¡Œç‚¹å‡»ï¼Œå¹¶å°†ç‚¹å‡»æ¬¡æ•°æ˜¾ç¤ºåœ¨å½“å‰ TextView ä¸Šã€‚</p>
<pre><code class="language-java">public void upGood() {
    good.setValue(good.getValue() == null ? 1 : good.getValue() + 1);
}
</code></pre>
<pre><code class="language-xml">&lt;TextView
    android:id=&quot;@+id/iv_good&quot;
    android:layout_width=&quot;wrap_content&quot;
    android:layout_height=&quot;40dp&quot;
    android:drawableStart=&quot;@drawable/ic_good&quot;
    android:drawablePadding=&quot;8dp&quot;
    android:gravity=&quot;center&quot;
    android:onClick=&quot;@{() -&gt; viewModel.upGood()}&quot;
    android:text=&quot;@{String.valueOf(viewModel.good)}&quot; /&gt;
</code></pre>
<p>ä¸è¿‡ï¼ŒDataBinding è™½ç„¶æŒºå¥½çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰äº›ä¸è¶³ï¼Œæ¯”å¦‚é€šè¿‡ Glide è¿™ç§ç¬¬ä¸‰æ–¹æ¡†æ¶åŠ è½½å›¾ç‰‡ï¼Œè¿˜æ˜¯å¾— <code>findViewById</code>ï¼Œäº‹å®ä¸Šï¼ŒDataBinding æä¾›äº†å¦ä¸€ç§è§£å†³æ€è·¯ï¼Œé€šè¿‡å°†ä¸€ä¸ªé™æ€æ–¹æ³•åŠ ä¸Šæ³¨è§£ï¼Œç„¶åå°±å¯ä»¥åœ¨ View ä¸­è¿›è¡Œä½¿ç”¨ã€‚</p>
<pre><code class="language-java">@BindingAdapter({&quot;imageRes&quot;})
public static void loadImage(ImageView imageView, int resId) {
    Glide.with(imageView)
            .load(resId)
            .into(imageView);
}
</code></pre>
<pre><code class="language-xml">&lt;ImageView
    android:id=&quot;@+id/iv_avatar&quot;
    imageRes=&quot;@{viewModel.avatar}&quot;
    android:layout_width=&quot;50dp&quot;
    android:layout_height=&quot;50dp&quot;
    android:src=&quot;@mipmap/avatar_1&quot; /&gt;
</code></pre>
<blockquote>
<p>BindAdapter è¿˜æœ‰æ›´å¤šå…¶ä»–ç”¨æ³•ï¼Œè¯·<a href="https://developer.android.com/topic/libraries/data-binding/binding-adapters">å‚è€ƒå®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
</blockquote>
<p>æ•´ä½“æ¥è¯´ï¼ŒDataBinding ä¸éš¾ï¼Œè€Œä¸”å…¥é—¨ä¹ŸæŒºç®€å•çš„ï¼Œä¸è¿‡ï¼Œåˆšä¸Šæ‰‹ï¼Œå¾ˆå¤šæ—¶å€™æ‘¸ä¸åˆ°å¤´è„‘ã€‚ä¸è¿‡ï¼Œå®ƒçš„å¥½å¤„ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨ Fragment æˆ–æ˜¯ Activity ä¸­æ²¡æœ‰ä½¿ç”¨ä»»ä½•ç›´æ¥æˆ–æ˜¯é—´æ¥çš„ <code>findViewById</code> æ“ä½œã€‚ä¿è¯äº† Activity ä¸ Fragment çš„ç®€æ´ï¼Œä½¿å…¶èƒ½æ›´å¥½çš„ä¸“æ³¨äºé¡µé¢çš„è·³è½¬åŠæ•°æ®çš„å¤„ç†ï¼Œå€˜è‹¥é…åˆç€ Jetpack çš„å…¶ä»–ç»„ä»¶ååŒå¼€å‘ï¼Œä¼°è®¡ä¼šæ›´é«˜æ•ˆäº›ã€‚</p>
<p>æœ¬æ–‡æ—¨åœ¨å­¦ä¹ å¦‚ä½•ç®€å•çš„ä½¿ç”¨ DataBindingï¼Œä¸»ä½“å†…å®¹è¾ƒä¸ºç®€å•ï¼Œå®é™…ä¸Šï¼Œæ—¥å¸¸å¼€å‘ä¸­è¿˜ä¼šç»å¸¸ç”¨åˆ° RecyclerView åŠå…¶ä»–åŠŸèƒ½ï¼ŒDataBinding ä¹Ÿèƒ½æä¾›å¾ˆå¥½çš„æ”¯æŒï¼Œæœ‰å…´è¶£æˆ–æ˜¯éœ€è¦çš„è¯å¯ä»¥è‡ªè¡ŒæŸ¥é˜…<a href="https://developer.android.com/topic/libraries/data-binding">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<p>æ–‡ç« é¦–å‘äº<a href="https://jiangjiwei.site">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­æ‰€æœ‰ä»£ç å‡å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œä»£ç åˆ†æ”¯ä¸ºï¼šdataBindingã€‚</p>
<p>ç›¸å…³æ–‡ç« æ¨èï¼š</p>
<ul>
<li><a href="https://jiangjiwei.site/post/yong-motionlayout-lai-zuo-guo-du-dong-hua/">ç”¨ MotionLayout æ¥åšè¿‡æ¸¡åŠ¨ç”»</a></li>
<li><a href="https://jiangjiwei.site/post/lai-xue-yi-bo-navigation/">æ¥å­¦ä¸€æ³¢ Navigation</a></li>
</ul>
<p>æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@paul__schafer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Paul Schafer</a> on <a href="https://unsplash.com/search/photos/learn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a>ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Android æ··æ·†]]></title>
        <id>https://cherrylover.github.io/post/android-hun-yao</id>
        <link href="https://cherrylover.github.io/post/android-hun-yao">
        </link>
        <updated>2019-07-15T15:40:39.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æœ¬ç¯‡æ–‡ç« çš„ä¸»è¦å†…å®¹æ˜¯æœ¬äººåœ¨å­¦ä¹  Android æ··æ·†æ—¶è§‰å¾—ä¸é”™çš„æ–‡ç« ã€‚ç‰¹åœ°æ”¶è—è¿‡æ¥ï¼ŒåŸæ–‡é“¾æ¥ï¼šhttps://www.diycode.cc/topics/380ã€‚</p>
</blockquote>
<p>ä¸€ç›´ä»¥æ¥çŸ¥é“ Android æ··æ·†ï¼Œä½†æ˜¯éƒ½æ²¡ä¸Šæ‰‹ç”¨è¿‡ï¼Œå¤§æ¦‚ï¼Œå¥½åƒçŸ¥é“ç‚¹ä¸œè¥¿ï¼Œä½†åˆæä¸æ¸…ï¼Œå¹²è„†æ¥å¥½å¥½å­¦ä¸€ä¸‹ã€‚</p>
<p>æˆ‘ä»¬è¯´æ··æ·†ä¸€èˆ¬éƒ½æ˜¯è¯´åœ¨ ProGuard æ–‡ä»¶ä¸­æˆ‘ä»¬å®šä¹‰çš„å†…å®¹ï¼Œé‚£å®šä¹‰åœ¨ ProGuard å†…å®¹æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæˆ‘é—®äº†ä¸€äº›äººï¼Œå¾—åˆ°äº†ä¸‹é¢å‡ ä¸ªç­”æ¡ˆï¼Œæ¥çœ‹çœ‹å§ã€‚</p>
<ol>
<li>èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶ä¿®æ”¹æºä»£ç ä½¿å…¶éš¾ä»¥è¢«é˜…è¯»è€Œä¸”èƒ½å¤Ÿåšä»£ç å‹ç¼©ï¼›</li>
<li>æ£€æµ‹å’Œç§»é™¤å°è£…åº”ç”¨ä¸­æœªä½¿ç”¨çš„ç±»ã€å­—æ®µã€æ–¹æ³•å’Œå±æ€§ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹ä»£ç åº“ä¸­çš„æœªä½¿ç”¨é¡¹ï¼ˆè¿™ä½¿å…¶æˆä¸ºä»¥å˜é€šæ–¹å¼è§£å†³ 64k å¼•ç”¨é™åˆ¶çš„æœ‰ç”¨å·¥å…·ï¼‰ï¼›</li>
<li>ä¼˜åŒ–å­—èŠ‚ç ï¼Œç§»é™¤æœªä½¿ç”¨çš„ä»£ç æŒ‡ä»¤ï¼›</li>
<li>ç”¨çŸ­åç§°æ··æ·†å…¶ä½™çš„ç±»ã€å­—æ®µå’Œæ–¹æ³•ï¼›</li>
<li>æ··æ·†è¿‡çš„ä»£ç å¯ä»¤ APK éš¾ä»¥è¢«é€†å‘å·¥ç¨‹ï¼›</li>
<li>APK èƒ½å¤Ÿè¢«å‹ç¼©ï¼Œè€Œä¸”å‹ç¼©çš„å¹…åº¦è¾ƒå¤§ï¼Œèƒ½å¸®åŠ©ä½ çš„åº”ç”¨æ›´å®¹æ˜“è¢«ç”¨æˆ·æ¥æ”¶ã€‚åŒæ—¶ï¼ŒAPK ä½“ç§¯ä¹Ÿä¼šå½±å“å®‰è£…å’Œå†·å¯åŠ¨é€Ÿåº¦ï¼Œè¶Šå¤§è¶Šæ…¢ã€‚</li>
</ol>
<p>çœ‹åˆ°è¿™ç‚¹å¤šä¼˜ç‚¹ï¼Œæˆ‘å®åœ¨æŒ‰æºä¸ä½äº†ï¼Œäºæ˜¯æˆ‘å¼€å§‹æ–°çš„å¾é€”ï¼Œä¸‹é¢æ­£æ–‡å¼€å§‹ã€‚</p>
<h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å…‰æºã€‚</p>
<p>æœ¬æ–‡é¦–å‘äºæˆ‘çš„ä¸ªäººå…¬ä¼—è´¦å·ï¼ŒåŒæ—¶ä¼šåœ¨ä¸ªäººåšå®¢ä¸ŠåŒæ­¥ã€‚å¦‚æœåšå®¢æœ¬èº«æœ‰ä¿®æ”¹æˆ–å‹˜è¯¯ï¼Œä¼šåœ¨åšå®¢æ›´æ–°ã€‚</p>
<h2 id="ç»¼è¿°">ç»¼è¿°</h2>
<p>æ¯«æ— ç–‘é—®ï¼Œæ··æ·†æ˜¯æ‰“åŒ…è¿‡ç¨‹ä¸­æœ€é‡è¦çš„æµç¨‹ä¹‹ä¸€ï¼Œåœ¨æ²¡æœ‰ç‰¹æ®ŠåŸå› çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ app éƒ½åº”è¯¥å¼€å¯æ··æ·†ã€‚</p>
<p>é¦–å…ˆï¼Œè¿™é‡Œè¯´çš„çš„æ··æ·†å…¶å®æ˜¯åŒ…æ‹¬äº†ä»£ç å‹ç¼©ã€ä»£ç æ··æ·†ä»¥åŠèµ„æºå‹ç¼©ç­‰çš„ä¼˜åŒ–è¿‡ç¨‹ã€‚ä¾é  ProGuardï¼Œæ··æ·†æµç¨‹å°†ä¸»é¡¹ç›®ä»¥åŠä¾èµ–åº“ä¸­æœªè¢«ä½¿ç”¨çš„ç±»ã€ç±»æˆå‘˜ã€æ–¹æ³•ã€å±æ€§ç§»é™¤ï¼Œè¿™æœ‰åŠ©äºè§„é¿64Kæ–¹æ³•æ•°çš„ç“¶é¢ˆï¼›åŒæ—¶ï¼Œå°†ç±»ã€ç±»æˆå‘˜ã€æ–¹æ³•é‡å‘½åä¸ºæ— æ„ä¹‰çš„ç®€çŸ­åç§°ï¼Œå¢åŠ äº†é€†å‘å·¥ç¨‹çš„éš¾åº¦ã€‚è€Œä¾é  Gradle çš„ Android æ’ä»¶ï¼Œæˆ‘ä»¬å°†ç§»é™¤æœªè¢«ä½¿ç”¨çš„èµ„æºï¼Œå¯ä»¥æœ‰æ•ˆå‡å° apk å®‰è£…åŒ…å¤§å°ã€‚</p>
<p>æœ¬æ–‡ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†ç»™å‡ºæ··æ·†çš„æœ€ä½³å®è·µï¼ŒåŠ›æ±‚è®©é›¶åŸºç¡€çš„æ–°æ‰‹éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨æ··æ·†ï¼›ç¬¬äºŒéƒ¨åˆ†ä¼šä»‹ç»ä¸€ä¸‹æ··æ·†çš„æ•´ä½“ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™çš„è¯­æ³•ä¸å®è·µã€è‡ªå®šä¹‰èµ„æºä¿æŒçš„è§„åˆ™ç­‰ã€‚</p>
<h2 id="ä¸€-androidæ··æ·†æœ€ä½³å®è·µ">ä¸€ã€Androidæ··æ·†æœ€ä½³å®è·µ</h2>
<h3 id="1-æ··æ·†é…ç½®">1. æ··æ·†é…ç½®</h3>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œapp module çš„ <code>build.gradle</code> æ–‡ä»¶é»˜è®¤ä¼šæœ‰å¦‚ä¸‹ç»“æ„ï¼š</p>
<pre><code>android {
    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}
</code></pre>
<p>å› ä¸ºå¼€å¯æ··æ·†ä¼šä½¿ç¼–è¯‘æ—¶é—´å˜é•¿ï¼Œæ‰€ä»¥<code>debug</code>æ¨¡å¼ä¸‹ä¸åº”è¯¥å¼€å¯ã€‚æˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼š</p>
<ol>
<li>å°†<code>release</code>ä¸‹<code>minifyEnabled</code>çš„å€¼æ”¹ä¸º<code>true</code>ï¼Œæ‰“å¼€æ··æ·†ï¼›</li>
<li>åŠ ä¸Š<code>shrinkResources true</code>ï¼Œæ‰“å¼€èµ„æºå‹ç¼©ã€‚</li>
</ol>
<p>ä¿®æ”¹åæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code>android {
    buildTypes {
        release {
            minifyEnabled true
            shrinkResources true
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}
</code></pre>
<h3 id="2-è‡ªå®šä¹‰æ··æ·†è§„åˆ™">2. è‡ªå®šä¹‰æ··æ·†è§„åˆ™</h3>
<p>åœ¨ <code>app module</code> ä¸‹é»˜è®¤ç”Ÿæˆäº†é¡¹ç›®çš„è‡ªå®šä¹‰æ··æ·†è§„åˆ™æ–‡ä»¶ <code>proguard-rules.pro</code>ï¼Œå¤šæ–¹è°ƒç ”åï¼Œä¸€ä»½é€‚ç”¨äºå¤§éƒ¨åˆ†é¡¹ç›®çš„æ··æ·†è§„åˆ™æœ€ä½³å®è·µå¦‚ä¸‹ï¼š</p>
<pre><code>#æŒ‡å®šå‹ç¼©çº§åˆ«
-optimizationpasses 5

#ä¸è·³è¿‡éå…¬å…±çš„åº“çš„ç±»æˆå‘˜
-dontskipnonpubliclibraryclassmembers

#æ··æ·†æ—¶é‡‡ç”¨çš„ç®—æ³•
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

#æŠŠæ··æ·†ç±»ä¸­çš„æ–¹æ³•åä¹Ÿæ··æ·†äº†
-useuniqueclassmembernames

#ä¼˜åŒ–æ—¶å…è®¸è®¿é—®å¹¶ä¿®æ”¹æœ‰ä¿®é¥°ç¬¦çš„ç±»å’Œç±»çš„æˆå‘˜ 
-allowaccessmodification

#å°†æ–‡ä»¶æ¥æºé‡å‘½åä¸ºâ€œSourceFileâ€å­—ç¬¦ä¸²
-renamesourcefileattribute SourceFile
#ä¿ç•™è¡Œå·
-keepattributes SourceFile,LineNumberTable

#ä¿æŒæ‰€æœ‰å®ç° Serializable æ¥å£çš„ç±»æˆå‘˜
-keepclassmembers class * implements java.io.Serializable {
    static final long serialVersionUID;
    private static final java.io.ObjectStreamField[] serialPersistentFields;
    private void writeObject(java.io.ObjectOutputStream);
    private void readObject(java.io.ObjectInputStream);
    java.lang.Object writeReplace();
    java.lang.Object readResolve();
}

#Fragmentä¸éœ€è¦åœ¨AndroidManifest.xmlä¸­æ³¨å†Œï¼Œéœ€è¦é¢å¤–ä¿æŠ¤ä¸‹
-keep public class * extends android.support.v4.app.Fragment
-keep public class * extends android.app.Fragment

# ä¿æŒæµ‹è¯•ç›¸å…³çš„ä»£ç 
-dontnote junit.framework.**
-dontnote junit.runner.**
-dontwarn android.test.**
-dontwarn android.support.test.**
-dontwarn org.junit.**
</code></pre>
<p>çœŸæ­£é€šç”¨çš„ã€éœ€è¦æ·»åŠ çš„å°±æ˜¯ä¸Šé¢è¿™äº›ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œéœ€è¦æ¯ä¸ªé¡¹ç›®æ ¹æ®è‡ªèº«çš„éœ€æ±‚æ·»åŠ ä¸€äº›æ··æ·†è§„åˆ™ï¼š</p>
<ul>
<li>ç¬¬ä¸‰æ–¹åº“æ‰€éœ€çš„æ··æ·†è§„åˆ™ã€‚æ­£è§„çš„ç¬¬ä¸‰æ–¹åº“ä¸€èˆ¬éƒ½ä¼šåœ¨æ¥å…¥æ–‡æ¡£ä¸­å†™å¥½æ‰€éœ€æ··æ·†è§„åˆ™ï¼Œä½¿ç”¨æ—¶æ³¨æ„æ·»åŠ ã€‚</li>
<li>åœ¨è¿è¡Œæ—¶åŠ¨æ€æ”¹å˜çš„ä»£ç ï¼Œä¾‹å¦‚åå°„ã€‚æ¯”è¾ƒå…¸å‹çš„ä¾‹å­å°±æ˜¯ä¼šä¸ json ç›¸äº’è½¬æ¢çš„å®ä½“ç±»ã€‚å‡å¦‚é¡¹ç›®å‘½åè§„èŒƒè¦æ±‚å®ä½“ç±»éƒ½è¦æ”¾åœ¨modelåŒ…ä¸‹çš„è¯ï¼Œå¯ä»¥æ·»åŠ ç±»ä¼¼è¿™æ ·çš„ä»£ç æŠŠæ‰€æœ‰å®ä½“ç±»éƒ½ä¿æŒä½ï¼š-keep public class <strong>.<em>Model</em>.</strong> {*;}<br>
-Â JNIä¸­è°ƒç”¨çš„ç±»ã€‚<br>
-Â WebViewä¸­JavaScriptè°ƒç”¨çš„æ–¹æ³•<br>
-Â Layoutå¸ƒå±€ä½¿ç”¨çš„Viewæ„é€ å‡½æ•°ã€android:onClickç­‰ã€‚</li>
</ul>
<h3 id="3-æ£€æŸ¥æ··æ·†ç»“æœ">3. æ£€æŸ¥æ··æ·†ç»“æœ</h3>
<p>æ··æ·†è¿‡çš„åŒ…å¿…é¡»è¿›è¡Œæ£€æŸ¥ï¼Œé¿å…å› æ··æ·†å¼•å…¥çš„bugã€‚</p>
<p>ä¸€æ–¹é¢ï¼Œéœ€è¦ä»ä»£ç å±‚é¢æ£€æŸ¥ã€‚ä½¿ç”¨ä¸Šæ–‡çš„é…ç½®è¿›è¡Œæ··æ·†æ‰“åŒ…ååœ¨Â <module-name>/build/outputs/mapping/release/Â ç›®å½•ä¸‹ä¼šè¾“å‡ºä»¥ä¸‹æ–‡ä»¶ï¼š<br>
-Â dump.txtÂ <br>
æè¿°APKæ–‡ä»¶ä¸­æ‰€æœ‰ç±»çš„å†…éƒ¨ç»“æ„<br>
-Â mapping.txt<br>
æä¾›æ··æ·†å‰åç±»ã€æ–¹æ³•ã€ç±»æˆå‘˜ç­‰çš„å¯¹ç…§è¡¨<br>
-Â seeds.txt<br>
åˆ—å‡ºæ²¡æœ‰è¢«æ··æ·†çš„ç±»å’Œæˆå‘˜<br>
-Â usage.txt<br>
åˆ—å‡ºè¢«ç§»é™¤çš„ä»£ç </p>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ® <code>seeds.txt</code> æ–‡ä»¶æ£€æŸ¥æœªè¢«æ··æ·†çš„ç±»å’Œæˆå‘˜ä¸­æ˜¯å¦å·²åŒ…å«æ‰€æœ‰æœŸæœ›ä¿ç•™çš„ï¼Œå†æ ¹æ® <code>usage.txt</code> æ–‡ä»¶æŸ¥çœ‹æ˜¯å¦æœ‰è¢«è¯¯ç§»é™¤çš„ä»£ç ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼Œéœ€è¦ä»æµ‹è¯•æ–¹é¢æ£€æŸ¥ã€‚å°†æ··æ·†è¿‡çš„åŒ…è¿›è¡Œå…¨æ–¹é¢æµ‹è¯•ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ bug äº§ç”Ÿã€‚</p>
<h3 id="4-è§£å‡ºæ··æ·†æ ˆ">4. è§£å‡ºæ··æ·†æ ˆ</h3>
<p>æ··æ·†åçš„ç±»ã€æ–¹æ³•åç­‰ç­‰éš¾ä»¥é˜…è¯»ï¼Œè¿™å›ºç„¶ä¼šå¢åŠ é€†å‘å·¥ç¨‹çš„éš¾åº¦ï¼Œä½†å¯¹è¿½è¸ªçº¿ä¸Š crash ä¹Ÿé€ æˆäº†é˜»ç¢ã€‚æˆ‘ä»¬æ‹¿åˆ° crash çš„å †æ ˆä¿¡æ¯åä¼šå‘ç°å¾ˆéš¾å®šä½ï¼Œè¿™æ—¶éœ€è¦å°†æ··æ·†åè§£ã€‚</p>
<p>åœ¨ <code>&lt;sdk-root&gt;/tools/proguard/</code> è·¯å¾„ä¸‹æœ‰é™„å¸¦çš„çš„åè§£å·¥å…·ï¼ˆWindow ç³»ç»Ÿä¸º <code>proguardgui.bat</code>ï¼ŒMac æˆ– Linux ç³»ç»Ÿä¸º <code>proguardgui.sh</code>ï¼‰ã€‚</p>
<p>è¿™é‡Œä»¥ Window å¹³å°ä¸ºä¾‹ã€‚åŒå‡»è¿è¡Œ <code>proguardgui.bat</code> åï¼Œå¯ä»¥çœ‹åˆ°å·¦ä¾§çš„ä¸€è¡Œèœå•ã€‚ç‚¹å‡» <code>ReTrace</code>ï¼Œé€‰æ‹©è¯¥æ··æ·†åŒ…å¯¹åº”çš„ mapping æ–‡ä»¶ï¼ˆæ··æ·†ååœ¨ <code>&lt;module-name&gt;/build/outputs/mapping/release/</code> è·¯å¾„ä¸‹ä¼šç”Ÿæˆ <code>mapping.txt</code> æ–‡ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯æä¾›æ··æ·†å‰åç±»ã€æ–¹æ³•ã€ç±»æˆå‘˜ç­‰çš„å¯¹ç…§è¡¨ï¼‰ï¼Œå†å°† crash çš„ <code>stack trace</code> é»è´´è¿›è¾“å…¥æ¡†ä¸­ï¼Œç‚¹å‡»å³ä¸‹è§’çš„ <code>ReTrace</code> ï¼Œæ··æ·†åçš„å †æ ˆä¿¡æ¯å°±æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p>
<p>ä»¥ä¸Šä½¿ç”¨ GUI ç¨‹åºè¿›è¡Œæ“ä½œï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯åˆ©ç”¨è¯¥è·¯å¾„ä¸‹çš„ <code>retrace</code> å·¥å…·é€šè¿‡å‘½ä»¤è¡Œè¿›è¡Œåè§£ï¼Œå‘½ä»¤æ˜¯</p>
<pre><code class="language-shell">retrace.bat|retrace.sh [-verbose] mapping.txt [&lt;stacktrace_file&gt;]
</code></pre>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="language-shell">retrace.bat -verbose mapping.txt obfuscated_trace.txt
</code></pre>
<h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹ï¼š</h3>
<ol>
<li>
<p>æ‰€æœ‰åœ¨ <code>AndroidManifest.xml</code> æ¶‰åŠåˆ°çš„ç±»å·²ç»è‡ªåŠ¨è¢«ä¿æŒï¼Œå› æ­¤ä¸ç”¨ç‰¹æ„å»æ·»åŠ è¿™å—æ··æ·†è§„åˆ™ã€‚ï¼ˆå¾ˆå¤šè€çš„æ··æ·†æ–‡ä»¶é‡Œä¼šåŠ ï¼Œç°åœ¨å·²ç»æ²¡å¿…è¦ï¼‰</p>
</li>
<li>
<p><code>proguard-android.txt</code> å·²ç»å­˜åœ¨ä¸€äº›é»˜è®¤æ··æ·†è§„åˆ™ï¼Œæ²¡å¿…è¦åœ¨ <code>proguard-rules.pro</code> é‡å¤æ·»åŠ ï¼Œè¯¥æ–‡ä»¶å…·ä½“è§„åˆ™è§é™„å½•1ï¼š</p>
</li>
</ol>
<h2 id="äºŒ-æ··æ·†ç®€ä»‹">äºŒã€æ··æ·†ç®€ä»‹</h2>
<p>Androidä¸­çš„â€œæ··æ·†â€å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯ Java ä»£ç çš„ä¼˜åŒ–ä¸æ··æ·†ï¼Œä¾é  proguard æ··æ·†å™¨æ¥å®ç°ï¼›å¦ä¸€éƒ¨åˆ†æ˜¯èµ„æºå‹ç¼©ï¼Œå°†ç§»é™¤é¡¹ç›®åŠä¾èµ–çš„åº“ä¸­æœªè¢«ä½¿ç”¨çš„èµ„æº(èµ„æºå‹ç¼©ä¸¥æ ¼æ„ä¹‰ä¸Šè·Ÿæ··æ·†æ²¡å•¥å…³ç³»ï¼Œä½†ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šæ”¾ä¸€èµ·è®²)ã€‚</p>
<h3 id="1-ä»£ç å‹ç¼©">1. ä»£ç å‹ç¼©</h3>
<p><a href="http://zhenghuiy-blog.qiniudn.com/proguard-process.png"><img src="http://zhenghuiy-blog.qiniudn.com/proguard-process.png" alt="img"></a></p>
<p>ä»£ç æ··æ·†æ˜¯åŒ…å«äº†ä»£ç å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†ç­‰ä¸€ç³»åˆ—è¡Œä¸ºçš„è¿‡ç¨‹ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ··æ·†è¿‡ç¨‹ä¼šæœ‰å¦‚ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li>å‹ç¼©ã€‚ç§»é™¤æ— æ•ˆçš„ç±»ã€ç±»æˆå‘˜ã€æ–¹æ³•ã€å±æ€§ç­‰ï¼›</li>
<li>ä¼˜åŒ–ã€‚åˆ†æå’Œä¼˜åŒ–æ–¹æ³•çš„äºŒè¿›åˆ¶ä»£ç ï¼›æ ¹æ®proguard-android-optimize.txtä¸­çš„æè¿°ï¼Œä¼˜åŒ–å¯èƒ½ä¼šé€ æˆä¸€äº›æ½œåœ¨é£é™©ï¼Œä¸èƒ½ä¿è¯åœ¨æ‰€æœ‰ç‰ˆæœ¬çš„Dalvikä¸Šéƒ½æ­£å¸¸è¿è¡Œã€‚</li>
<li>æ··æ·†ã€‚æŠŠç±»åã€å±æ€§åã€æ–¹æ³•åæ›¿æ¢ä¸ºç®€çŸ­ä¸”æ— æ„ä¹‰çš„åç§°ï¼›</li>
<li>é¢„æ ¡éªŒã€‚æ·»åŠ é¢„æ ¡éªŒä¿¡æ¯ã€‚è¿™ä¸ªé¢„æ ¡éªŒæ˜¯ä½œç”¨åœ¨Javaå¹³å°ä¸Šçš„ï¼ŒAndroidå¹³å°ä¸Šä¸éœ€è¦è¿™é¡¹åŠŸèƒ½ï¼Œå»æ‰ä¹‹åè¿˜å¯ä»¥åŠ å¿«æ··æ·†é€Ÿåº¦ã€‚</li>
</ol>
<p>è¿™å››ä¸ªæµç¨‹é»˜è®¤å¼€å¯ã€‚</p>
<p>åœ¨ Android é¡¹ç›®ä¸­æˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†â€œä¼˜åŒ–â€å’Œâ€œé¢„æ ¡éªŒâ€å…³é—­ï¼Œå¯¹åº”å‘½ä»¤æ˜¯<code>-dontoptimize</code>ã€<code>-dontpreverify</code>ï¼ˆå½“ç„¶ï¼Œé»˜è®¤çš„ <code>proguard-android.txt</code> æ–‡ä»¶å·²åŒ…å«è¿™ä¸¤æ¡æ··æ·†å‘½ä»¤ï¼Œä¸éœ€è¦å¼€å‘è€…é¢å¤–é…ç½®ï¼‰ã€‚</p>
<h3 id="2-èµ„æºå‹ç¼©">2. èµ„æºå‹ç¼©</h3>
<p>èµ„æºå‹ç¼©å°†ç§»é™¤é¡¹ç›®åŠä¾èµ–çš„åº“ä¸­æœªè¢«ä½¿ç”¨çš„èµ„æºï¼Œè¿™åœ¨å‡å°‘ apk åŒ…ä½“ç§¯ä¸Šä¼šæœ‰ä¸é”™çš„æ•ˆæœï¼Œä¸€èˆ¬å»ºè®®å¼€å¯ã€‚å…·ä½“åšæ³•æ˜¯åœ¨ <code>build.grade</code> æ–‡ä»¶ä¸­ï¼Œå°† <code>shrinkResources</code> å±æ€§è®¾ç½®ä¸º <code>true</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>åªæœ‰åœ¨ç”¨minifyEnabled trueå¼€å¯äº†ä»£ç å‹ç¼©åï¼Œèµ„æºå‹ç¼©æ‰ä¼šç”Ÿæ•ˆ</strong>ã€‚</p>
<p>èµ„æºå‹ç¼©åŒ…å«äº†â€œåˆå¹¶èµ„æºâ€å’Œâ€œç§»é™¤èµ„æºâ€ä¸¤ä¸ªæµç¨‹ã€‚</p>
<p>â€œåˆå¹¶èµ„æºâ€æµç¨‹ä¸­ï¼Œåç§°ç›¸åŒçš„èµ„æºè¢«è§†ä¸ºé‡å¤èµ„æºä¼šè¢«åˆå¹¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸€æµç¨‹ä¸å—shrinkResourceså±æ€§æ§åˆ¶ï¼Œä¹Ÿæ— æ³•è¢«ç¦æ­¢ï¼ŒÂ gradle å¿…ç„¶ä¼šåšè¿™é¡¹å·¥ä½œï¼Œå› ä¸ºå‡å¦‚ä¸åŒé¡¹ç›®ä¸­å­˜åœ¨ç›¸åŒåç§°çš„èµ„æºå°†å¯¼è‡´é”™è¯¯ã€‚gradle åœ¨å››å¤„åœ°æ–¹å¯»æ‰¾é‡å¤èµ„æºï¼š<br>
-Â src/main/res/Â è·¯å¾„</p>
<ul>
<li>ä¸åŒçš„æ„å»ºç±»å‹ï¼ˆdebugã€releaseç­‰ç­‰ï¼‰</li>
<li>ä¸åŒçš„æ„å»ºæ¸ é“</li>
<li>é¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“</li>
</ul>
<p>åˆå¹¶èµ„æºæ—¶æŒ‰ç…§å¦‚ä¸‹ä¼˜å…ˆçº§é¡ºåºï¼š</p>
<pre><code>ä¾èµ– -&gt; main -&gt; æ¸ é“ -&gt; æ„å»ºç±»å‹
</code></pre>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚é‡å¤èµ„æºåŒæ—¶å­˜åœ¨äº<code>main</code>æ–‡ä»¶å¤¹å’Œä¸åŒæ¸ é“ä¸­ï¼Œgradle ä¼šé€‰æ‹©ä¿ç•™æ¸ é“ä¸­çš„èµ„æºã€‚</p>
<p>åŒæ—¶ï¼Œå¦‚æœé‡å¤èµ„æºåœ¨åŒä¸€å±‚æ¬¡å‡ºç°ï¼Œæ¯”å¦‚<code>src/main/res/</code> å’Œ <code>src/main/res2/</code>ï¼Œåˆ™ gradle æ— æ³•å®Œæˆèµ„æºåˆå¹¶ï¼Œè¿™æ—¶ä¼šæŠ¥èµ„æºåˆå¹¶é”™è¯¯ã€‚</p>
<p>â€œç§»é™¤èµ„æºâ€æµç¨‹åˆ™è§åçŸ¥æ„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç±»ä¼¼ä»£ç ï¼Œæ··æ·†èµ„æºç§»é™¤ä¹Ÿå¯ä»¥å®šä¹‰å“ªäº›èµ„æºéœ€è¦è¢«ä¿ç•™ï¼Œè¿™ç‚¹åœ¨ä¸‹æ–‡ç»™å‡ºã€‚</p>
<h2 id="ä¸‰-è‡ªå®šä¹‰æ··æ·†è§„åˆ™">ä¸‰ã€è‡ªå®šä¹‰æ··æ·†è§„åˆ™</h2>
<p>åœ¨ä¸Šæ–‡â€œæ··æ·†é…ç½®â€ä¸­æœ‰è¿™æ ·ä¸€è¡Œä»£ç </p>
<pre><code>proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
</code></pre>
<p>è¿™è¡Œä»£ç å®šä¹‰äº†æ··æ·†è§„åˆ™ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼šä½äº SDK çš„ <code>tools/proguard/</code> æ–‡ä»¶å¤¹ä¸­çš„ <code>proguard-android.txt</code> çš„å†…å®¹ä»¥åŠé»˜è®¤æ”¾ç½®äºæ¨¡å—æ ¹ç›®å½•çš„ <code>proguard-rules.pro</code> çš„å†…å®¹ã€‚å‰è€…æ˜¯ SDK æä¾›çš„é»˜è®¤æ··æ·†æ–‡ä»¶ï¼ˆå†…å®¹è§é™„å½•1ï¼‰ï¼Œåè€…æ˜¯å¼€å‘è€…è‡ªå®šä¹‰æ··æ·†è§„åˆ™çš„åœ°æ–¹ã€‚</p>
<h3 id="1-å¸¸è§æ··æ·†å‘½ä»¤">1. å¸¸è§æ··æ·†å‘½ä»¤ï¼š</h3>
<ul>
<li>optimizationpasses</li>
<li>dontoptimize</li>
<li>dontusemixedcaseclassnames</li>
<li>dontskipnonpubliclibraryclasses</li>
<li>dontpreverify</li>
<li>dontwarn</li>
<li>verbose</li>
<li>optimizations</li>
<li>keep</li>
<li>keepnames</li>
<li>keepclassmembers</li>
<li>keepclassmembernames</li>
<li>keepclasseswithmembers</li>
<li>keepclasseswithmembernames</li>
</ul>
<p>åœ¨ç¬¬ä¸€éƒ¨åˆ† Android æ··æ·†æœ€ä½³å®è·µä¸­å·²ä»‹ç»éƒ¨åˆ†éœ€è¦ä½¿ç”¨åˆ°çš„æ··æ·†å‘½ä»¤ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè¯¦æƒ…è¯·æŸ¥é˜… <a href="http://proguard.sourceforge.net/">å®˜ç½‘</a>ã€‚éœ€è¦ç‰¹åˆ«ä»‹ç»çš„æ˜¯ä¸ä¿æŒç›¸å…³å…ƒç´ ä¸å‚ä¸æ··æ·†çš„è§„åˆ™ç›¸å…³çš„å‡ ç§å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">å‘½ä»¤</th>
<th style="text-align:left">ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">-keep</td>
<td style="text-align:left">é˜²æ­¢ç±»å’Œæˆå‘˜è¢«ç§»é™¤æˆ–è€…è¢«é‡å‘½å</td>
</tr>
<tr>
<td style="text-align:left">-keepnames</td>
<td style="text-align:left">é˜²æ­¢ç±»å’Œæˆå‘˜è¢«é‡å‘½å</td>
</tr>
<tr>
<td style="text-align:left">-keepclassmembers</td>
<td style="text-align:left">é˜²æ­¢æˆå‘˜è¢«ç§»é™¤æˆ–è€…è¢«é‡å‘½å</td>
</tr>
<tr>
<td style="text-align:left">-keepnames</td>
<td style="text-align:left">é˜²æ­¢æˆå‘˜è¢«é‡å‘½å</td>
</tr>
<tr>
<td style="text-align:left">-keepclasseswithmembers</td>
<td style="text-align:left">é˜²æ­¢<strong>æ‹¥æœ‰è¯¥æˆå‘˜çš„</strong>ç±»å’Œæˆå‘˜è¢«ç§»é™¤æˆ–è€…è¢«é‡å‘½å</td>
</tr>
<tr>
<td style="text-align:left">-keepclasseswithmembernames</td>
<td style="text-align:left">é˜²æ­¢<strong>æ‹¥æœ‰è¯¥æˆå‘˜çš„</strong>ç±»å’Œæˆå‘˜è¢«é‡å‘½å</td>
</tr>
</tbody>
</table>
<h3 id="2-ä¿æŒå…ƒç´ ä¸å‚ä¸æ··æ·†çš„è§„åˆ™">2. ä¿æŒå…ƒç´ ä¸å‚ä¸æ··æ·†çš„è§„åˆ™</h3>
<p>å½¢å¦‚ï¼š</p>
<pre><code>[ä¿æŒå‘½ä»¤] [ç±»] {
    [æˆå‘˜] 
}
</code></pre>
<p>â€œç±»â€ä»£è¡¨ç±»ç›¸å…³çš„é™å®šæ¡ä»¶ï¼Œå®ƒå°†æœ€ç»ˆå®šä½åˆ°æŸäº›ç¬¦åˆè¯¥é™å®šæ¡ä»¶çš„ç±»ã€‚å®ƒçš„å†…å®¹å¯ä»¥ä½¿ç”¨ï¼š</p>
<ul>
<li>å…·ä½“çš„ç±»</li>
<li>è®¿é—®ä¿®é¥°ç¬¦ï¼ˆpublicã€protectedã€privateï¼‰</li>
<li>é€šé…ç¬¦*ï¼ŒåŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼Œä½†ä¸å«åŒ…ååˆ†éš”ç¬¦(.)</li>
<li>é€šé…ç¬¦**ï¼ŒåŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼Œå¹¶ä¸”åŒ…å«åŒ…ååˆ†éš”ç¬¦(.)<br>
-Â extendsï¼Œå³å¯ä»¥æŒ‡å®šç±»çš„åŸºç±»<br>
-Â implementï¼ŒåŒ¹é…å®ç°äº†æŸæ¥å£çš„ç±»</li>
<li>$ï¼Œå†…éƒ¨ç±»</li>
</ul>
<p>â€œæˆå‘˜â€ä»£è¡¨ç±»æˆå‘˜ç›¸å…³çš„é™å®šæ¡ä»¶ï¼Œå®ƒå°†æœ€ç»ˆå®šä½åˆ°æŸäº›ç¬¦åˆè¯¥é™å®šæ¡ä»¶çš„ç±»æˆå‘˜ã€‚å®ƒçš„å†…å®¹å¯ä»¥ä½¿ç”¨ï¼š</p>
<ul>
<li><code>&lt;init&gt;</code> åŒ¹é…æ‰€æœ‰æ„é€ å™¨</li>
<li><code>&lt;fields&gt;</code> åŒ¹é…æ‰€æœ‰åŸŸ</li>
<li><code>&lt;methods&gt;</code> åŒ¹é…æ‰€æœ‰æ–¹æ³•</li>
<li>é€šé…ç¬¦*ï¼ŒåŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼Œä½†ä¸å«åŒ…ååˆ†éš”ç¬¦(.)</li>
<li>é€šé…ç¬¦**ï¼ŒåŒ¹é…ä»»æ„é•¿åº¦å­—ç¬¦ï¼Œå¹¶ä¸”åŒ…å«åŒ…ååˆ†éš”ç¬¦(.)</li>
<li>é€šé…ç¬¦***ï¼ŒåŒ¹é…ä»»æ„å‚æ•°ç±»å‹<br>
-Â â€¦ï¼ŒåŒ¹é…ä»»æ„é•¿åº¦çš„ä»»æ„ç±»å‹å‚æ•°ã€‚æ¯”å¦‚ <code>void test(â€¦)</code> å°±èƒ½åŒ¹é…ä»»æ„Â <code>void test(String a)</code>Â æˆ–è€…æ˜¯Â <code>void test(int a, String b)</code> è¿™äº›æ–¹æ³•ã€‚</li>
<li>è®¿é—®ä¿®é¥°ç¬¦ï¼ˆpublicã€protectedã€privateï¼‰</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚éœ€è¦å°† <code>name.huihui.test</code>åŒ…ä¸‹æ‰€æœ‰ç»§æ‰¿ <code>Activity</code> çš„ <code>public</code> ç±»åŠå…¶æ„é€ å‡½æ•°éƒ½ä¿æŒä½ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code>-keep public class name.huihui.test.** extends Android.app.Activity {
    &lt;init&gt;
}
</code></pre>
<h3 id="3-å¸¸ç”¨çš„è‡ªå®šä¹‰æ··æ·†è§„åˆ™">3. å¸¸ç”¨çš„è‡ªå®šä¹‰æ··æ·†è§„åˆ™</h3>
<ul>
<li>ä¸æ··æ·†æŸä¸ªç±»</li>
</ul>
<pre><code>-keep public class name.huihui.example.Test { *; }
</code></pre>
<ul>
<li>ä¸æ··æ·†æŸä¸ªåŒ…æ‰€æœ‰çš„ç±»</li>
</ul>
<pre><code>-keep class name.huihui.test.** { *; }
</code></pre>
<ul>
<li>ä¸æ··æ·†æŸä¸ªç±»çš„å­ç±»</li>
</ul>
<pre><code>-keep public class * extends name.huihui.example.Test { *; }
</code></pre>
<ul>
<li>ä¸æ··æ·†æ‰€æœ‰ç±»åä¸­åŒ…å«äº†â€œmodelâ€çš„ç±»åŠå…¶æˆå‘˜</li>
</ul>
<pre><code>-keep public class **.*model*.** {*;}
</code></pre>
<ul>
<li>ä¸æ··æ·†æŸä¸ªæ¥å£çš„å®ç°</li>
</ul>
<pre><code>-keep class * implements name.huihui.example.TestInterface { *; }
</code></pre>
<ul>
<li>ä¸æ··æ·†æŸä¸ªç±»çš„æ„é€ æ–¹æ³•</li>
</ul>
<pre><code>-keepclassmembers class name.huihui.example.Test { 
    public &lt;init&gt;(); 
}
</code></pre>
<ul>
<li>ä¸æ··æ·†æŸä¸ªç±»çš„ç‰¹å®šçš„æ–¹æ³•</li>
</ul>
<pre><code>-keepclassmembers class name.huihui.example.Test { 
    public void test(java.lang.String); 
}
</code></pre>
<h2 id="å››-è‡ªå®šä¹‰èµ„æºä¿æŒè§„åˆ™">å››ã€è‡ªå®šä¹‰èµ„æºä¿æŒè§„åˆ™</h2>
<h3 id="1-keepxml">1. keep.xml</h3>
<p>ç”¨<code>shrinkResources true</code>å¼€å¯èµ„æºå‹ç¼©åï¼Œæ‰€æœ‰æœªè¢«ä½¿ç”¨çš„èµ„æºé»˜è®¤è¢«ç§»é™¤ã€‚å‡å¦‚ä½ éœ€è¦å®šä¹‰å“ªäº›èµ„æºå¿…é¡»è¢«ä¿ç•™ï¼Œåœ¨ <code>res/raw/</code>è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ª xml æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>keep.xml</code>ã€‚</p>
<p>é€šè¿‡ä¸€äº›å±æ€§çš„è®¾ç½®å¯ä»¥å®ç°å®šä¹‰èµ„æºä¿æŒçš„éœ€æ±‚ï¼Œå¯é…ç½®çš„å±æ€§æœ‰ï¼š<br>
- <code>tools:keep</code> å®šä¹‰å“ªäº›èµ„æºéœ€è¦è¢«ä¿ç•™ï¼ˆèµ„æºä¹‹é—´ç”¨â€œ,â€éš”å¼€ï¼‰<br>
- <code>tools:discard</code> å®šä¹‰å“ªäº›èµ„æºéœ€è¦è¢«ç§»é™¤ï¼ˆèµ„æºä¹‹é—´ç”¨â€œ,â€éš”å¼€ï¼‰<br>
- <code>tools:shrinkMode</code> å¼€å¯ä¸¥æ ¼æ¨¡å¼</p>
<p>å½“ä»£ç ä¸­é€šè¿‡ <code>Resources.getIdentifier()</code> ç”¨åŠ¨æ€çš„å­—ç¬¦ä¸²æ¥è·å–å¹¶ä½¿ç”¨èµ„æºæ—¶ï¼Œæ™®é€šçš„èµ„æºå¼•ç”¨æ£€æŸ¥å°±å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸‹ä»£ç ä¼šå¯¼è‡´æ‰€æœ‰ä»¥â€œimg_â€å¼€å¤´çš„èµ„æºéƒ½è¢«æ ‡è®°ä¸ºå·²ä½¿ç”¨ã€‚</p>
<pre><code>String name = String.format(&quot;img_%1d&quot;, angle + 1);
res = getResources().getIdentifier(name, &quot;drawable&quot;, getPackageName());
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥è®¾ç½® <code>tools:shrinkMode</code> ä¸º <code>strict</code> æ¥å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Œä½¿åªæœ‰ç¡®å®è¢«ä½¿ç”¨çš„èµ„æºè¢«ä¿ç•™ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯è‡ªå®šä¹‰èµ„æºä¿æŒè§„åˆ™ç›¸å…³çš„é…ç½®ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;resources xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    tools:keep=&quot;@layout/l_used*_c,@layout/l_used_a,@layout/l_used_b*&quot;
    tools:discard=&quot;@layout/unused2&quot;
    tools:shrinkMode=&quot;strict&quot;/&gt;
</code></pre>
<h3 id="2-ç§»é™¤æ›¿ä»£èµ„æº">2. ç§»é™¤æ›¿ä»£èµ„æº</h3>
<p>ä¸€äº›æ›¿ä»£èµ„æºï¼Œä¾‹å¦‚å¤šè¯­è¨€æ”¯æŒçš„ <code>strings.xml</code>ï¼Œå¤šåˆ†è¾¨ç‡æ”¯æŒçš„ <code>layout.xml</code> ç­‰ï¼Œåœ¨æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨åˆä¸æƒ³åˆ é™¤æ‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨èµ„æºå‹ç¼©å°†å®ƒä»¬ç§»é™¤ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <code>resConfig</code> å±æ€§æ¥æŒ‡å®šéœ€è¦æ”¯æŒçš„å±æ€§ï¼Œä¾‹å¦‚</p>
<pre><code>android {
    defaultConfig {
        ...
        resConfigs &quot;en&quot;, &quot;fr&quot;
    }
}
</code></pre>
<p>å…¶ä»–æœªæ˜¾å¼å£°æ˜çš„è¯­è¨€èµ„æºå°†è¢«ç§»é™¤ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://developer.android.com/studio/build/shrink-code.html">Shrink Your Code and Resources</a></li>
<li><a href="http://proguard.sourceforge.net/">proguard</a></li>
<li><a href="http://blog.csdn.net/sinyu890807/article/details/50451259">Androidå®‰å…¨æ”»é˜²æˆ˜ï¼Œåç¼–è¯‘ä¸æ··æ·†æŠ€æœ¯å®Œå…¨è§£æï¼ˆä¸‹ï¼‰</a></li>
<li><a href="http://www.jianshu.com/p/7436a1a32891">Androidæ··æ·†ä»å…¥é—¨åˆ°ç²¾é€š</a></li>
<li><a href="http://rensanning.iteye.com/blog/2224635">Androidä»£ç æ··æ·†ä¹‹ProGuard</a></li>
</ul>
<h2 id="é™„å½•">é™„å½•</h2>
<ol>
<li><code>proguard-android.txt</code>æ–‡ä»¶å†…å®¹</li>
</ol>
<pre><code>#åŒ…åä¸æ··åˆå¤§å°å†™
-dontusemixedcaseclassnames

#ä¸è·³è¿‡éå…¬å…±çš„åº“çš„ç±»
-dontskipnonpubliclibraryclasses

#æ··æ·†æ—¶è®°å½•æ—¥å¿—
-verbose

#å…³é—­é¢„æ ¡éªŒ
-dontpreverify

#ä¸ä¼˜åŒ–è¾“å…¥çš„ç±»æ–‡ä»¶
-dontoptimize

#ä¿æŠ¤æ³¨è§£
-keepattributes *Annotation*

#ä¿æŒæ‰€æœ‰æ‹¥æœ‰æœ¬åœ°æ–¹æ³•çš„ç±»ååŠæœ¬åœ°æ–¹æ³•å
-keepclasseswithmembernames class * {
    native &lt;methods&gt;;
}

#ä¿æŒè‡ªå®šä¹‰Viewçš„getå’Œsetç›¸å…³æ–¹æ³•
-keepclassmembers public class * extends android.view.View {
   void set*(***);
   *** get*();
}

#ä¿æŒActivityä¸­ViewåŠå…¶å­ç±»å…¥å‚çš„æ–¹æ³•
-keepclassmembers class * extends android.app.Activity {
   public void *(android.view.View);
}

#æšä¸¾
-keepclassmembers enum * {
    **[] $VALUES;
    public *;
}

#Parcelable
-keepclassmembers class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator CREATOR;
}

#Ræ–‡ä»¶çš„é™æ€æˆå‘˜
-keepclassmembers class **.R$* {
    public static &lt;fields&gt;;
}

-dontwarn android.support.**

#keepç›¸å…³æ³¨è§£
-keep class android.support.annotation.Keep

-keep @android.support.annotation.Keep class * {*;}

-keepclasseswithmembers class * {
    @android.support.annotation.Keep &lt;methods&gt;;
}

-keepclasseswithmembers class * {
    @android.support.annotation.Keep &lt;fields&gt;;
}

-keepclasseswithmembers class * {
    @android.support.annotation.Keep &lt;init&gt;(...);
}
</code></pre>
<h2 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h2>
<p>ååˆ†æ„Ÿè°¢ä½ èƒ½çœ‹åˆ°æœ€åï¼Œå› æœ¬äººæ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™æ¼è¿˜è¯·ä¸åèµæ•™ï¼Œåœ¨æ­¤å…ˆè¡Œè°¢è¿‡ã€‚</p>
<p>åŒæ—¶ï¼Œå‡å¦‚æœ‰è¿™æ–¹é¢çš„å›°æƒ‘æˆ–è€…è®¨è®ºï¼Œä¹Ÿååˆ†æ¬¢è¿è”ç³»æˆ‘ã€‚</p>
<p>æ­£æ–‡å¼•ç”¨åˆ°æ­¤ç»“æŸï¼Œæ–‡ç« æœ‰ä¸€å¼ å›¾ç‰‡ï¼Œå®åœ¨æ˜¯æ²¡æ‰¾åˆ°ï¼Œæ‰€ä»¥ä¸€ç›´æ˜¯ç©ºç€çš„ã€‚</p>
<h2 id="æˆ‘æœ‰è¯è¯´">æˆ‘æœ‰è¯è¯´</h2>
<p>å­¦äº†ä¸€æ³¢ï¼Œå‘ç°å…¶å® ProGuard æ ¹æœ¬ä¸éš¾ï¼Œè€Œä¸”ï¼Œå®é™…é¡¹ç›®ä¸­ï¼Œä¹Ÿä¸ä¼šå¼•èµ·çº¿ä¸Šé”™è¯¯æ—¥å¿—è°ƒè¯•å›°éš¾ï¼Œå› ä¸º ProGuard å®Œæˆåéƒ½ä¼šç”Ÿæˆ mapping æ–‡ä»¶ï¼Œmapping æ–‡ä»¶è®°å½•ç€æ‰€æœ‰ç¬¦å·è¡¨å‰åæ˜ å°„å…³ç³»ï¼Œå€ŸåŠ©è¿™ä¸ªæ–‡ä»¶ï¼Œè®¸å¤šé”™è¯¯æ—¥å¿—æ”¶é›†å¹³å°éƒ½èƒ½åœ¨çº¿ä¸Šåå‘è§£æå‡ºé”™è¯¯ç›¸å…³çš„æºä»£ç ï¼Œç°åœ¨å‡ ä¹æ‰€æœ‰å¹³å°éƒ½ä¼šæ”¯æŒä¸Šä¼  mapping æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ç°åœ¨éƒ½åæ‚”å­¦æ™šäº†ã€‚ä¸‹æ¬¡å¾—æŠ“ç´§ã€‚</p>
<p>æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@ph_an_tom?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Duangphorn Wiriya</a> on <a href="https://unsplash.com/search/photos/confuse?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç”¨ MotionLayout æ¥åšè¿‡æ¸¡åŠ¨ç”»]]></title>
        <id>https://cherrylover.github.io/post/yong-motionlayout-lai-zuo-guo-du-dong-hua</id>
        <link href="https://cherrylover.github.io/post/yong-motionlayout-lai-zuo-guo-du-dong-hua">
        </link>
        <updated>2019-07-13T09:40:14.000Z</updated>
        <content type="html"><![CDATA[<p>MotionLayout æ˜¯ä¸€ä¸ª Google å®˜æ–¹å‡ºå“ç”¨äºåˆ¶ä½œ Android ä¸­çš„è¿‡æ¸¡åŠ¨ç”»çš„æ¡†æ¶ã€‚ç”¨æ¥å®ƒå°±èƒ½è½»æ¾çš„åšå‡ºä¸€äº›è¾ƒä¸ºå¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚</p>
<blockquote>
<p>ç”±äº MotionLayout æ˜¯åŸºäº ConstraintLayout ï¼Œæ‰€ä»¥å…¶ä¸­æ¶‰åŠåˆ°äº†éƒ¨åˆ†å…³äº ConstraintLayout çš„åŸºæœ¬çŸ¥è¯†ï¼Œæœ¬æ–‡æŒ‰ä¸‹ä¸è¡¨ï¼Œå¯¹ ConstraintLayout ä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œå¯ä»¥æŸ¥çœ‹é¸¿æ´‹çš„<a href="https://blog.csdn.net/lmj623565791/article/details/78011599">è¿™ç¯‡åšå®¢</a>ã€‚</p>
</blockquote>
<p>MotionLayout æ˜¯ ConstraintLayout çš„å­ç±»ï¼Œå¹¶ä¸”åœ¨ ConstraintLayout å‘å±•åˆ° 2.0 æ—¶æ‰åŠ å…¥ ConstraintLayout è¿™ä¸ªåº“ï¼Œæœ¬æ–‡æ‰€ä½¿ç”¨çš„ä¾èµ–ä¸ºï¼š</p>
<pre><code class="language-groovy">implementation 'androidx.constraintlayout:constraintlayout:2.0.0-beta2'
</code></pre>
<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œå…ˆæ¥çœ‹çœ‹æˆ‘ç”¨ MotionLayout åˆ¶ä½œçš„ä¸€ä¸ª Demoã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_login.gif" alt=""></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“ç‚¹å‡» Login æŒ‰é’®æ—¶ï¼ŒLogin æŒ‰é’®çš„é•¿åº¦è¿›è¡Œä¸æ–­ç¼©å°ï¼Œç¼©å°åˆ°ä¸€å®šå°ºå¯¸æ—¶ï¼Œå¤–å±‚çš„ ProgressBar è¿˜æ˜¯é€æ¸ç”±ä¸å¯è§å˜ä¸ºå¯è§ï¼ŒåŒæ—¶ï¼ŒLogin æŒ‰é’®ä¸Šçš„å­—è¿›è¡Œäº†æ·¡å…¥æ·¡å‡ºçš„åŠ¨ç”»æ•ˆæœã€‚</p>
<p>MotionLayout èƒ½åšçš„ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜èƒ½åšåˆ°å…¶ä»–æ›´ä¸ºå¥½ç©æœ‰è¶£çš„è¿‡æ¸¡åŠ¨ç”»ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥å­¦ä¸€ä¸‹å§ã€‚</p>
<p>è¿‡æ¸¡åŠ¨ç”»ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯åœ¨çŠ¶æ€ä¹‹é—´è¿›è¡Œè¿‡æ¸¡çš„åŠ¨ç”»æ•ˆæœï¼Œé˜²æ­¢é¡µé¢å†… View å‡ºç°ç¬é—´ç§»åŠ¨çš„æ•ˆæœã€‚è€Œ MotionLayout çš„é‡ç‚¹å…¶å®å°±æ˜¯çŠ¶æ€ã€‚å¼€å‘è€…åªéœ€è¦å®šä¹‰å¥½å¯¹åº”çŠ¶æ€ä¸‹ View çš„ç›¸å¯¹ä½ç½®ï¼Œä»¥åŠç›¸å…³å±æ€§ï¼Œå…¶å MotionLayout ä¾¿ä¼šè‡ªåŠ¨ä¸ºå…¶å¢åŠ åŠ¨çš„æ•ˆæœã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_login_1.gif" alt=""></p>
<p>è¿™æ ·çš„ä¸€ä¸ªæœ€ç®€å•çš„æ•ˆæœæ˜¯æ€ä¹ˆåšå‡ºæ¥çš„å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨èµ„æºæ–‡ä»¶å¤¹ <code>res</code> ä¸‹æ–°å»ºä¸€ä¸ªåä¸º xml çš„èµ„æºæ–‡ä»¶å¤¹ï¼Œç„¶åå† xml æ–‡ä»¶å¤¹å†…æ–°å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹æ˜¯ <code>MotionScene</code> çš„ xml æ–‡ä»¶ï¼Œdemo ä¸­è¿™ä¸ª xml çš„æ–‡ä»¶åä¸º login_animatorã€‚</p>
<p>ä»¥ä¸‹å°±æ˜¯å®ç° Login æŒ‰é’®é•¿åº¦å˜æ¢çš„è¿‡æ¸¡åŠ¨ç”»ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;MotionScene xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;

    &lt;Transition
        app:constraintSetEnd=&quot;@id/a_login_end&quot;
        app:constraintSetStart=&quot;@id/a_login_start&quot;
        app:duration=&quot;1000&quot;&gt;
        &lt;OnClick
            app:clickAction=&quot;toggle&quot;
            app:targetId=&quot;@id/tv_action_login&quot; /&gt;

    &lt;/Transition&gt;

    &lt;ConstraintSet android:id=&quot;@+id/a_login_start&quot;&gt;
        &lt;Constraint android:id=&quot;@+id/tv_action_login&quot;&gt;
            &lt;Layout
                android:layout_width=&quot;match_parent&quot;
                android:layout_height=&quot;48dp&quot;
								android:layout_marginTop=&quot;30dp&quot;
                android:layout_marginStart=&quot;30dp&quot;
                android:layout_marginEnd=&quot;30dp&quot;
                app:layout_constraintTop_toBottomOf=&quot;@id/et_passwd&quot; /&gt;
        &lt;/Constraint&gt;

    &lt;/ConstraintSet&gt;

    &lt;ConstraintSet android:id=&quot;@+id/a_login_end&quot;&gt;
        &lt;Constraint android:id=&quot;@+id/tv_action_login&quot;&gt;
            &lt;Layout
                android:layout_width=&quot;48dp&quot;
                android:layout_height=&quot;48dp&quot;
                android:layout_marginTop=&quot;30dp&quot;
                app:layout_constraintEnd_toEndOf=&quot;@+id/et_account&quot;
                app:layout_constraintStart_toStartOf=&quot;@+id/et_account&quot;
                app:layout_constraintTop_toBottomOf=&quot;@id/et_passwd&quot; /&gt;
        &lt;/Constraint&gt;

    &lt;/ConstraintSet&gt;

&lt;/MotionScene&gt;
</code></pre>
<p>ä»”ç»†çœ‹å…¶ä¸­çš„ä¿¡æ¯ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æ˜¯æˆ‘ä»¬éƒ½ç†Ÿæ‚‰çš„ï¼Œæ— éå°±æ˜¯å¯¹ View çš„ç›¸å¯¹ä½ç½®çš„çº¦å®šæˆ–æ˜¯ View è‡ªèº«å±æ€§çš„è§„å®šï¼Œå°‘éƒ¨åˆ†æ˜¯å…³äºè¿‡æ¸¡åŠ¨ç”»çš„ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶çš„æ•´ä½“ç»“æ„ï¼Œé¦–å…ˆæ ¹èŠ‚ç‚¹æ˜¯ MotionScene ï¼ŒMotionScene èŠ‚ç‚¹ä¸‹æœ‰ä¸€ä¸ª Transition ä¸ä¸¤ä¸ª ConstraintSet èŠ‚ç‚¹ï¼Œè€Œä¸” Transition ä¸­æœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯ constraintSetStart å¦ä¸€ä¸ªæ˜¯ constraintSetEndï¼Œè¿™ä¸¤ä¸ªå±æ€§çš„å€¼æ­£å¥½æ˜¯ä¸¤ä¸ª ConstraintSet èŠ‚ç‚¹çš„ idï¼Œè€Œ Transition å†…å­èŠ‚ç‚¹ OnClick èŠ‚ç‚¹å†…çš„å±æ€§ targetId åˆ™è¡¨æ˜äº†å½“å‰ Transition æ‰€æŒ‡å®šçš„åŠ¨ç”»æ˜¯ä½œç”¨äºå…·ä½“çš„ View ä¸Šã€‚</p>
<p>å¦‚ä½ æ‰€æƒ³ï¼Œé€šè¿‡åœ¨ Transition å†…æŒ‡å®šæŸä¸ª View çš„ä¸¤ä¸ªçŠ¶æ€ä¸‹çš„ä¸åŒå±æ€§ï¼Œå°±èƒ½äº§ç”Ÿåœ¨è¿™ä¸¤ä¸ªçŠ¶æ€å†…çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œå¹¶ä¸”åœ¨ Translation å†…é€šè¿‡ç»„åˆä¸åŒçš„åŠ¨ç”»äº‹ä»¶è¿›è¡Œæ˜¾ç¤ºã€‚æ¯”å¦‚ç‚¹å‡»äº§ç”Ÿçš„åŠ¨ç”»ï¼ˆOnClickï¼‰ï¼Œæ»‘åŠ¨äº§ç”Ÿçš„åŠ¨ç”»ï¼ˆOnSwipeï¼‰ï¼Œä»¥åŠå¯æ”¹å˜æŸä¸€å¸§åŠ¨ç”»æ•ˆæœçš„å…³é”®å¸§åŠ¨ç”»ï¼ˆKeyFrameSetï¼‰ã€‚</p>
<p>å½“æˆ‘ä»¬æŠŠåˆå§‹åŠç»“æŸçŠ¶æ€ä¸‹çš„å±æ€§åŠåŠ¨ç”»å®šä¹‰å®Œæˆåï¼Œè¿˜éœ€è¦å›åˆ°æˆ‘ä»¬çš„å¸ƒå±€æ–‡ä»¶ï¼Œå°†éœ€è¦å®ç°è¿‡æ¸¡åŠ¨ç”»çš„ View çš„çˆ¶å¸ƒå±€æ”¹ä¸º MotionLayout å¹¶ä¸”ç»™å®ƒæ·»åŠ ä¸€ä¸ªå€¼ä¸ºåˆšæ‰æˆ‘ä»¬æ–°å»ºé‚£ä¸ª xml æ–‡ä»¶çš„å¼•ç”¨çš„å±æ€§ layoutDescriptionã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.motion.widget.MotionLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    app:layoutDescription=&quot;@xml/login_animator&quot;&gt;
    ......
&lt;/androidx.constraintlayout.motion.widget.MotionLayout&gt;
</code></pre>
<p>è¿™å°±æ˜¯ä¸€ä¸ªæœ€ä¸ºç®€å•çš„ä½¿ç”¨ MotionLayout å®ç°è¿‡æ¸¡åŠ¨ç”»çš„ä¾‹å­ï¼Œå®ƒä¸å¼€å¤´æˆ‘è‡ªå·±å†™çš„é‚£ä¸ª demo æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œæ— éå°±æ˜¯ demo ä¸­å˜æ¢çš„ View çš„ä¸ªæ•°åŠå±æ€§å¤šå°‘ä¸åŒè€Œå·²ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ Transition ä¸­å®šä¹‰äº†ä¸€ä¸ª OnClick çš„å­èŠ‚ç‚¹ï¼Œè€Œè¾¾åˆ°ç‚¹å‡»äº§ç”ŸåŠ¨ç”»çš„æ•ˆæœã€‚å…¶ä¸­ï¼ŒtargetId å³ä¸ºäº§ç”ŸåŠ¨ç”»æ•ˆæœçš„ç›®æ ‡ View çš„ idï¼›clickAction åˆ™æ˜¯æŒ‡æ˜åœ¨æ˜¯åœ¨å¼€å§‹æˆ–æ˜¯å†ç»“æŸçŠ¶æ€æ—¶äº§ç”ŸåŠ¨ç”»ï¼Œtoggle è¡¨ç¤ºåœ¨å¼€å§‹å’Œç»“æŸçŠ¶æ€æ—¶å‡æœ‰æ•ˆï¼Œå®ƒè¿˜æœ‰ transitionToStart å’Œ transitionToEnd è¡¨ç¤ºåªåœ¨å¼€å§‹æˆ–æ˜¯ç»“æŸçŠ¶æ€ä¸‹æœ‰æ•ˆã€‚æœ‰å…´è¶£çš„å¯ä»¥å»è¯•è¯•ã€‚</p>
<p>é™¤äº† OnClickï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ Translation ä¸­å®šä¹‰ OnSwipe èŠ‚ç‚¹ï¼ŒOnSwipe å°±æ˜¯ç”¨æ¥å¤„ç†å±å¹•ä¸Šçš„æ»‘åŠ¨äº‹ä»¶ï¼Œä»¥æ­¤é…åˆæŒ‡å®šçš„ View å®ç°è¿‡æ¸¡åŠ¨ç”»çš„æ•ˆæœã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_swipe_short.gif" alt=""></p>
<blockquote>
<p>ç»™ MotionLayout æ·»åŠ  motionDebug=&quot;SHOW_PATH&quot; è¿™ä¸ªå±æ€§ï¼Œå³å¯æŸ¥çœ‹ View çš„è¿‡æ¸¡åŠ¨ç”»çš„è½¨è¿¹ã€‚</p>
</blockquote>
<p>é€šè¿‡æŒ‡å®š View çš„å¼€å§‹çŠ¶æ€ï¼ˆé è¿‘å±å¹•å·¦è¾¹ï¼‰å’Œç»“æŸçŠ¶æ€ï¼ˆé è¿‘å±å¹•å³è¾¹ï¼‰ï¼Œç„¶ååœ¨ Translation ä¸­å£°æ˜å‡ºæ»‘åŠ¨äº‹ä»¶ï¼Œå³å¯ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;MotionScene xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;&gt;

    &lt;Transition
        app:constraintSetEnd=&quot;@id/v_swipe_end&quot;
        app:constraintSetStart=&quot;@id/v_swipe_start&quot;
        app:duration=&quot;1000&quot;&gt;
        &lt;OnSwipe
            app:dragDirection=&quot;dragRight&quot;
            app:touchRegionId=&quot;@id/v_swipe&quot; /&gt;

    &lt;/Transition&gt;
    
    &lt;ConstraintSet android:id=&quot;@+id/v_swipe_start&quot;&gt;
        &lt;Constraint android:id=&quot;@+id/v_swipe&quot;&gt;
            &lt;Layout
                android:layout_width=&quot;48dp&quot;
                android:layout_height=&quot;48dp&quot;
                app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
                app:layout_constraintStart_toStartOf=&quot;parent&quot;
                app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;
        &lt;/Constraint&gt;

    &lt;/ConstraintSet&gt;

    &lt;ConstraintSet android:id=&quot;@+id/v_swipe_end&quot;&gt;
        &lt;Constraint android:id=&quot;@+id/v_swipe&quot;&gt;
            &lt;Layout
                android:layout_width=&quot;48dp&quot;
                android:layout_height=&quot;48dp&quot;
                app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
                app:layout_constraintEnd_toEndOf=&quot;parent&quot;
                app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;
        &lt;/Constraint&gt;

    &lt;/ConstraintSet&gt;

&lt;/MotionScene&gt;
</code></pre>
<p>åœ¨ OnSwipe ä¸­ï¼Œæœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯ dragDirection ä»£è¡¨çš„æ˜¯æ»‘åŠ¨çš„æ–¹å‘ï¼ŒtouchRegionId åˆ™æŒ‡æ˜äº†ç›‘å¬çš„æ»‘åŠ¨åŒºåŸŸä¸º View çš„æ»‘åŠ¨åŒºåŸŸã€‚æ—¢ç„¶èƒ½ä½œç”¨äº View çš„æ»‘åŠ¨åŒºåŸŸï¼Œæ˜¯ä¸æ˜¯ä¹Ÿèƒ½ä½œç”¨äºæ•´ä¸ªå±å¹•çš„æ»‘åŠ¨åŒºåŸŸå‘¢ï¼Ÿæ²¡é”™ï¼ŒtouchAnchorId åˆ™è¡¨ç¤ºå…¨éƒ¨çš„æ»‘åŠ¨åŒºåŸŸã€‚OnSwipe è¿˜æœ‰ä¸€äº›å…¶ä»–å±æ€§ï¼Œæ¯”å¦‚ï¼štouchAnchorSide è¡¨ç¤ºç›‘å¬ View çš„å“ªä¸ªåŒºåŸŸçš„æ»‘åŠ¨ç›‘å¬ï¼Œå¦‚æœä¸è®¾ç½®çš„è¯ï¼Œæ˜¯ View å¤–çš„æ‰€æœ‰åŒºåŸŸï¼›onTouchUp è¡¨ç¤ºå½“åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­æ‰‹æŒ‡æŠ¬èµ·æ—¶åŠ¨ç”»çš„åŠ¨ä½œï¼ˆå›åˆ°å¼€å§‹çŠ¶æ€ã€å›åˆ°ç»“æŸçŠ¶æ€ã€è‡ªåŠ¨å®Œæˆã€åœæ­¢ç­‰ç­‰ï¼‰ã€‚</p>
<p>è¯´å®è¯ï¼Œæˆ‘åœ¨å¼€å§‹å°è¯• MotionLayout çš„æ—¶å€™è¢« OnSwipe ç»™å“åˆ°äº†ï¼Œä½†æ˜¯å½“æˆ‘æ›´è¿›ä¸€æ­¥çš„ä½¿ç”¨ KeyFrameSet çš„æ—¶å€™ç›´å–Š 666ã€‚åŸå› å°±æ˜¯å› ä¸º KeyFrameSet èƒ½åšå‡ºæ›´ç‚«é…·çš„æ•ˆæœã€‚</p>
<p>KeyFrameSet æ˜¯ä½œç”¨äºåœ¨è¿‡æ¸¡åŠ¨ç”»è¿‡ç¨‹ä¸­çš„å…³é”®å¸§ï¼Œé€šè¿‡æŒ‡å®šåŠ¨ç”»å…³é”®è¿›ç¨‹æ—¶çš„çŠ¶æ€æ¥å®ç°ä¸åŒçš„æ•ˆæœã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“å‰çš„ View æ»‘åŠ¨æ˜¯ä¸€æ¡ç›´çº¿ï¼Œæˆ‘æƒ³è®©åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªå…ˆå‘ä¸Šæ»‘åŠ¨ï¼Œç„¶åå‘ä¸‹æ»‘åŠ¨ä»¥è¿™ç§æ•ˆæœè¾¾åˆ°å±å¹•çš„æœ€å³ä¾§ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_swipe_frame.gif" alt=""></p>
<p>View çš„å¼€å§‹ä¸ç»“æŸçŠ¶æ€æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œåªæ˜¯åœ¨è¿‡æ¸¡åŠ¨ç”»çš„ä¸­ç‚¹åŒºåŸŸè¿›è¡Œæ”¹å˜ View çš„åæ ‡ã€‚</p>
<pre><code class="language-xml">&lt;Transition
    app:constraintSetEnd=&quot;@id/v_swipe_end&quot;
    app:constraintSetStart=&quot;@id/v_swipe_start&quot;
    app:duration=&quot;1000&quot;&gt;
    &lt;OnSwipe
        app:dragDirection=&quot;dragRight&quot;
        app:touchAnchorId=&quot;@id/v_swipe&quot;
        app:touchAnchorSide=&quot;bottom&quot; /&gt;

    &lt;KeyFrameSet&gt;
        &lt;KeyPosition
            app:framePosition=&quot;50&quot;
            app:keyPositionType=&quot;parentRelative&quot;
            app:motionTarget=&quot;@+id/v_swipe&quot;
            app:percentY=&quot;0.3&quot; /&gt;
    &lt;/KeyFrameSet&gt;

&lt;/Transition&gt;
</code></pre>
<p>framePosition è¡¨ç¤ºåœ¨è¿åŠ¨åˆ°æ•´ä¸ªè¿åŠ¨è¿‡ç¨‹çš„ 50% å¤„ï¼Œè¿™ä¸ªå€¼çš„å–å€¼èŒƒå›´æ˜¯ 0 - 100ï¼ŒmotionTarget è¡¨ç¤ºä½œç”¨çš„ Viewï¼Œè€Œ keyPositionType ä¸percentY åˆ™å…±åŒå†³å®šäº†è¿åŠ¨è½¨è¿¹ä¸­å¼§åº¦çš„å˜åŒ–æ–¹å‘ã€‚keyPositionType æ§åˆ¶ percentY çš„åæ ‡ç³»çš„å·¥ä½œæ–¹å¼ï¼Œå®ƒä¸€å…±æœ‰ 3 ä¸ªå€¼ã€‚parentRelativeã€deltaRelativeã€pathRelativeã€‚percentY å–å€¼èŒƒå›´ä¸º 0 - 1ï¼ŒåŒæ—¶å…è®¸è´Ÿæ•°åŠå¤§äº 1 çš„å€¼ã€‚</p>
<p>parentRelative è¡¨ç¤ºï¼Œåæ ‡æŒ‰ç…§çˆ¶å¸ƒå±€çš„åæ ‡è¿›è¡Œå¤„ç†ï¼ŒXï¼ŒY è½´çš„æœ€å¤§å€¼å‡ä¸º1ï¼ŒX è½´å‘å³ä¸ºæ­£ï¼Œå‘å·¦ä¸ºè´Ÿï¼ŒY è½´å‘ä¸‹ä¸ºæ­£ï¼Œå‘ä¸Šä¸ºè´Ÿã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/parentRelative'.png" alt=""></p>
<p>deltaRelative è¡¨ç¤ºå¼€å§‹çŠ¶æ€çš„ä¸­å¿ƒç‚¹ä¸ºåæ ‡ç³»åŸç‚¹ï¼ŒXï¼ŒY è½´çš„æœ€å¤§å€¼å‡ä¸º1ï¼ŒX è½´å‘å³ä¸ºæ­£ï¼Œå‘å·¦ä¸ºè´Ÿï¼ŒY è½´å‘ä¸‹ä¸ºè´Ÿï¼Œå‘ä¸Šä¸ºæ­£ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/deltaRelative.png" alt=""></p>
<p>pathRelative è¡¨ç¤ºå¼€å§‹çŠ¶æ€çš„ä¸­å¿ƒç‚¹ä¸ºåæ ‡ç³»åŸç‚¹ï¼ŒX è½´ä¸ºä¸¤ä¸ªçŠ¶ä¸­å¿ƒç‚¹çš„æ„æˆçš„ç›´çº¿ã€‚Xï¼ŒY è½´çš„æœ€å¤§å€¼å‡ä¸º1ï¼ŒX è½´å‘ç»“æŸçŠ¶æ€æ–¹å‘ä¸ºæ­£ï¼Œå‘å¼€å§‹çŠ¶æ€æ–¹å‘ä¸ºè´Ÿï¼ŒY è½´å‘ä¸‹ä¸ºè´Ÿï¼Œå‘ä¸Šä¸ºæ­£ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/pathRelative.png" alt=""></p>
<blockquote>
<p>keyPositionType ä¸‰ä¸ªå±æ€§çš„æè¿°å›¾å‡æ¥è‡ª <a href="https://codelabs.developers.google.com/codelabs/motion-layout/index.html?index=..%2F..index#4">CodeLab</a></p>
</blockquote>
<p>KeyPostition è¿˜æœ‰äº›å…¶ä»–æœ‰è¶£çš„å±æ€§ï¼Œæ¯”å¦‚ï¼Œæ§åˆ¶è¿åŠ¨è½¨è¿¹æ˜¯å¹³æ»‘çš„æ›²çº¿è¿˜æ˜¯ç›´çº¿çš„ curveFitï¼Œä»¥åŠ transitionEasing æ§åˆ¶è¿åŠ¨è¿‡ç¨‹çš„åŠ é€Ÿæˆ–æ˜¯å‡é€Ÿç­‰ç­‰ã€‚è¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ã€‚</p>
<p>è€Œä¸”ï¼Œè¿˜å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªå…³é”®å¸§è¿›è¡Œæ§åˆ¶åŠ¨ç”»æ•ˆæœã€‚</p>
<pre><code class="language-xml">&lt;KeyFrameSet&gt;
    &lt;KeyPosition
        app:framePosition=&quot;50&quot;
        app:keyPositionType=&quot;parentRelative&quot;
        app:motionTarget=&quot;@+id/v_swipe&quot;
        app:percentY=&quot;0.3&quot; /&gt;
    &lt;KeyAttribute
        android:alpha=&quot;0&quot;
        app:framePosition=&quot;50&quot;
        app:motionTarget=&quot;@+id/v_swipe&quot; /&gt;
&lt;/KeyFrameSet&gt;
</code></pre>
<p>keyAttribute æ˜¯ç”¨äºåœ¨è¿‡æ¸¡åŠ¨ç”»ä¸­æ§åˆ¶ View çš„å±æ€§ï¼Œæ¯”å¦‚åœ¨åŠ¨ç”»æ‰§è¡Œ 50% æ—¶ï¼ŒView çš„ alpha å€¼ä¸º 0 ï¼Œé‚£ä¹ˆåœ¨ä» 0 - 50% åŠ 50% - 100% çš„è¿‡ç¨‹ä¸­ï¼Œåˆ™ç”± MotionLayout æ ¹æ®å…¶æ‰§è¡Œæ—¶é—´è‡ªåŠ¨æ”¹å˜ View çš„çŠ¶æ€ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_swipe_attr.gif" alt=""></p>
<p>åˆšæ‰èŠçš„éƒ½æ˜¯å…³äºåŠ¨ç”»æœ¬èº«çš„å†…å®¹ï¼Œå®é™…ä¸Šï¼ŒMotionLayout æä¾›æ›´å¤šæ–¹å¼æ¥å¯¹ View è¿›è¡ŒçŠ¶æ€æ”¹å˜ï¼Œä¸åªæ˜¯é€šè¿‡åœ¨ ConstraintSet ä¸­æŒ‡å®š Layout æ¥æ”¹å˜ View çš„ç›¸å¯¹ä½ç½®ï¼Œå®ƒè¿˜æä¾›äº†æ›´ä¸ºä¸°å¯Œçš„æ–¹æ³•è¿›è¡Œæ”¹å˜ View çš„çŠ¶æ€ï¼Œæ¯”å¦‚ï¼š</p>
<blockquote>
<p>Motion ç”¨äºæ”¹å˜åŠ¨ç”»æ•ˆæœï¼Œä¾‹å¦‚åŠ é€Ÿã€å‡é€Ÿã€å…ˆæ°´å¹³æ–¹æ³•è¿˜æ˜¯å…ˆå‚ç›´æ–¹å‘è¿›è¡Œç§»åŠ¨</p>
<p>CustomAttribute ç”¨äºæ”¹å˜è‡ªå®šä¹‰å±æ€§ï¼›</p>
<p>PropertySet ç”¨äºæ”¹å˜ View ç‰¹å®šçš„å‡ ä¸ªå±æ€§ï¼›</p>
<p>Transform ç”¨äºæ”¹å˜ View ä¸­æ¶‰åŠåˆ°å±æ€§åŠ¨ç”»çš„å±æ€§ï¼Œä¾‹å¦‚ï¼šrotationã€scaleX ç­‰ã€‚ç”¨æ³•ä¹Ÿå¾ˆç®€å•ï¼Œåƒ Layout é‚£æ ·å£°æ˜å‡ºæ¥å³å¯ã€‚</p>
</blockquote>
<pre><code class="language-xml">&lt;ConstraintSet android:id=&quot;@+id/v_swipe_start&quot;&gt;
    &lt;Constraint android:id=&quot;@+id/v_swipe&quot;&gt;
        &lt;CustomAttribute
            app:attributeName=&quot;backgroundColor&quot;
            app:customColorValue=&quot;@color/colorAccent&quot; /&gt;
        &lt;Transform
            android:scaleX=&quot;1.0&quot;
            android:scaleY=&quot;1.0&quot; /&gt;
        &lt;Layout
            android:layout_width=&quot;48dp&quot;
            android:layout_height=&quot;48dp&quot;
            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
            app:layout_constraintStart_toStartOf=&quot;parent&quot;
            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;
    &lt;/Constraint&gt;

&lt;/ConstraintSet&gt;

&lt;ConstraintSet android:id=&quot;@+id/v_swipe_end&quot;&gt;
    &lt;Constraint android:id=&quot;@+id/v_swipe&quot;&gt;
        &lt;CustomAttribute
            app:attributeName=&quot;backgroundColor&quot;
            app:customColorValue=&quot;@color/colorPrimary&quot; /&gt;
        &lt;Transform
            android:scaleX=&quot;3.0&quot;
            android:scaleY=&quot;3.0&quot; /&gt;
        &lt;Layout
            android:layout_width=&quot;48dp&quot;
            android:layout_height=&quot;48dp&quot;
            app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
            app:layout_constraintEnd_toEndOf=&quot;parent&quot;
            app:layout_constraintTop_toTopOf=&quot;parent&quot; /&gt;
    &lt;/Constraint&gt;

&lt;/ConstraintSet&gt;
</code></pre>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/blog/motionLayout/blog_motion_swipe_attr_more.gif" alt=""></p>
<blockquote>
<p>ç”±äºæ”¾å¤§å€æ•°è¾ƒå¤§ï¼Œè¶…å‡ºå±å¹•ï¼Œæ‰€ä»¥åœ¨ç»“æŸçŠ¶æ€æ—¶æ˜¾ç¤ºå­˜åœ¨å¼‚å¸¸ã€‚</p>
</blockquote>
<p>æ€ä¹ˆæ ·ï¼ŒMotionLayout æ˜¯ä¸æ˜¯æ¯”æƒ³è±¡ä¸­çš„å¥½ç©ä¸€äº›ï¼Œå°±æ˜¯ç°åœ¨ä¸å¤ªæ–¹ä¾¿è°ƒè¯•ï¼Œæ¯æ¬¡è°ƒè¯•éƒ½éœ€è¦è¿è¡Œï¼Œä¸è¿‡å‘¢ï¼Œç°åœ¨è¿™ä¸ªè¿˜æ²¡å‘å¸ƒæ­£å¼ç‰ˆï¼Œä¼°è®¡åœ¨æ­£å¼ç‰ˆä¸­ Google åº”è¯¥ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://jiangjiwei.site/">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­å…¨éƒ¨æºä»£ç å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œä»£ç åˆ†æ”¯ä¸ºï¼šmotionLayoutã€‚å–œæ¬¢çš„éº»çƒ¦ç‚¹ä¸ªğŸŒŸã€‚</p>
<p>æ¨èå­¦ä¹ ç½‘ç«™ï¼š<a href="https://codelabs.developers.google.com/codelabs/motion-layout/index.html?index=..%2F..index#0">CodeLab</a>ã€‚</p>
<p>æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">NASA</a> on <a href="https://unsplash.com/search/photos/nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ¥å­¦ä¸€æ³¢ Navigation]]></title>
        <id>https://cherrylover.github.io/post/lai-xue-yi-bo-navigation</id>
        <link href="https://cherrylover.github.io/post/lai-xue-yi-bo-navigation">
        </link>
        <updated>2019-06-29T07:57:02.000Z</updated>
        <summary type="html"><![CDATA[<p>Navigation æ˜¯ä¸€ä¸ªè°·æ­Œå®˜æ–¹æ¨å‡ºçš„ä¸€ä¸ªç”¨äº APP å†…éƒ¨ä¾¿æ·åˆ‡æ¢å†…å®¹ï¼ˆFragment æˆ– Activityï¼‰çš„åº“ã€‚ä»è€Œä½¿å¾— APP å†…çš„é¡µé¢è·³è½¬æ›´ç®€å•ã€‚</p>
<p>æˆ‘çŸ¥é“å®ƒçš„æ—¶å€™å®ƒçš„ç‰ˆæœ¬å·²ç»æ˜¯ 2.0.0 äº†ï¼Œä¹Ÿæ˜¯æ—¶å€™æ¥å­¦ä¹ ä¸€æ³¢äº†ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>Navigation æ˜¯ä¸€ä¸ªè°·æ­Œå®˜æ–¹æ¨å‡ºçš„ä¸€ä¸ªç”¨äº APP å†…éƒ¨ä¾¿æ·åˆ‡æ¢å†…å®¹ï¼ˆFragment æˆ– Activityï¼‰çš„åº“ã€‚ä»è€Œä½¿å¾— APP å†…çš„é¡µé¢è·³è½¬æ›´ç®€å•ã€‚</p>
<p>æˆ‘çŸ¥é“å®ƒçš„æ—¶å€™å®ƒçš„ç‰ˆæœ¬å·²ç»æ˜¯ 2.0.0 äº†ï¼Œä¹Ÿæ˜¯æ—¶å€™æ¥å­¦ä¹ ä¸€æ³¢äº†ã€‚</p>
<!-- more --> 
<p>æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œå­¦ä¹ çš„ç¬¬ä¸€æ‰‹èµ„æ–™ä¸èƒ½ç¼ºäº†å®˜æ–¹å‡ºå“çš„ <a href="https://codelabs.developers.google.com/codelabs/android-navigation/#0">CodeLab</a>ã€‚ç›¸ä¿¡ä½ ï¼Œçœ‹äº† CodeLab ä¹‹åå°±èƒ½å¯¹ Navigation æœ‰ä¸€ä¸ªç®€å•çš„äº†è§£ã€‚æœ¬äººä¹Ÿæ˜¯å¯¹ CodeLab å­¦ä¹ ä¹‹åæ‰å†™ä¸‹äº†è¿™ç¯‡åšå®¢ï¼Œä¸»è¦å†…å®¹éƒ½èƒ½åœ¨ CodeLab ä¸Šæ‰¾åˆ°ã€‚ä¸è¿‡ CodeLab é‡Œé¢æ˜¯è‹±æ–‡çš„è®²è§£ï¼Œè€Œä¸”å…¶ä¸­çš„ä»£ç æ˜¯ä½¿ç”¨ Kotlin ç¼–å†™çš„ï¼Œè¿™ç¯‡åšå®¢æ˜¯ä»¥ Java ä»£ç çš„æ–¹å¼è¿›è¡Œçš„ã€‚</p>
<p>è¿˜ä¸€ä»¶äº‹æƒ…ï¼ŒNavigation çš„åŸç”Ÿæ”¯æŒæ˜¯ä» Android Studio 3.3 å¼€å§‹çš„ï¼Œ3.2 ç‰ˆæœ¬çš„éœ€è¦åœ¨è®¾ç½®é¢æ¿çš„ Experimental æ¨¡å—ä¸­å¯ç”¨ Navigation ç¼–è¾‘å™¨ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628144412075.png" alt="image-20190628144412075"></p>
<blockquote>
<p>å›¾ç‰‡æ¥è‡ª CodeLabã€‚</p>
</blockquote>
<p>ä¸‹é¢å¼€å§‹æ­£é¢˜</p>
<h2 id="navigation-graph-å’Œ-navhostfragment">Navigation Graph å’Œ NavHostFragment</h2>
<p>é¦–å…ˆï¼Œæ·»åŠ ä¾èµ–ã€‚</p>
<pre><code>implementation 'androidx.navigation:navigation-fragment:2.0.0'
implementation 'androidx.navigation:navigation-ui:2.0.0'
</code></pre>
<p>ä¹‹åï¼Œåœ¨ res æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç±»å‹ä¸º navigation çš„èµ„æºæ–‡ä»¶å¤¹ï¼ŒAndroid Studio ä¼šè‡ªåŠ¨åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ç”Ÿäº§ä¸€ä¸ªåä¸º navigation.xml çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯ç”¨äºæè¿° Fragment åŠç›¸åº”çš„è·³è½¬é€»è¾‘ã€åŠ¨ç”»ã€å‚æ•°ç­‰ä¿¡æ¯ã€‚è¿™ä¸ªæ–‡ä»¶ä¹Ÿå«åš <strong>Navigation Graph</strong>ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628144907092.png" alt="create_navigation_folder"></p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
            android:id=&quot;@+id/navigation&quot;&gt;

&lt;/navigation&gt;
</code></pre>
<p>é»˜è®¤çš„ Navigation Graph æ–‡ä»¶å°±åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰æ›´å¤šçš„ Fragmentï¼Œæ·»åŠ è¿›æ¥ï¼Œä¼šæœ‰ä¸åŒçš„å­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹ä»£è¡¨çš„å°±æ˜¯ Fragmentï¼Œfragment èŠ‚ç‚¹ä¸­æè¿°å…³äº Fragment çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ fragment èŠ‚ç‚¹ä¸­è¿˜å¯ä»¥å…¶ä»–å­èŠ‚ç‚¹ï¼Œæ¯”å¦‚ï¼Œactionã€argumentã€deepLinkã€‚ä»–ä»¬åˆ†åˆ«ç”¨äºè¡¨ç¤º Fragment çš„ç›¸å…³ä¿¡æ¯ã€‚å¾€åä¼šè®²åˆ°çš„ã€‚ç°åœ¨æˆ‘ä»¬ç°åœ¨åˆ›å»ºä¸€ä¸ª Fragment ï¼Œå°±å« RootFragment å¥½äº†ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
             xmlns:tools=&quot;http://schemas.android.com/tools&quot;
             android:layout_width=&quot;match_parent&quot;
             android:layout_height=&quot;match_parent&quot;
             tools:context=&quot;.fragment.RootFragment&quot;&gt;
    &lt;TextView
            android:layout_gravity=&quot;center&quot;
            android:gravity=&quot;center&quot;
            android:layout_width=&quot;match_parent&quot;
            android:textSize=&quot;24sp&quot;
            android:layout_height=&quot;match_parent&quot;
            android:text=&quot;Root Fragment&quot;/&gt;

&lt;/FrameLayout&gt;
</code></pre>
<p>åªæ˜¯åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå‡ºè¿™ä¸ª Fragment çš„åå­—ï¼ŒJava ä»£ç ä¸­æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚ç°åœ¨è®©æˆ‘ä»¬å›åˆ° Navigation Graph ä¸­ï¼Œæˆ‘ä»¬æ˜¯åˆå­¦è€…ï¼Œä¸çŸ¥é“æˆ–è€…è¯´ä¸äº†è§£ Fragment èŠ‚ç‚¹æœ‰å“ªäº›å±æ€§å¯ä»¥å»ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ Navigation Graph çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œåˆšæ‰æˆ‘ä»¬çœ‹äº† Navigation Graph çš„ä»£ç ï¼Œç°åœ¨æ¥çœ‹ä¸€ä¸‹ï¼Œå›¾å½¢åŒ–ç¼–è¾‘é¡µé¢ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628150519705.png" alt="graph_design"></p>
<blockquote>
<p>å·¦è¾¹åŒºåŸŸï¼šæ˜¯å·²ç»æ·»åŠ è¿›æ¥çš„ Fragment ä»¥åŠæ‰¿è½½è¿™äº› Fragment çš„é¡µé¢ï¼›</p>
<p>ä¸­é—´åŒºåŸŸï¼šFragment çš„è·³è½¬ç¤ºæ„å›¾ï¼›</p>
<p>å³è¾¹åŒºåŸŸï¼šæ˜¯å½“å‰é€‰ä¸­çš„ Fragment çš„å±æ€§å±•ç¤ºåŒºï¼›</p>
</blockquote>
<p>é¡µé¢ä¸­é—´å·²ç»æç¤ºæˆ‘ä»¬äº†ï¼Œç‚¹å‡»é‚£ä¸ªå›¾æ ‡ï¼Œæ·»åŠ ä¸€ä¸ªç›®æ ‡ã€‚è¯•è¯•çœ‹å§ï¼Œä» Android Studio å±•ç¤ºå‡ºçš„åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ RootFragmentã€‚è¿™æ—¶ï¼Œé¡µé¢å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚æˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„ RootFragment çš„æ ·å­å·²ç»å‡ºç°äº†ï¼Œè€Œä¸”åç§°å‰è¿˜æœ‰ä¸€ä¸ªå°å›¾æ ‡ï¼Œè¿™è¡¨ç¤º RootFragment æ˜¯ Navigation ç®¡ç†é¡µé¢çš„ç¬¬ä¸€ä¸ªé¡µé¢ä¹Ÿæ˜¯å¼€å§‹é¡µé¢ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628150937246.png" alt="image-20190628150937246"></p>
<p>é¡µé¢å³ä¾§å‡ºç°äº†ä¸€äº›å±æ€§ï¼Œæˆ‘ä»¬æš‚æ—¶å¯ä»¥ä¸ç”¨ç®¡ï¼Œç°åœ¨æˆ‘åªæƒ³å…ˆè¿è¡Œèµ·æ¥ï¼Œçœ‹çœ‹æ•ˆæœã€‚ä¸è¿‡åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ”¹é€ ä¸€ä¸‹ï¼Œä¹‹å‰æ–°å»ºé¡¹ç›®è‡ªåŠ¨ç”Ÿæˆçš„ MainActivityã€‚å…ˆæ‰“å¼€ activity_main.xml çš„å›¾å½¢åŒ–ç¼–è¾‘é¡µé¢ï¼Œç„¶ååœ¨ Palette ç±»å‹åˆ—è¡¨ä¸­æ‰¾åˆ° <strong>NavHostFragment</strong> å¹¶æ‹–æ‹½åˆ°é¡µé¢ä¸Šï¼Œæ­¤æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œè®©ä½ é€‰æ‹© Navigation Graphï¼Œæˆ‘ä»¬é€‰æ‹©åˆšæ‰è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶å³å¯ã€‚</p>
<blockquote>
<p>Android Studio çš„å¸ƒå±€æ–‡ä»¶çš„æ‹–æ‹½ï¼Œä¸æ˜¯å¤ªå¥½ç”¨ï¼Œéœ€è¦æ‰‹åŠ¨åˆ‡æ¢åˆ°æºä»£ç å½¢å¼ï¼Œç®€å•æ”¹åŠ¨ä¸€ä¸‹é¡µé¢ä»£ç ï¼Œæˆ‘ä»¬è®©è¿™ä¸ª NavHostFrgament ç»„ä»¶å¡«å……æ»¡æ•´ä¸ªå®¹å™¨å³å¯ã€‚</p>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628151745388.png" alt="image-20190628151745388"></p>
<p>æœ€ç»ˆçš„ activity_main.xml çš„æºæ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.MainActivity&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/fragment&quot;
        android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        app:defaultNavHost=&quot;true&quot;
        app:navGraph=&quot;@navigation/navigation&quot; /&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>ç„¶åè¿è¡Œé¡¹ç›®å³å¯ã€‚è¿™å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ä½¿ç”¨ Navigation çš„ä¾‹å­ï¼Œè€Œä¸”å…¶ä¸­æ ¹æœ¬å°±æ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628161622969.png" alt="image-20190628161622969"></p>
<p>å¥½ï¼Œç°åœ¨æˆ‘ä»¬æ¥å›è¿‡å¤´æ¥çœ‹çœ‹ï¼Œåˆšåˆšæˆ‘ä»¬éƒ½åšä»€ä¹ˆã€‚æˆ‘ä»¬çœŸæ­£æœ‰æ•ˆçš„å†…å®¹æ˜¯ä»æŠŠ RootFragment æ·»åŠ åˆ° Navigation Graph ä¸­ï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹ï¼ŒNavigation Graph çš„æºä»£ç ã€‚è¯´ä¸å®šèƒ½ä»é‚£é‡Œå‘ç°ç‚¹ä»€ä¹ˆä¸œè¥¿ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/navigation&quot;
    app:startDestination=&quot;@id/rootFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/rootFragment&quot;
        android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
        android:label=&quot;fragment_root&quot;
        tools:layout=&quot;@layout/fragment_root&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>è¿™ä¸ªæ–‡ä»¶è·Ÿä¹‹å‰è‡ªåŠ¨ç”Ÿæˆçš„æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ— éå°±æ˜¯å¤šäº†ä¸€ä¸ª fragment èŠ‚ç‚¹ï¼Œä»¥åŠæ ¹èŠ‚ç‚¹ä¸Šå¤šäº†ä¸€ä¸ª startDestination å±æ€§ã€‚éš¾é“å°±æ˜¯å› ä¸ºè¿™ä¸ªå±æ€§ï¼Ÿæ˜¯çš„ï¼Œæ²¡é”™ï¼Œåœ¨ Navigation ä¸­æˆ‘ä»¬ä½¿ç”¨ Destination(ç›®æ ‡)æ¥æè¿° Fragment ä¹‹é—´çš„è·³è½¬å…³ç³»ã€‚è¿™é‡Œçš„ startDestination ä»£è¡¨çš„å°±æ˜¯è¿™ä¸ªæ˜¯ Navigation æ•´ä¸ªé¡µé¢è·³è½¬ç®¡ç†æ ˆçš„æœ€æ ¹çº§é¡µé¢ã€‚</p>
<p>å†æ¥çœ‹çœ‹é‚£ä¸ªæ·»åŠ åˆ° MainActivity é¡µé¢çš„ NavHostFragment ç»„ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ä¸­çš„ fragmen ç»„ä»¶ï¼Œè·Ÿæˆ‘ä»¬æ­£å¸¸ä½¿ç”¨çš„æ²¡ä»€ä¹ˆä¸åŒï¼Œéè¦è¯´ä¸åŒï¼Œé‚£å°±æ˜¯å…¶ä¸­çš„ nameã€defaultNavHost ä»¥åŠ navGraph è¿™ä¸‰ä¸ªå±æ€§äº†ã€‚</p>
<p>name å±æ€§æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒnavGraph å±æ€§é‡Œé¢çš„å€¼æ˜¯åˆšæ‰åˆ›å»º Navigation Graphï¼ŒçŒœä¸€ä¸‹ï¼Œå°±æ˜¯æŠŠ Navigation Graph å¼•ç”¨åˆ°äº†è¿™ä¸ª NavHostFragment ä¸­ã€‚é‚£æœ€åä¸€ä¸ª defaultNavHost å±æ€§å‘¢ï¼Ÿé‚£å°±æ˜¯æ‹¦æˆªç³»ç»Ÿè¿”å›æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶çš„ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/fragment&quot;
    android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    app:defaultNavHost=&quot;true&quot;
    app:navGraph=&quot;@navigation/navigation&quot; /&gt;
</code></pre>
<h2 id="navcontroller">NavController</h2>
<p>å•å•ä¸€ä¸ª Fragment æ²¡å•¥æ„æ€ï¼Œä¸å¥½ç©ï¼Œè¿™å›æˆ‘ä»¬å†åŠ ä¸€ä¸ªé¡µé¢(SettingsFragment)ã€‚å°è¯•ç€ä» RootFragment é¡µé¢ç‚¹å‡»æŒ‰é’®åˆ‡æ¢åˆ° SettingsFragment é¡µé¢ã€‚ç„¶ååœ¨ SettingsFragment é¡µé¢ç‚¹å‡»æŒ‰é’®è¿”å›åˆ° RootFragment é¡µé¢ã€‚</p>
<blockquote>
<p>è¯´æ˜¯ SettingsFragmentï¼Œé‡Œé¢å°±ä¸€ä¸ª Button ä¸€ä¸ª TextViewï¼Œå¸ƒå±€ä»£ç å°±ä¸è´´äº†ã€‚</p>
</blockquote>
<p>Fragment å‡†å¤‡å¥½äº†ï¼Œè¯¥å¾€ Navigation Graph é‡Œæ·»åŠ äº†ï¼ŒæŒ‰ç…§åˆšæ‰æ·»åŠ  RootFragment çš„æ–¹å¼å†æ¥ä¸€æ¬¡ï¼Œä¸è¿‡ï¼Œè¿™æ¬¡æ¯”ä¸Šæ¬¡å¤šä¸€æ­¥ã€‚é€‰ä¸­ RootFragmentï¼Œç‚¹å‡» RootFragment å³è¾¹çš„å°åœ†ç‚¹ç„¶åç‰µå¼•åˆ°å³ä¾§çš„ SettingsFragmentã€‚è¿™æ ·ä»–ä»¬ä¸¤ä¸ªå°±å»ºç«‹ä¸€ç§å…³ç³»ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628160038102.png" alt="image-20190628160038102"></p>
<p>æ¥çœ‹ä¸€ä¸‹æºä»£ç å§ã€‚æˆ‘ä»¬å‘ç°ï¼Œé™¤äº†å¢åŠ äº†ä¸€ä¸ª fragment èŠ‚ç‚¹ä¹‹å¤–ï¼ŒåŸæ¥çš„ RootFragment çš„èŠ‚ç‚¹ä¸Šè¿˜å¢åŠ äº†ä¸€ä¸ªå­èŠ‚ç‚¹ action ã€‚äº‹å®ä¸Šï¼Œaction èŠ‚ç‚¹å°±æ˜¯ç”¨æ¥æè¿° Fragmen ä¹‹é—´çš„é¡µé¢è·³è½¬çš„å…³ç³»çš„ï¼Œå…¶ä¸­ destination å±æ€§çš„å€¼å°±æ˜¯ç›®æ ‡ fragment çš„ idã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot; /&gt;

&lt;!--ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç --&gt;

&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot; &gt;
    &lt;action
        android:id=&quot;@+id/action_rootFragment_to_settingsFragment2&quot;
        app:destination=&quot;@id/settingsFragment&quot; /&gt;
&lt;/fragment&gt;
&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot; /&gt;
</code></pre>
<p>ç»§ç»­å¾€ä¸‹ï¼Œæˆ‘ä»¬ä¸º RootFragment é¡µé¢ç»‘å®šç‚¹å‡»äº‹ä»¶ã€‚</p>
<pre><code class="language-java">private void toSettings() {
    btnToSettings.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Navigation.findNavController(btnToSettings)
                    .navigate(R.id.action_rootFragment_to_settingsFragment);
        }
    });
}
</code></pre>
<p>è¿™ä¸€çœ‹å°±çŸ¥é“äº†ï¼Œé€šè¿‡ Navigation æ‰¾åˆ°ä¸€ä¸ªå« <strong>NavController</strong> çš„ä¸œè¥¿ï¼Œç„¶åæ‰§è¡Œ navigate æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢ä¼ çš„å€¼å°±æ˜¯åˆšæ‰ RootFragment å­èŠ‚ç‚¹ action çš„ id çš„å€¼ã€‚å…ˆè¿è¡Œä¸€ä¸‹çœ‹çœ‹æ•ˆæœã€‚</p>
<blockquote>
<ol>
<li>äº²æµ‹ç‚¹å‡»æŒ‰é’®èƒ½è·³è½¬åˆ° SettingsFragment é¡µé¢ã€‚ä¸‹é¢çš„ Gif åŠ¨å›¾åªæ˜¯è¡¨ç¤ºèƒ½ä» RootFragment åˆ° SettingsFragmentï¼Œé—ªå›åˆ° RootFragment é¡µé¢åªæ˜¯ Gif çš„é‡æ–°æ’­æ”¾ã€‚</li>
<li>å¦‚æœä½ åœ¨ SettingsFragment ç‚¹å‡»ç³»ç»Ÿçš„è¿”å›é”®ï¼Œæ˜¯èƒ½è¿”å›åˆ° RootFragmentã€‚è¿™å°±æ˜¯ MainActivity ä¸­ NavHostFragment ç»„ä»¶çš„å±æ€§ <code>app:defaultNavHost=&quot;true&quot;</code> èµ·åˆ°çš„ä½œç”¨ï¼Œæœ‰å…´è¶£çš„è¯ï¼Œå¯ä»¥æ”¹æˆ false ç„¶åå†è¯•ä¸€ä¸‹æ•ˆæœã€‚</li>
</ol>
</blockquote>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_toSettings.gif" alt=""></p>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†æ¬¡ä¸º SettingsFragment æ·»åŠ æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å§ã€‚</p>
<pre><code class="language-java">private void goBack() {
    btnToRoot.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Navigation.findNavController(btnToRoot)
                    .popBackStack();
        }
    });
}
</code></pre>
<p>å’Œä¹‹å‰è·³è½¬åˆ°è¿™ä¸ªé¡µé¢çš„æ–¹å¼å·®ä¸å¤šï¼Œåªæ˜¯æœ€åæ‰§è¡Œçš„æ–¹æ³•å˜æˆäº† <code>popBackStack</code> ã€‚</p>
<p>å—¯ï¼ŒæŒºå¥½çš„ï¼Œä¸è¿‡ï¼Œæˆ‘ä»¬æœ‰äº›æ—¶å€™éœ€è¦åœ¨ä¸¤ä¸ª Fragment ä¹‹é—´åšåˆ‡æ¢åŠ¨ç”»ï¼Œè¿™ä¸ªæ€ä¹ˆåŠï¼Ÿè¿™ä¸ªä¹Ÿä¸éš¾ï¼Œåœ¨Navigation Graph ä¸­è·³è½¬çš„ action å†…å¢åŠ å±æ€§å³å¯ã€‚å‘ï¼Œè¿™æ ·å°±è¡Œäº†ï¼Œè€Œä¸”è¿˜å¯ä»¥ç”¨è¿‡ Java ä»£ç æ¥å®ç°ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/rootFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.RootFragment&quot;
    android:label=&quot;fragment_root&quot;
    tools:layout=&quot;@layout/fragment_root&quot;&gt;
    &lt;action
        android:id=&quot;@+id/action_rootFragment_to_settingsFragment&quot;
        app:destination=&quot;@id/settingsFragment&quot;
        app:enterAnim=&quot;@anim/slide_in_right&quot;
        app:exitAnim=&quot;@anim/slide_out_left&quot;
        app:popEnterAnim=&quot;@anim/slide_in_left&quot;
        app:popExitAnim=&quot;@anim/slide_out_right&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<p>Java ä»£ç </p>
<pre><code class="language-java">Navigation.findNavController(btnToSettings)
    .navigate(R.id.action_rootFragment_to_settingsFragment);
//                ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç 

NavOptions options = new NavOptions.Builder()
    .setEnterAnim(R.anim.slide_in_right)
    .setExitAnim(R.anim.slide_out_left)
    .setPopEnterAnim(R.anim.slide_in_left)
    .setPopExitAnim(R.anim.slide_out_right)
    .build();

Navigation.findNavController(btnToSettings)
    .navigate(R.id.action_rootFragment_to_settingsFragment, null, options);
</code></pre>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬è°ƒç”¨äº† navigate è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°æ˜¯ Bundle ç±»å‹ï¼Œæˆ‘ä»¬å¡«å…¥äº† null</p>
<p>ï¼Œé‚£å¦‚æœæ­£å¸¸å¡«äº†å€¼ï¼ŒBundle æ˜¯ä¸æ˜¯å°±æ˜¯ä¼ é€’åˆ° SettingsFragment äº†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ä¸è¿‡ Navigation è¿˜æœ‰å¦ä¸€ç§æ–¹å¼æ¥ä¼ å€¼â€”â€” <strong>Safe Args</strong>ã€‚</p>
<h3 id="safe-args">Safe Args</h3>
<blockquote>
<p>ä¸ºå•¥è¦ç”¨ Safe Args å‘¢ï¼Ÿ</p>
<p>æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥å­¦ï¼Œæ„Ÿè§‰å¦‚æœå•çº¯ä¸ºäº†ä¿è¯ key å®‰å…¨çš„è¯ï¼ŒæŠŠ Bundle é‡Œé¢çš„ key æŠ½å–æˆå¸¸é‡å€¼ä¸ä¹Ÿè¡Œå—ï¼Ÿä¸å¤ªæ‡‚ä¸ºå•¥è¦é€šè¿‡è¿™ç§å½¢å¼æ¥åšï¼Œä¸è¿‡å‘¢ï¼Œè€è¯è¯´å¾—å¥½ï¼ŒæŠ€å¤šä¸å‹èº«ã€‚</p>
</blockquote>
<p>Safe Args æ˜¯é…åˆ Navigation ä½¿ç”¨çš„ä¸€ä¸ª Gradle æ’ä»¶ã€‚é¦–å…ˆä½ å¾—å…ˆå»é…ç½®ï¼š</p>
<p>é¦–å…ˆåœ¨ä½ é¡¹ç›®çš„æ ¹ç›®å½•çš„ build.gradle æ–‡ä»¶ä¸­åŠ ä¸Šè¿™äº›ä¸œè¥¿ï¼š</p>
<pre><code>repositories {
    google()
}
dependencies {
    classpath &quot;androidx.navigation:navigation-safe-args-gradle-plugin:2.0.0&quot;
}
</code></pre>
<p>ç„¶åè¿˜å¾—åœ¨ä½ çš„ app æˆ–æ˜¯ module çš„ç›®å½•ä¸‹çš„ build.gradle æ–‡ä»¶å¤¹åŠ å…¥ï¼š</p>
<pre><code>apply plugin: &quot;androidx.navigation.safeargs&quot;
</code></pre>
<p>å¦‚æœä½ æƒ³ç”¨ safe Args ç”Ÿæˆçš„ä»£ç æ—¶ Kotlin çš„è¯ï¼Œè¿˜éœ€è¦åŠ å…¥ï¼š</p>
<pre><code>aapply plugin: &quot;androidx.navigation.safeargs.kotlin&quot;
</code></pre>
<p>æœ€æœ€æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œä½ è¦ç¡®è®¤ä½ çš„ build.properties æ–‡ä»¶ä¸­æœ‰è¿™ä¹ˆä¸€è¡Œï¼š</p>
<pre><code class="language-java">android.useAndroidX=true
</code></pre>
<p>å½“ç„¶äº†ï¼Œå¦‚æœä½ çš„é¡¹ç›®æœ¬èº«å°±æ˜¯ç”¨æ˜¯ AndroidX çš„ä¾èµ–ï¼Œå°±ä¸ç”¨å»ç¡®è®¤äº†ï¼Œè‚¯å®šèƒ½é€šè¿‡çš„å˜›ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°±æ¥ä» RootFragmet ä¼ é€’ä¸€ä¸ªç±»å‹ä¸º String çš„å¤‡æ³¨ååˆ° SettingsFragmen å§ã€‚è¿˜æ˜¯å…ˆé€šè¿‡å›¾å½¢åŒ–ç•Œé¢è¿›è¡Œè®¾ç½®å§ï¼Œé€‰ä¸­ SettingsFragmentï¼Œç„¶åå†å³ä¾§å±æ€§é¢æ¿ä¸Šæ‰¾åˆ° Argments ç‚¹å‡»æ—è¾¹çš„â•ã€‚</p>
<p>å¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œæˆ‘ä»¬å¡«å…¥ä¸€ä¸‹ä¿¡æ¯ï¼Œç„¶åç‚¹å‡» addã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628191327486.png" alt="image-20190628191327486"></p>
<p>å®Œæˆä¹‹åçš„ Navigation Graph ä¸­ SettingsFragment èŠ‚ç‚¹çš„å†…å®¹å˜äº†ã€‚</p>
<pre><code class="language-xml">&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot;/&gt;

&lt;!--ä¸Šé¢æ˜¯åŸæ¥çš„ä»£ç ï¼Œä¸‹é¢æ˜¯æ–°ä»£ç --&gt;

&lt;fragment
    android:id=&quot;@+id/settingsFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.SettingsFragment&quot;
    android:label=&quot;SettingsFragment&quot;&gt;
    &lt;argument
        android:name=&quot;nickName&quot;
        android:defaultValue=&quot;æœªè®¾ç½®&quot;
        app:argType=&quot;string&quot;
        app:nullable=&quot;true&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<blockquote>
<p>è¿™ä¸ªæ—¶å€™ï¼ŒGradle ä¼šè‡ªåŠ¨ç”Ÿæˆ SettingFragmentArgs ä»¥åŠ RootFragmentDirections è¿™ä¸¤ä¸ªç±»ï¼Œåœ¨ generatedJava è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„åŒ…å†…ã€‚å¦‚æœæ²¡æœ‰è‡ªåŠ¨ç”Ÿæˆçš„è¯ï¼Œclean ä¸€ä¸‹æˆ–æ˜¯ rebuild é¡¹ç›®éƒ½è¡Œã€‚</p>
</blockquote>
<p>ç°åœ¨å°±èƒ½ç›´æ¥é€šè¿‡ setNickName çš„å½¢å¼æ¥è®¾ç½®å¾…ä¼ é€’çš„å€¼äº†ã€‚</p>
<pre><code class="language-java">String nickName = &quot;master&quot;;
RootFragmentDirections.ActionRootFragmentToSettingsFragment action =
        RootFragmentDirections.actionRootFragmentToSettingsFragment().setNickName(nickName);

Navigation.findNavController(btnToSettings)
        .navigate(action);
</code></pre>
<p>åœ¨ SettingsFragment æˆ‘ä»¬éœ€è¦æŠŠå€¼å–å‡ºæ¥ï¼Œç„¶åæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p>
<pre><code class="language-java">String nickName = SettingsFragmentArgs.fromBundle(getArguments()).getNickName();
tvNickName.setText(nickName);
</code></pre>
<p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œè¿™æ¯”ä¹‹å‰æˆ‘ä»¬ç”¨ Bundle ä¼ å€¼è¦æ–¹ä¾¿çš„å¤šå•¦ï¼Œè€Œä¸”å†ä¹Ÿä¸ç”¨æ‹…å¿ƒ Key å†™é”™çš„é—®é¢˜äº†ã€‚çœŸé¦™ã€‚</p>
<p>å¥½äº†ï¼ŒNavigation çš„åŸºæœ¬å­¦ä¹ å°±åˆ°è¿™äº†ï¼Œæ„Ÿè§‰çœŸçš„æŒºä¸é”™çš„ã€‚å¯ä»¥è€ƒè™‘ç”¨ç”¨äº†ï¼Œä¸è¿‡ç°åœ¨å¥½åƒä¸»é¡µé¢éƒ½æ˜¯å››ä¸ªæˆ–æ˜¯äº”ä¸ª Tab é¡µé¢ï¼Œè¿™ç”¨ Navigation æ€ä¹ˆå®ç°å‘€ï¼ŸGoogle æ—©å°±æ›¿æˆ‘ä»¬æƒ³å¥½äº†ã€‚</p>
<h2 id="bottomnavigationview">BottomNavigationView</h2>
<p>æ¥ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª Activityï¼Œç„¶åæ‰“å¼€å¸ƒå±€æ–‡ä»¶çš„å›¾å½¢åŒ–å·¥å…·é¡µé¢ï¼Œç”¨ä¹‹å‰æˆ‘ä»¬æ·»åŠ  NavHostFragment ç»„ä»¶çš„æ–¹å¼æ¥æ·»åŠ ä¸€ä¸ª BottomNavigationViewï¼Œç„¶åè®©è¿™ä¸ªç»„ä»¶ä½äºæ•´ä¸ªé¡µé¢çš„åº•éƒ¨ã€‚é¡µé¢çš„å…¶ä½™éƒ¨åˆ†å…¨éƒ¨éƒ½ç•™ç»™ NavHostFragmentã€‚å› ä¸ºæˆ‘ä»¬åˆå¼•å…¥äº†ä¸€ä¸ªæ–°çš„ Fragment ç®¡ç†æ ˆï¼Œæ‰€ä»¥ï¼Œéœ€è¦å†æ¬¡æ–°å»ºä¸€ä¸ª Navigation Graph æ–‡ä»¶ tab_navigationã€‚</p>
<p>ä¸‹é¢å°±æ˜¯ activity_tab.xml ä»¥åŠ tab_navigation.xml çš„ä»£ç ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    tools:context=&quot;.TabActivity&quot;&gt;

    &lt;com.google.android.material.bottomnavigation.BottomNavigationView
        android:id=&quot;@+id/nv_bottom_menu&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;48dp&quot;
        app:itemHorizontalTranslationEnabled=&quot;false&quot;
        app:layout_constraintBottom_toBottomOf=&quot;parent&quot; /&gt;

    &lt;fragment
        android:id=&quot;@+id/fragment3&quot;
        android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;0dp&quot;
        app:defaultNavHost=&quot;true&quot;
        app:layout_constraintBottom_toTopOf=&quot;@+id/nv_bottom_menu&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:navGraph=&quot;@navigation/tab_navigation&quot; /&gt;
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;

&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android:id=&quot;@+id/tab_navigation&quot;&gt;

&lt;/navigation&gt;
</code></pre>
<p>æ¥ä¸‹æ¥å¹²ä»€ä¹ˆå‘¢ï¼Ÿåˆšæ‰æˆ‘ä»¬åˆ›å»ºæ˜¯å®¹å™¨ï¼Œç”¨äºå®¹çº³ Fragment çš„ï¼Œç°åœ¨æ¥åˆ›å»ºä¸‰ä¸ª Fragmentï¼Œè¿™ä¸‰ä¸ª Fragment æ˜¯ç”¨äºå¡«å……è¿›å®¹å™¨çš„å†…å®¹ã€‚</p>
<p>åˆ†åˆ«æ˜¯ FeedFragmentã€TimerFragmentã€MineFragmentã€‚è¿™ä¸‰ä¸ª Fragment æˆ‘ä»¬è¿˜æ˜¯åˆ†åˆ«æ˜¾ç¤ºè‡ªå·±çš„åç§°ã€‚å¸ƒå±€æ–‡ä»¶é‡Œä¹Ÿå°±ä¸€ä¸ª TextViewï¼ŒJava ä»£ç ä¸­ä»€ä¹ˆä¹Ÿä¸åšï¼Œä»…ä»…æ˜¯ç”¨æ¥æ˜¾ç¤ºã€‚</p>
<p>æœ‰äº†ä¸‰ä¸ª Fragmentï¼Œæˆ‘ä»¬ç°åœ¨å» tab_navigation æŠŠè¿™ä¸‰ä¸ª Fragment éƒ½æ·»åŠ è¿›å»ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/tab_navigation&quot;
    app:startDestination=&quot;@id/feedFragment&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/feedFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.FeedFragment&quot;
        android:label=&quot;fragment_feed&quot;
        tools:layout=&quot;@layout/fragment_feed&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/timerFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.TimerFragment&quot;
        android:label=&quot;fragment_timer&quot;
        tools:layout=&quot;@layout/fragment_timer&quot; /&gt;
    &lt;fragment
        android:id=&quot;@+id/mineFragment&quot;
        android:name=&quot;me.monster.blogtest.tab.MineFragment&quot;
        android:label=&quot;fragment_mine&quot;
        tools:layout=&quot;@layout/fragment_mine&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å®¹å™¨æœ‰äº†ï¼Œå†…å®¹æœ‰äº†ï¼Œåªå·®ä¸€ä¸ªåª’ä»‹ï¼ŒæŠŠå®ƒä»¬è¿›è¡Œå…³è”äº†ã€‚æ‰“å¼€ activity_tab çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œåœ¨å·¦ä¾§æœ‰ä¸€äº›å±æ€§ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§æ˜¯ menuã€‚menuï¼Ÿå°±æ˜¯é‚£ä¸ªç»å¸¸ç”¨äºé¡µé¢å³ä¸Šè§’çš„ menuï¼Ÿå®ƒæ€ä¹ˆä¼šå‡ºç°åœ¨è¿™è¾¹ï¼Ÿç‚¹å‡» menu è¡Œæœ€å³è¾¹çš„æŒ‰é’®ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190628235937692.png" alt="image-20190628235937692"></p>
<p>å¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå¥½åƒå’Œä¸€å¼€å§‹åˆ›å»º NavHostFragment æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯ï¼Œå½“æ—¶æœ‰å¾…é€‰æ‹©çš„ Navigation Graph æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬æ²¡æœ‰ menu æ–‡ä»¶ï¼Œé‚£å°±åˆ›å»ºä¸€ä¸ªå§ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629000519557.png" alt="image-20190629000519557"></p>
<p>ç°åœ¨æˆ‘ä»¬ä¹Ÿæœ‰äº† menu æ–‡ä»¶ã€‚</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;

    &lt;item
        android:id=&quot;@+id/feedFragment&quot;
        android:icon=&quot;@drawable/ic_tab_feed&quot;
        android:title=&quot;Feed&quot; /&gt;
    &lt;item
        android:id=&quot;@+id/timerFragment&quot;
        android:icon=&quot;@drawable/ic_tab_timer&quot;
        android:title=&quot;Timer&quot; /&gt;
    &lt;item
        android:id=&quot;@+id/mineFragment&quot;
        android:icon=&quot;@drawable/ic_tab_mine&quot;
        android:title=&quot;Mine&quot; /&gt;
&lt;/menu&gt;
</code></pre>
<p>ç°åœ¨å†å›å»çœ‹ tab_activity.xml å‘ç° preview å·²ç»å˜æˆäº†è¿™æ ·çš„ã€‚Cool</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629110347302.png" alt="image-20190629110347302"></p>
<p>éš¾é“ Menu å°±æ˜¯é‚£ä¸ªæŠŠå†…å®¹ (Fragment) ä¸å®¹å™¨ (NavHostFragment) è¿›è¡Œå»ºç«‹å…³ç³»çš„åª’ä»‹ï¼Ÿæ˜¯ä¹Ÿä¸æ˜¯ï¼Œæœ‰é‚£ä¹ˆä¸€ç‚¹å…³ç³»ï¼Œä¸è¿‡ä¸å¤ªå‡†ç¡®ã€‚è¿˜è®°å¾—ä¹‹å‰æˆ‘ä»¬ç”¨ä¸ RootFragment å’Œ SettingsFragment è¿›è¡Œåˆ‡æ¢é¡µé¢çš„æ–¹å¼å—ï¼Ÿä¸€ä¸ªæ˜¯å‰è¿›åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œä¸€ä¸ªæ˜¯è¿”å›ä¸Šä¸€ä¸ªé¡µé¢ï¼Œè™½ç„¶æœ€ç»ˆçš„è¡Œä¸ºä¸åŒï¼Œä½†æ˜¯å®ƒä»¬éƒ½ä½¿ç”¨åˆ°äº†ä¸€ä¸ªå« <strong>NavController</strong> çš„ç±»ï¼Œè¿™ä¸ªç±»å®é™…ä¸Šå°±æ˜¯å®ç°åœ¨ Fragment ä¹‹é—´è¿›è¡Œè·³è½¬çš„ç±»ã€‚</p>
<pre><code class="language-java">Navigation.findNavController(btnToSettings).navigate(action);
Navigation.findNavController(btnToRoot).popBackStack();
</code></pre>
<p>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ Navigation Controller å¹¶ç»“åˆåº•éƒ¨å¯¼èˆªèœå•çš„ç‚¹å‡»äº‹ä»¶æ¥å¯¹ Fragment è¿›è¡Œæ§åˆ¶ï¼Œä»è€Œå®ç° Fragment ä¹‹é—´çš„åˆ‡æ¢ï¼Ÿæ˜¯è¿™æ ·çš„ï¼Œæ²¡é”™ï¼Œä¸è¿‡ Google å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†å¾ˆå¤šå¤æ‚çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ TabActivity ä¸­æ·»åŠ ä¸‹é¢è¿™äº›ä»£ç å³å¯ã€‚</p>
<pre><code class="language-java">private void setUpNavBottom() {
    NavHostFragment hostFragment = (NavHostFragment) getSupportFragmentManager()
        .findFragmentById(R.id.fragment3);
    BottomNavigationView navMenu = findViewById(R.id.nv_bottom_menu);
    if (hostFragment != null) {
        NavController navController = hostFragment.getNavController();
        NavigationUI.setupWithNavController(navMenu, navController);
    }
}
</code></pre>
<p>ç¬¬ä¸€è¡Œï¼ŒfindFragmentById é‡Œå¡«å†™çš„ id å°±æ˜¯æˆ‘ä»¬åœ¨ tab_activity.xml ä¸­ name å±æ€§æ˜¯ NavHostFragment èŠ‚ç‚¹çš„ idã€‚</p>
<p>ç„¶åå†é€šè¿‡ <code>NavigationUI.setupWithNavController()</code> å°†äºŒè€…è¿›è¡Œæƒ³ç®¡ç†ï¼Œè¿™æ ·åªè¦æˆ‘ä»¬ç‚¹å‡»åº•éƒ¨å¯¼èˆªèœå•å°±æ˜¯è‡ªåŠ¨å®ç° Fragment çš„ä¹‹é—´çš„åˆ‡æ¢ï¼Œå®Œå…¨ä¸éœ€è¦å¼€å‘è€…è‡ªå·±å»å†™é‚£ä¹ˆæ§åˆ¶é€»è¾‘ã€‚äº‹å®ä¸Šï¼Œ<code>NavigationUI.setupWithNavController()</code> è¿™ä¸ªæ–¹æ³•æœ‰å¾ˆå¤šé‡è½½æ–¹æ³•ï¼Œä¸ä»…ä»…åªæ˜¯ç”¨åœ¨ BottomNavigationViewï¼Œè¿˜æœ‰ NavigationView ç­‰ï¼Œåœ¨è¿™é‡Œå°±ä¸ä¸€ä¸€ä»‹ç»äº†æ„Ÿå…´è¶£çš„å¯ä»¥å»è¯•è¯•ã€‚ç°åœ¨æ¥çœ‹çœ‹æ•ˆæœã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_bottomNav-1779718.gif" alt="Blognav_bottomNav"></p>
<h2 id="deeplink">DeepLink</h2>
<p>æ¥æ¥æ¥ï¼Œå›é¡¾ä¸€ä¸‹åˆšæ‰æˆ‘ä»¬ä»‹ç»çš„ Navigation Graphï¼Œå®ƒå°±æ˜¯ç”¨äºæè¿° Fragment æˆ–è€…è¯´ç”¨äºæè¿°å†…å®¹ä¿¡æ¯çš„ï¼Œåˆšæ‰æˆ‘ä»¬å°è¯•äº†å­èŠ‚ç‚¹ Fragment çš„ actionï¼ˆé¡µé¢è·³è½¬ï¼‰ä¸ argumentsï¼ˆBundle ä¼ å€¼ï¼‰èŠ‚ç‚¹ï¼Œå…¶å®ä»–è¿˜æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ deepLinkã€‚</p>
<p>ä¸çŸ¥é“ï¼Œä½ æœ‰æ²¡æœ‰é‡åˆ°é‚£ç§æƒ…å†µï¼Œæœ‹å‹åœ¨å¾®ä¿¡ä¸Šåˆ†äº«ä½ ä¸€ä¸ªè¿æ¥ï¼Œä½ ä¸€ç‚¹å¼€ï¼Œé¡µé¢ä¸Šæç¤ºä½ ä½¿ç”¨å¾®ä¿¡çš„åœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œä½ åœ¨ä¸€ç‚¹å¼€å‘ç°ï¼Œå‘ç°è·³è½¬åˆ°äº†ä¸€ä¸ªåº”ç”¨çš„é¡µé¢ä¸Šå»äº†ã€‚è¿™ç§è·³è½¬æ–¹å¼åœ¨ Navigation è¿™ä¸ªå¯¼èˆªæ¡†æ¶å†…å«åš deepLinkã€‚è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹å§ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª Fragmentï¼Œå°±å« DeepLinkFragment å¥½äº†ï¼Œè¿™ä¸ªé¡µé¢æˆ‘ä»¬è·Ÿä¹‹å‰çš„ Fragment ä¸€æ ·åªæ˜¾ç¤º DeepLinkFragment è¿™ä¸ªæ–‡å­—å¥½äº†ã€‚layout å¸ƒå±€æ–‡ä»¶åŠ Java ä»£ç å°±ä¸è´´äº†ã€‚ç°åœ¨å†æ¥çœ‹ Navigation Graph ä¸­æ€ä¹ˆå†™ã€‚</p>
<pre><code class="language-xml">fragment
    android:id=&quot;@+id/deepLinkFragment&quot;
    android:name=&quot;me.monster.blogtest.fragment.DeepLinkFragment&quot;
    android:label=&quot;fragment_deep&quot;
    tools:layout=&quot;@layout/fragment_deep&quot; &gt;
    &lt;deepLink
        android:id=&quot;@+id/deepLink&quot;
        app:uri=&quot;www.example.com/{myarg}&quot; /&gt;
&lt;/fragment&gt;
</code></pre>
<p>æ˜¯çš„ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼Œåœ¨ Navigation Graph ä¸­å°±å¤šäº†è¿™ä¹ˆç‚¹ä¸œè¥¿ï¼Œç„¶åè®°å¾—ä¸€å®šè¦è®°å¾—åœ¨ manifest çš„æ‰¿è½½ DeepLinkFragment çš„ Activity èŠ‚ç‚¹å†…å¼•å…¥ä½ çš„ Navigation Graphã€‚</p>
<blockquote>
<ol>
<li>é‚£é‡Œå¡«çš„ url åé¢å¤§æ‹¬å·åŒ…è£¹ç€çš„æ˜¯ä¼ å…¥ DeepLinkFragment çš„å€¼ï¼Œ<code>myarg</code> æ˜¯ keyï¼Œé€šè¿‡ Bundle è¿›è¡Œä¼ é€’ï¼›</li>
<li>æˆ‘åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œæœ‰ä¸¤ä¸ª Navigation Graph æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ç”¨äº RootFragment ä¸ SettingsFragment è¿›è¡Œè·³è½¬çš„ navigation.xmlï¼Œä¸€ä¸ªæ˜¯ç”¨äºåº•éƒ¨å¯¼èˆªèœå•æ çš„ tab_navigation.xmlï¼Œæˆ‘æŠŠ DeepLinkFragment æ”¾åœ¨äº† navigation.xml ä¸­ï¼Œæ‰€ä»¥ä¸‹é¢çš„å€¼æ˜¯ @navigation/navigationã€‚</li>
</ol>
</blockquote>
<pre><code class="language-xml">&lt;nav-graph android:value=&quot;@navigation/navigation&quot; /&gt;
</code></pre>
<p>æ¥è¯•ä¸€ä¸‹ï¼Œçœ‹çœ‹æ•ˆæœå§ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/Blognav_deepLink.gif" alt="Blognav_deepLink"></p>
<p>å¥½äº†ï¼Œæˆ‘ä»¬æ•´ä¸ª Navigation çš„å­¦ä¹ åˆ°è¿™é‡Œä¹Ÿå‘Šä¸€æ®µè½äº†ï¼Œç»“æŸä¹‹å‰è®©æˆ‘ä»¬ç”¨ä¸€å¹…å›¾æ¥å›é¡¾ä¸€ä¸‹ Navigationã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190629150736867.png" alt="image-20190629150736867"></p>
<p>æœ¬æ–‡é¦–å‘äº<a href="https://jiangjiwei.site/">ä¸ªäººåšå®¢</a>ï¼Œæ–‡ä¸­å…¨éƒ¨æºä»£ç å·²ä¸Šä¼ è‡³ <a href="https://github.com/CherryLover/BlogTest">GitHub</a>ï¼Œå–œæ¬¢çš„éº»çƒ¦ç‚¹ä¸ªğŸŒŸã€‚<br>
æœ¬æ–‡å°é¢å›¾ï¼šPhoto by <a href="https://unsplash.com/@jbcreate_?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Joseph Barrientos</a> on <a href="https://unsplash.com/search/photos/navigation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Java æ³›å‹]]></title>
        <id>https://cherrylover.github.io/post/java-fan-xing</id>
        <link href="https://cherrylover.github.io/post/java-fan-xing">
        </link>
        <updated>2019-06-27T11:04:17.000Z</updated>
        <summary type="html"><![CDATA[<p>æ³›å‹ï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œä½¿ç”¨æœ€å¹¿æ³›çš„å°±æ˜¯é›†åˆåŠ Map ä¸­ï¼Œä¸€ç›´ä»¥æ¥ä¹Ÿæ²¡è®¤çœŸæƒ³è¿‡æ³›å‹ï¼Œç°åœ¨å‡†å¤‡æ¥å­¦ä¸€ä¸‹æ³›å‹ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æ³›å‹ï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œä½¿ç”¨æœ€å¹¿æ³›çš„å°±æ˜¯é›†åˆåŠ Map ä¸­ï¼Œä¸€ç›´ä»¥æ¥ä¹Ÿæ²¡è®¤çœŸæƒ³è¿‡æ³›å‹ï¼Œç°åœ¨å‡†å¤‡æ¥å­¦ä¸€ä¸‹æ³›å‹ã€‚</p>
<!-- more --> 
<p>æ¥ï¼Œå…ˆä»æœ€ç®€å•çš„å¼€å§‹ï¼Œä¸€ä¸ªå…ƒç´ å…¨éƒ¨ä¸º String çš„é›†åˆå¼€å§‹ã€‚</p>
<pre><code class="language-java">ArrayList&lt;String&gt; nameList = new ArrayList&lt;&gt;();
nameList.add(&quot;å¼ ä¸‰&quot;);
nameList.add(&quot;æå››&quot;);
nameList.add(&quot;ç‹äº”&quot;);
System.out.println(nameList.toString());
</code></pre>
<p>æˆ‘ä»¬ä¸€è¡Œä¸€è¡Œçœ‹ä»£ç ï¼Œç¬¬ä¸€è¡Œï¼Œæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ³›å‹ç±»å‹ä¸º String çš„ ArrayList å¯¹è±¡ï¼Œå¾€ä¸‹ä¸‰è¡Œåˆ†åˆ«å‘ nameList ä¸­æ·»åŠ ä¸‰ä¸ªå…ƒç´ ï¼Œæœ€åè¿›è¡Œæ‰“å°ã€‚</p>
<blockquote>
<ol>
<li><code>new ArrayList&lt;&gt;();</code> è¿™ç§å†™æ³•æ˜¯åœ¨ Java 1.7 åŠå…¶ä¹‹åæ‰æœ‰çš„ï¼Œåœ¨ Java ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œéœ€è¦åœ¨ <code>&lt;&gt;</code> å†…æŒ‡å®šå‡ºå…·ä½“çš„æ³›å‹ç±»å‹ï¼Œå¦‚ï¼š<code>new ArrayList&lt;String&gt;();</code> ç®€å†™æ˜¯å› ä¸ºåšäº†ç±»å‹æ¨æ–­ã€‚</li>
<li>å®é™…çš„ Android å¼€å‘ä¸­ï¼Œæœ€å¥½è¿˜æ˜¯åˆ«ç”¨ <code>System.out.println();</code>ï¼Œè¿™é‡Œåªæ˜¯ä¸ªäººå­¦ä¹  Demo æ‰è¿™ä¹ˆå†™ã€‚</li>
</ol>
</blockquote>
<p>è¾“å‡ºå†…å®¹:</p>
<pre><code>[å¼ ä¸‰, æå››, ç‹äº”]
</code></pre>
<p>æ¥ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è‡ªå·±åˆ›å»ºä¸€ä¸ªæ³›å‹å‡ºæ¥ã€‚ä¸ºä»€ä¹ˆåˆ›å»ºæ³›å‹å‘¢ï¼Ÿæˆ–è€…è¯´æˆ‘ä»¬åˆ›å»ºä»€ä¹ˆæ³›å‹å‘¢ï¼Ÿå®é™…ä¸Šæ³›å‹å¯ä»¥ä½œç”¨äºç±»ã€æ¥å£æˆ–æ˜¯æ–¹æ³•(å‡½æ•°)ã€‚</p>
<p>æ³›å‹ç±»</p>
<pre><code class="language-java">   public class Rep&lt;T&gt; {
       private int code;
       private String message;
       private T result;
   }
</code></pre>
<p>è¿™æ ·çš„ç»“æ„åº”è¯¥ä¸ä¼šé™Œç”Ÿï¼ŒæœåŠ¡ç«¯åœ¨è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ®å°±æ˜¯æŒ‰ç…§è¿™ç§å½¢å¼è¿›è¡Œç»„è£…çš„ï¼Œå…¶ä¸­ result å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„ä»»ä½•å€¼ï¼Œæ—¢æœ‰å¯èƒ½æ˜¯ boolean ç±»å‹çš„ falseï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ List ç±»å‹çš„é›†åˆã€‚</p>
<blockquote>
<p>å®é™…åº”è¯¥è¿˜æœ‰å…¶ä»–çš„å†…å®¹ï¼Œå¦‚ get ã€set æ–¹æ³•ç­‰ï¼Œæ­¤å¤„ç•¥è¿‡ã€‚</p>
</blockquote>
<p>æ³›å‹æ¥å£</p>
<pre><code class="language-java">   public interface Shop&lt;T&gt; {
     T buy();
   
     int back(T product);
   }
</code></pre>
<p>å®šä¹‰äº†ä¸€ä¸ªæ³›å‹çš„æ¥å£ï¼Œå†…éƒ¨åŒ…å«ä¸¤ä¸ªæ²¡æœ‰æ–¹æ³•ä½“çš„æ–¹æ³•ã€‚ä¸€ä¸ªçš„è¿”å›å€¼æ˜¯æ³›å‹ç±»å‹ T ï¼Œè¡¨ç¤ºä¹°äº†ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼›ä¸€ä¸ªçš„å‚æ•°æ˜¯æ³›å‹ç±»å‹ Tï¼Œè¡¨ç¤ºä¸€ä¸ªä»€ä¹ˆä¸œè¥¿é€€è´§é€€å¤šå°‘é’±ã€‚è¿™é‡Œçš„ <code>ä»€ä¹ˆä¸œè¥¿</code> å°±æ˜¯æ³›å‹ç±»å‹ Tã€‚</p>
<p>æ³›å‹æ–¹æ³•</p>
<pre><code class="language-java">   public T getResult() {
     return result;
   }
   
   public void setResult(T result) {
     this.result = result;
   }
</code></pre>
<p>è¿™ä¸¤ä¸ªæ³›å‹æ–¹æ³•å°±æ˜¯ç®€å•çš„å°†æ³›å‹ç±»ä¸­çš„ result è¿™ä¸ªæˆå‘˜å˜é‡è¿›è¡Œèµ‹å€¼å’Œè¿”å›ã€‚</p>
<p>è¿™å¥½åƒæ²¡ä»€ä¹ˆå®é™…æ„ä¹‰ï¼Œæ¥ç‚¹æœ‰æ„æ€çš„ä¸œè¥¿ã€‚åˆšæ‰æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª Shop çš„æ³›å‹æ¥å£ï¼Œç°åœ¨æˆ‘ä»¬å†æ¥åˆ›å»ºä¸€ä¸ªå– Apple çš„åº—(AppleShopï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ª Apple çš„ç±»ï¼Œå…¶æ¬¡éœ€è¦ä¸€ä¸ªå®ç° Shop æ¥å£çš„ AppleShop ç±»ã€‚</p>
<pre><code class="language-java">public class Apple {}

public class AppleShop implements Shop {
    @Override
    public Object buy() {
        return null;
    }

    @Override
    public int back(Object product) {
        return 0;
    }
}
</code></pre>
<p>å”‰ï¼Œå¥½åƒæœ‰ç‚¹ä¸å¯¹äº†ï¼ŒAppleShop é‡Œé¢çš„ <code>buy()</code> ä¸ºä»€ä¹ˆè¿”å›çš„ä¸æ˜¯ Apple å¯¹è±¡è¿˜æœ‰é‚£ä¸ª <code>back</code>æ–¹æ³•ä¸ºä»€ä¹ˆå‚æ•°ä¹Ÿæˆäº† Object è€Œä¸æ˜¯ Apple ï¼Ÿ</p>
<p>åŸå› åœ¨ä¸ï¼š<code>class AppleShop implements Shop</code> å‡†ç¡®çš„æ¥è¯´æ˜¯åœ¨äº <code>implements Shop</code> ï¼Œåœ¨å®ç°æ³›å‹æ¥å£æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šå…·ä½“çš„æ³›å‹ç±»å‹ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯ Appleï¼‰æ—¶ï¼Œè·Ÿå®ç°æ¥å£æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œåªæ˜¯å…¶ä¸­çš„æ³›å‹æ–¹æ³•çš„è¿”å›å€¼ã€å‚æ•°å…¨å˜æˆäº† Objectã€‚</p>
<p>ä¸Šé¢çš„ AppleShop ç±»ç›¸å½“äºå®ç°äº†ä¸‹é¢è¿™ä¸ªæ¥å£ã€‚</p>
<pre><code class="language-java">public interface Shop {
    Object buy();

    int back(Object product);
}
</code></pre>
<p>é‚£æˆ‘æƒ³è®©ä»–å®ç°æˆ‘æƒ³è¦çš„ Apple ç±»å‹çš„æ€ä¹ˆåšå‘¢ï¼Ÿåœ¨å®ç°ç±»çš„ç±»åå <code>&lt;ç±»å‹åç§°&gt;</code> å³å¯ã€‚AppleShop çš„æ­£ç¡®å†™æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-java">public class AppleShop implements Shop&lt;Apple&gt; {
    @Override
    public Apple buy() {
        return new Apple();
    }

    @Override
    public int back(Apple product) {
        return 1;
    }
}
</code></pre>
<p>å…¶ä¸­ï¼Œbuy æ–¹æ³•ç›´æ¥è¿”å›ä¸€ä¸ª Apple å¯¹è±¡ï¼Œback æ–¹æ³•è¿”å› 1 å…ƒã€‚</p>
<p>ç°åœ¨åˆæœ‰ä¸€å®¶åº—æ—¢èƒ½ä¹°ä¸œè¥¿ï¼Œåˆèƒ½ä¿®ä¸œè¥¿ï¼Œå®ƒå¾—å…ˆç»§æ‰¿ Shopï¼Œæˆ‘è¿™å›çŸ¥é“äº†ï¼Œå°±è¿™ä¹ˆå†™å°±è¡Œã€‚</p>
<pre><code class="language-java">public interface Repairableable extends Shop&lt;T&gt;{
    
}
</code></pre>
<p>å”‰ï¼Œä¸å¯¹ï¼Œå’‹æŠ¥é”™å‘¢ï¼Ÿ</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/image-20190627171053335.png" alt="image-20190627171053335"></p>
<p>å› ä¸ºè¿™é‡Œçš„ T æ˜¯ä¸å­˜åœ¨çš„ã€‚ä¸å­˜åœ¨ï¼Ÿå’‹ä¸å­˜åœ¨ï¼Œåˆšæ‰ä¸æ˜¯åœ¨ Shop è¿™ä¸ªæ¥å£é‡Œé¢éƒ½å†™äº†å—ï¼Ÿæ€ä¹ˆè¿˜æ˜¯ä¸å­˜åœ¨ï¼Ÿä¸ºä»€ä¹ˆå‘€ã€‚ä¸å­˜åœ¨ï¼Ÿäººå®¶éƒ½æ˜¯é‚£ä¹ˆç”¨ T è¿™ä¸ªå…³é”®å­—ï¼Œäººå®¶éƒ½ä¸é”™ï¼Œæˆ‘é”™äº†ï¼Ÿå†·é™ä¸‹æ¥æƒ³æƒ³ï¼ŒShop æ¥å£ä¸­é‚£ä¸ª T æ˜¯ç”¨ <code>&lt;&gt;</code> åŒ…è£¹ç€ç„¶åç´§è·Ÿç€æ¥å£åï¼Œæˆ‘ä¹Ÿè¯•è¯•ã€‚</p>
<pre><code class="language-java">public interface Repairableable&lt;T&gt; extends Shop&lt;T&gt;{

}
</code></pre>
<p>å“ï¼Œå¯¹äº†ï¼Œä¸æŠ¥é”™äº†ï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</p>
<p>é¦–å…ˆï¼ŒT ä¸æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œä¸æ˜¯å› ä¸º T æ‰è®©ä¸€ä¸ªå€Ÿå£å˜æˆæ³›å‹æ¥å£ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªç¬¦å·ï¼Œé‡è¦çš„æ˜¯åŒ…è£¹ç€ T çš„ <code>&lt;&gt;</code>ä½ å¯ä»¥æŠŠ T æ¢æˆä»»ä½•å­—ç¬¦ï¼Œæ¯”å¦‚ Bï¼ŒEï¼Œç”šè‡³æ˜¯ String è¿™ä¸ªå•è¯ï¼Œå®ƒåªæ˜¯ä¸€ç›´å¯¹æœªçŸ¥ç±»å‹çš„æŒ‡ä»£ã€‚</p>
<p>å…¶æ¬¡ï¼ŒT çš„ä½œç”¨èŒƒå›´ä»…ä»…åªæ˜¯å½“å‰ç±»æˆ–æ˜¯å½“å‰æ¥å£ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨ Repairableable è¿™ä¸ªæ¥å£ååå†åƒ Shop æ¥å£é‚£æ ·å£°æ˜å‡º T å°±è¡Œäº†ã€‚</p>
<blockquote>
<ol>
<li>å½“ä½ ç”¨ String ä½œä¸ºæ³›å‹ç±»å‹çš„æŒ‡ä»£ï¼Œé‚£ä¸æœ¬ç±»ä¸­ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„ String å†²çªæ—¶ï¼Œéœ€è¦æŠŠè¡¨ç¤ºå­—ç¬¦ä¸²çš„ String ç±»çš„åŒ…åè¿›è¡ŒæŒ‡å®šã€‚</li>
<li><code>Repairableable&lt;T&gt; extends Shop&lt;T&gt;</code> è¿™ä¸¤ä¸ª T è™½ç„¶å­—ç¬¦ä¸€æ ·ï¼Œä½†æ˜¯è¡¨ç¤ºæ„æ€ä¸ä¸€æ ·ï¼Œå‰è€…è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª<strong>ç±»å‹å‚æ•°</strong>æ˜¯ T çš„æ¥å£åæ˜¯  Repairableable çš„æ¥å£ï¼Œåè€…è¡¨ç¤ºçš„æ˜¯ï¼ŒShop æ¥å£çš„ç±»å‹å‚æ•°çš„<strong>å®é™…å€¼</strong>æ˜¯ T çš„æ¥å£ã€‚</li>
</ol>
</blockquote>
<p>å¯¹äº†ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„ HashMap ä»–æ˜¯ä¸¤ä¸ªæ³›å‹å‚æ•°ï¼Œé‚£ä¸ªæ€ä¹ˆå»å®šä¹‰çš„å‘¢ï¼Ÿ</p>
<pre><code class="language-java">public class HashMap&lt;K,V&gt;{
  public void put(K key, V value) {
  }
  
  public V get(Object key) {
      return v;
  }
}
</code></pre>
<blockquote>
<p>é HashMap æºä»£ç ï¼Œç»æ”¹åŠ¨ã€‚</p>
</blockquote>
<p>æ¥è‡ªå·±åŠ¨æ‰‹å†™ä¸€ä¸‹ã€‚</p>
<p>ç°åœ¨æœ‰ä¸€å®¶åº—ä¸ä»…å–è‹¹æœï¼Œè¿˜å–æ‰‹æœºå¡ï¼Œè¿™æ‰‹æœºå¡ï¼Œæœ‰ç§»åŠ¨ã€è”é€šã€ç”µä¿¡è¿™ä¸‰å®¶è¿è¥å•†ï¼Œä»–åˆ°åº•ä¹°çš„å“ªå®¶çš„å‘¢ï¼Ÿä¹Ÿä¸çŸ¥é“ï¼Œä¹Ÿä¸æ¸…æ¥šã€‚</p>
<pre><code class="language-java">public class ChinaMobile {
}

public class ChinaTelecom {
}

public class ChinaUnicom {
}

public interface SimShop&lt;T, S&gt; extends Shop&lt;T&gt;  {
    S buySim(String name, String id);
}

public class SimAppleShop implements AppleSimShop&lt;Apple, ChinaMobile&gt; {
    @Override
    public ChinaMobile buySim(String name, String id) {
        return null;
    }

    @Override
    public Apple buy() {
        return null;
    }

    @Override
    public int back(Apple product) {
        return 0;
    }
}
</code></pre>
<p>å“ï¼Œè¿™æ ·çœ‹èµ·æ¥æ˜¯æŒºä¸é”™çš„å“ˆï¼Œæ³›å‹æŒºå¥½ç”¨çš„å‘€ã€‚ä¸è¿‡åœ¨å®ç° SimShop çš„æ—¶å€™ï¼Œè¦æ˜¯æœ‰äººä¹±å¡«ï¼Œå†™äº†ä¸€ä¸ªä¸€ä¸ªä¸æ˜¯ä¸‰å®¶è¿è¥å•†çš„ç±»æ€ä¹ˆåŠï¼Ÿé‚£ç³»ç»Ÿä¸å°±æŠ¥é”™äº†ï¼Ÿ</p>
<p>å½“ç„¶ä¸ºäº†ï¼Œåº”å¯¹è¿™ç§æƒ…å†µï¼ŒJava ç»™å‡ºäº†è§£å†³æ–¹æ³•ï¼Œåœ¨ SimShop çš„æ¥å£å£°æ˜ä¸ŠåŠ ä¸Šé™åˆ¶ï¼Œå…·ä½“æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="language-java">public interface SimShop&lt;T, S extends Sim&gt; extends Shop&lt;T&gt;  {
    S buySim(String name, String id);
}
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼Œåœ¨å®ç° SimShop ç±»æ—¶ï¼Œå¡«å…¥çš„ç¬¬äºŒä¸ªç±»å‹å‚æ•°å¿…é¡»æ˜¯ç»§æ‰¿è‡ª Sim ç±»æˆ–å®ç°äº† Sim æ¥å£çš„ç±»ã€‚è¿™é‡Œçš„ extends æŒ‡çš„ä¸æ˜¯ç»§æ‰¿ï¼Œè€Œæ˜¯é™åˆ¶å…¶ç±»å‹å‚æ•°çš„ ç±»å‹ã€‚å¦‚æœéœ€è¦é™åˆ¶å¤šä¸ªå†…å®¹ï¼Œä½¿ç”¨ &amp; ç¬¦åˆè¿›è¡Œè¿æ¥ï¼Œä½†ä¸èƒ½å­˜åœ¨å¤šä¸ªç±»ï¼Œåªèƒ½å­˜åœ¨å¤šä¸ªæ¥å£ï¼Œå› ä¸º Java ä¸å…è®¸å¤šç»§æ‰¿ã€‚åœ¨å¤šé™åˆ¶æ¡ä»¶ä¸­ï¼Œå­˜åœ¨ç±»ï¼Œéœ€è¦æ”¾åœ¨æœ€å·¦è¾¹ã€‚ä¾‹å¦‚ï¼š</p>
<p><code>interface SimShop &lt;T, S extends View &amp; Sim &amp; Fruit &amp; Serializable&gt;</code>ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å•ä¾‹æ¨¡å¼]]></title>
        <id>https://cherrylover.github.io/post/dan-li-mo-shi</id>
        <link href="https://cherrylover.github.io/post/dan-li-mo-shi">
        </link>
        <updated>2019-05-24T03:22:51.000Z</updated>
        <content type="html"><![CDATA[<p>æœ¬æ–‡é¢˜å›¾ï¼šPhoto by <a href="https://unsplash.com/photos/bcAh4wFCBUM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Angelo Caputo</a> on <a href="https://unsplash.com/search/photos/moon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
<blockquote>
<p>æœ¬æ–‡æ˜¯è®¾è®¡æ¨¡å¼ç³»åˆ—ä¸­çš„ç¬¬äºŒç¯‡ï¼Œä¸Šä¸€ç¯‡æ˜¯ <a href="https://jiangjiwei.site/post/ze-ren-lian-mo-shi/">è´£ä»»é“¾æ¨¡å¼</a></p>
</blockquote>
<p>åœ¨è½¯ä»¶å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæ€»æ˜¯ä¼šæœŸå¾…æŸä¸€ä¸ªå¯¹è±¡åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä»…å­˜åœ¨ä¸€æ¬¡ï¼Œè¯¥æ€ä¹ˆåšï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå°±æ˜¯å¼•å…¥å•ä¾‹æ¨¡å¼è¿™ä¸ªè®¾è®¡æ¨¡å¼ï¼Œè®©è¿™ä¸ªå¯¹è±¡ä¿æŒå§‹ç»ˆåªä¼šåˆ›å»ºä¸€æ¬¡ã€‚å•ä¾‹æ¨¡å¼ä¹Ÿæ˜¯æœ‰å¤šç§å½¢å¼ï¼Œæ¥äº†è§£ä¸€ä¸‹å§ã€‚</p>
<pre><code class="language-java">Tasker tasker = new Tasker(&quot;Test&quot;);
tasker.doTask();

public class Tasker {
    private String name;

    public Tasker(String name) {
        this.name = name;
    }

    public void doTask() {
        System.out.println(name);
    }
}
</code></pre>
<p>è¿™å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ï¼Œåˆ›å»º Tasker å¯¹è±¡ï¼Œç„¶åè°ƒç”¨ä¸€æ¬¡ <code>doTask</code> æ–¹æ³•ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä¸èƒ½é€šè¿‡ä»£ç çš„æ–¹æ³•å¯¹å®ƒè¿›è¡Œé™åˆ¶å…¨å±€åªåˆ›å»ºä¸€æ¬¡ã€‚é‚£æ€ä¹ˆæ ·æ‰å¯ä»¥å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†æ„é€ æ–¹æ³•çš„è®¿é—®æƒé™è®¾ç½®ä¸º <code>private</code>ï¼Œè®¾ç½®ä¸º <code>private</code> ä¹‹åï¼Œç”±äºå¤–éƒ¨ä¸èƒ½è®¿é—®æ„é€ æ–¹æ³•ä¹Ÿå°±ä¸èƒ½è¿›è¡Œå¤šæ¬¡è°ƒç”¨æ„é€ æ–¹æ³•è·å–å¯¹è±¡äº†ã€‚</p>
<p>é‚£è®¾ç½®äº† private ä¹‹åï¼Œå¤–é¢æ€ä¹ˆè·å– Tasker å¯¹è±¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯é€šè¿‡åœ¨ Tasker å†…éƒ¨æ–°å»ºä¸€ä¸ªé™æ€æ–¹æ³• getInstanceï¼Œç„¶åé€šè¿‡é™æ€æ–¹æ³•è¿”å›ä¸€ä¸ª Tasker å¯¹è±¡ï¼Œç”±äº Tasker çš„æ„é€ æ–¹æ³•çš„è®¿é—®æƒé™æ˜¯ privateï¼Œæ‰€ä»¥åœ¨ Tasker å†…éƒ¨è®¿é—®è¿™ä¸ªæ„é€ æ–¹æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨ getInstance æ–¹æ³•å†…éƒ¨è¿›è¡Œæ£€æŸ¥éœ€è¦è¿”å›çš„å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™é€šè¿‡è°ƒç”¨æ„é€ æ–¹æ³•è¿›è¡Œå£°æ˜ä¸€ä¸ª Tasker å¯¹è±¡ï¼Œå¦‚æœä¸ä¸ºç©ºç›´æ¥è¿”å›ã€‚ç”±äº getInstance æ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Tasker é‡Œè¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ªé™æ€çš„ Taster å¯¹è±¡ã€‚</p>
<pre><code class="language-java">Tasker tasker = Tasker.getInstance();
tasker.doTask();

public class Tasker {
    private String name;
    private static Tasker sTasker;

    public static Tasker getInstance() {
        if (sTasker == null) {
            sTasker = new Tasker(&quot;Test&quot;);
        }
        return sTasker;
    }

    private Tasker(String name) {
        this.name = name;
    }

    public void doTask() {
        System.out.println(name);
    }
}
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±èƒ½å¾—åˆ°ä¸€ä¸ªç®€å•çš„å•ä¾‹å¯¹è±¡ã€‚å¹¶ä¸”è¿™ç§å½¢å¼è¢«ç§°ä¹‹ä¸º<strong>æ‡’æ±‰å•ä¾‹æ¨¡å¼</strong>ã€‚</p>
<p>è¿™æ ·å°±è¡Œäº†å—ï¼Ÿå¹¶ä¸æ˜¯ï¼Œè¿™äº›ä»£ç è¿è¡Œåœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå¯èƒ½å°±ä¼šå­˜åœ¨ä¸€ç§æƒ…å†µï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ getInstance åˆ¤æ–­ sTasker ä¸ºç©ºï¼Œæ­£åœ¨è¿›è¡Œè°ƒç”¨ Tasker çš„æ„é€ æ–¹æ³•ï¼Œåˆæœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œä¹Ÿåˆ¤æ–­ sTasker ä¸ºç©ºï¼Œè¿™æ ·å°±å†æ¬¡ä¼šè°ƒç”¨ Tasker çš„æ„é€ æ–¹æ³•ï¼Œè¿™å°±ä¸èƒ½ä¿è¯ Tasker è¿™ä¸ªç±»åœ¨ç³»ç»Ÿä¸­çš„å”¯ä¸€æ€§ã€‚é‚£è¦æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸ºä¿è¯çº¿ç¨‹å®‰å…¨ï¼ŒJava æœ‰ä¸€ä¸ªå…³é”®å­— synchronizedï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ„é€ æ–¹æ³•çš„æ—¶å€™åŠ ä¸Šè¿™ä¸ª synchronized å…³é”®å­—ï¼ŒåŒæ—¶åœ¨ sTasker å‰åŠ ä¸Š volatile å…³é”®å­—ï¼Œå°±èƒ½ä¿è¯è°ƒç”¨æ„é€ æ–¹æ³•çš„çº¿ç¨‹å®‰å…¨ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚</p>
<pre><code class="language-java">private static volatile Tasker sTasker;

public static Tasker getInstance() {
    if (sTasker == null) {
        synchronized (Tasker.class) {
            sTasker = new Tasker(&quot;Test&quot;);
        }
    }
    return sTasker;
}
</code></pre>
<p>ä½†æ˜¯è¿™ä¸ªæ˜¯çœŸçš„èƒ½ä¿è¯æ˜¯çº¿ç¨‹å®‰å…¨å—ï¼Ÿä¸è§å¾—ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹ï¼ˆAã€Bï¼‰åŒæ—¶è®¿é—® getInstance è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œç”±äºçº¿ç¨‹ A è·å–åˆ°äº† synchronized çš„é”å®šçŠ¶æ€å¹¶åˆ›å»ºäº† Tasker å¯¹è±¡ï¼Œè€Œå½“çº¿ç¨‹ B è·å–åˆ° synchronized çš„è®¿é—®çŠ¶æ€æ—¶ï¼Œç”±äº Tasker å·²ç»åœ¨çº¿ç¨‹ A è¿›è¡Œäº†åˆ›å»ºï¼Œæ­¤æ—¶çš„ sTasker å¹¶ä¸ä¸ºç©ºï¼Œä¸éœ€è¦å†æ¬¡è°ƒç”¨ æ„é€ æ–¹æ³•è¿›è¡Œè·å–ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥ï¼Œåº”è¯¥åœ¨ synchronized é”å®šçš„ä»£ç å—ä¸­å†åŠ å…¥ä¸€ä¸ªåˆ¤æ–­ sTasker æ˜¯å¦ä¸ºç©ºã€‚è¿™ç§å½¢å¼çš„å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>åŒé‡æ£€æŸ¥é”å®šå®ç°çš„æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼</strong>ã€‚</p>
<pre><code class="language-java">private static volatile Tasker sTasker;

public static Tasker getInstance() {
		if (sTasker == null) {
				synchronized (Tasker.class) {
						if (sTasker == null) {
								sTasker = new Tasker(&quot;Test&quot;);
						}
				}
		}
		return sTasker;
}
</code></pre>
<p>é‚£æˆ‘èƒ½ä¸èƒ½åœ¨å£°æ˜è¿™ä¸ªå˜é‡ï¼ˆsTaskerï¼‰çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨å…¶æ„é€ æ–¹æ³•æ¥è¿›è¡Œåˆå§‹åŒ–æ“ä½œã€‚è¿™æ ·ä¸å°±æ—¢ä¿è¯äº†å½“å‰ç±»å®ä¾‹åœ¨ç³»ç»Ÿä¸­çš„å”¯ä¸€æ€§ä¹Ÿä¿è¯äº†çº¿ç¨‹å®‰å…¨å—ï¼Ÿæ²¡é”™ï¼Œè¿™æ ·ä¹Ÿæ˜¯å•ä¾‹æ¨¡å¼çš„å¦ä¸€ç§å®ç°æ–¹å¼ï¼Œå«<strong>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼</strong>ã€‚</p>
<pre><code class="language-java">private static Tasker sTasker = new Tasker(&quot;Test&quot;);

public static Tasker getInstance() {
    return sTasker;
}
</code></pre>
<p>ä¸è¿‡ï¼Œé¥¿æ±‰å¼å•ä¾‹åœ¨å½“å‰ç±»åŠ è½½åˆ°å†…å­˜ä¸­çš„æ—¶å€™å°±è¿›è¡Œäº†åˆå§‹åŒ–æ“ä½œï¼Œå‡è®¾æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åˆ° sTaskerï¼Œé‚£å»åˆ›å»ºè¿™ä¸ª sTasker å¯¹è±¡å°±ç›¸å½“äºæ˜¯æµªè´¹äº†ï¼Œæµªè´¹å¯è€»ã€‚è€Œä¸”å½“æˆ‘ä»¬åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–è¿‡å¤šçš„èµ„æºä¿¡æ¯æ—¶ä¹Ÿä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„åŠ è½½æ—¶é•¿ã€‚ä»èµ„æºçš„ä½¿ç”¨è§’åº¦æ¥çœ‹ï¼Œé¥¿æ±‰å¼çš„å•ä¾‹æ¨¡å¼æ˜¯ä¸å¦‚åŒé‡æ£€æŸ¥çš„æ‡’æ±‰å¼çš„å•ä¾‹æ¨¡å¼çš„ï¼Œä½†åŒé‡æ£€æŸ¥çš„æ‡’æ±‰å¼å•ä¾‹ä¹Ÿæœ‰å±äºä»–è‡ªå·±çš„é—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–äº†è¾ƒå¤šçš„èµ„æºï¼Œç”±äºå¼•å…¥äº† synchronizedï¼Œæ‰€ä»¥åœ¨ getInstance æ—¶å°†å¯¼è‡´ç³»ç»Ÿæ€§èƒ½å—åˆ°ä¸€å®šçš„å½±å“ã€‚</p>
<p>é‚£å°±æ²¡æœ‰ä¸¤å…¨å…¶ç¾çš„æ–¹æ³•å—ï¼Ÿæœ‰çš„ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¹‹ä¸º Initializtion Demand Holder (IoDH)ã€‚</p>
<p>åœ¨ Java ä¸­ï¼Œé€šè¿‡åœ¨å®ä¾‹ç±»ä¸­å¢åŠ ä¸€ä¸ªé™æ€çš„å†…éƒ¨ç±»ï¼Œåœ¨å†…éƒ¨ç±»ä¸­åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œå†é€šè¿‡å•ä¾‹ç±»çš„ getInstance è¿”å›å®ä¾‹ä¾›å¤–éƒ¨ä½¿ç”¨ã€‚</p>
<pre><code class="language-java">private static class Inner {
    private static final Tasker TASKER = new Tasker(&quot;Test&quot;);
}

public static Tasker getInstance() {
    return Inner.TASKER;
}
</code></pre>
<p>ç”±äºç±»åŠ è½½æ—¶ä¸ä¼šå®ä¾‹åŒ– Tasker å¯¹è±¡ï¼Œæ‰€ä»¥åªåœ¨ è°ƒç”¨ getInstance æ–¹æ³•æ—¶æ‰ä¼šè°ƒç”¨ã€‚è€Œåœ¨è°ƒç”¨ getInstance æ—¶æ‰è¿›è¡ŒåŠ è½½ Inner ç±»å¹¶åˆ›å»ºä¸€ä¸ª Tasker å®ä¾‹ï¼Œç”± JVM ä¿è¯äº†å…¶çº¿ç¨‹å®‰å…¨ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å–„ç”¨æœç´¢]]></title>
        <id>https://cherrylover.github.io/post/shan-yong-sou-suo</id>
        <link href="https://cherrylover.github.io/post/shan-yong-sou-suo">
        </link>
        <updated>2019-05-19T11:13:59.000Z</updated>
        <summary type="html"><![CDATA[<p>æˆ‘ä¸€ç›´åœ¨ç”¨æœç´¢å¼•æ“ï¼Œåªä¸è¿‡æˆ‘ä»¥å‰ä¹Ÿæ²¡æœ‰æ„è¯†åˆ°ä¼šç”¨æœç´¢å¼•æ“æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œæ— éå°±æ˜¯æœç´¢ï¼Œè¾“å…¥å…³é”®è¯ï¼Œç„¶åç‚¹å‡»æœç´¢ã€‚å¤§å®¶ä¸éƒ½æ˜¯è¿™ä¹ˆç”¨çš„å—ï¼Ÿç›´åˆ°æˆ‘æœ€è¿‘ç»å†çš„ä¸€ä»¶äº‹æƒ…ã€‚</p>
]]></summary>
        <content type="html"><![CDATA[<p>æˆ‘ä¸€ç›´åœ¨ç”¨æœç´¢å¼•æ“ï¼Œåªä¸è¿‡æˆ‘ä»¥å‰ä¹Ÿæ²¡æœ‰æ„è¯†åˆ°ä¼šç”¨æœç´¢å¼•æ“æœ‰ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œæ— éå°±æ˜¯æœç´¢ï¼Œè¾“å…¥å…³é”®è¯ï¼Œç„¶åç‚¹å‡»æœç´¢ã€‚å¤§å®¶ä¸éƒ½æ˜¯è¿™ä¹ˆç”¨çš„å—ï¼Ÿç›´åˆ°æˆ‘æœ€è¿‘ç»å†çš„ä¸€ä»¶äº‹æƒ…ã€‚</p>
 <!-- more --> 
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/20190519132136.png" alt=""></p>
<p>è¿™ä¸ªå›¾é‡Œé¢çš„çº¢æ¡†æ¡†æŸ±çš„å­—ï¼Œæ˜¯ä¸€ä¸ªæç¤ºæ–‡å­—ï¼ŒåŒæ ·çš„å·¥å…·ä¸Šï¼Œåˆ«äººçš„æœ‰è¿™ä¸ªæç¤ºæ–‡å­—ï¼Œæˆ‘æ²¡æœ‰ï¼Œè€Œä¸”æˆ‘è¿˜æƒ³è¦æœ‰æ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®è¿™æ— éå°±æ˜¯ä¸€ä¸ªè®¾ç½®è€Œå·²ï¼ŒæŠŠè®¾ç½®æ‰“å¼€å°±èƒ½æ˜¾ç¤ºã€‚ä½†å…³é”®æ˜¯ï¼Œåœ¨ä¼—å¤šè®¾ç½®é€‰é¡¹ä¸­ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“æ˜¯å“ªä¸€ä¸ªè®¾ç½®é€‰é¡¹å‘¢ï¼Ÿ</p>
<p>æ–¹æ³•æœ‰ä¸¤ä¸ªå…¶ä¸€æ˜¯æ‰¾äººé—®ï¼Œå…¶äºŒæ˜¯é—®æœç´¢å¼•æ“ã€‚è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œé—®äººæˆ‘å¯ä»¥ç›´æ¥æŠŠå›¾å‘ç»™å¯¹æ–¹ç”šè‡³æ˜¯å‘ä¸€ä¸ªç¾¤é‡Œéƒ½è¡Œï¼Œäº‹å®ä¸Šï¼Œæˆ‘ä¹Ÿè¿™ä¹ˆåšäº†ã€‚ä¸è¿‡ä¸æ˜¯æ‰€æœ‰äººéƒ½åœ¨ç­‰ç€ä½ æŠ›å‡ºé—®é¢˜ï¼Œç„¶åå»ç»™ä½ è§£ç­”çš„ï¼Œå¾ˆæœ‰å¯èƒ½ä½ ç­‰äº†å¾ˆä¹…éƒ½æ²¡äººå›å¤ï¼Œå¯èƒ½å› ä¸ºä¸çŸ¥é“ï¼Œå¯èƒ½å› ä¸ºæ²¡çœ‹åˆ°ï¼Œæ‰€ä»¥æ—¶é—´ä¸å—æ§åˆ¶ï¼Œæœ‰å¯èƒ½ç­‰æ­£ç¡®ç­”æ¡ˆåˆ°ä½ æ‰‹ä¸­çš„æ—¶å€™ï¼Œå·²ç»è¿‡å»ä¸€å¤©äº†ã€‚ç¬¬äºŒç§æ–¹æ³•åˆ™ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œé™¤éä½ å®¶ç½‘ä¸è¡Œï¼Œæˆ–è€…ä½ é—®é¢˜æè¿°çš„ä¸å¤Ÿå‡†ç¡®ã€‚ä¸ç„¶çš„è¯ï¼Œç™¾åº¦æˆ–æ˜¯è°·æ­Œåº”è¯¥éƒ½èƒ½åœ¨ 1 åˆ†é’Ÿä¹‹å†…ç»™ä½ ç­”å¤ã€‚</p>
<p>æˆ‘è‹¦äºä¸çŸ¥é“è¯¥æ€ä¹ˆå‡†ç¡®çš„æè¿°å‡ºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°±åœ¨ç¾¤é‡Œå‘èµ·äº†æé—®ï¼Œä¸åˆ°ä¸‰åˆ†é’Ÿï¼Œä¸€ä½æœ‹å‹å°±å›ç­”äº†ï¼Œå¯æ˜¯å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜ï¼Œæˆ‘å¼€å§‹å°è¯•ç€å‘æœç´¢å¼•æ“å¯»æ±‚å¸®åŠ©ï¼Œç»ˆäºç»è¿‡<strong>æ›´æ”¹ä¸€æ¬¡å…³é”®è¯</strong>ï¼Œä»¥åŠ<strong>æŸ¥é˜…ä¸¤ç¯‡æœç´¢ç»“æœ</strong>ä¹‹åï¼Œæ‰¾åˆ°äº†æ­£ç¡®å¤„ç†çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™å¦ä¸€ä½ç¾¤å‹å‡ºæ¥å¸®æˆ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚è™½ç„¶æˆ‘å·²ç»é€šè¿‡æœç´¢å¼•æ“è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿˜æ˜¯å‘ä»–è¡¨ç¤ºäº†æ„Ÿè°¢ã€‚</p>
<p>åœ¨è¿™ä¸ªäº‹ä»¶ä¸­ï¼Œçœ‹èµ·æ¥è§£å†³é—®é¢˜çš„ä¸¤ç§æ–¹æ³•è¯è´¹çš„æ—¶é—´æ˜¯ä¸€æ ·çš„ï¼Œä½†åªæ˜¯æˆ‘è¶³å¤Ÿå¹¸è¿çš„é‡ä¸Šäº†åŠæ—¶å›ç­”çš„ç¾¤å‹ï¼Œè€Œæ›´å¯é çš„åˆ™æ˜¯å‡ ä¹ä¸ä¼šä¸ç†ä½ çš„æœç´¢å¼•æ“ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä¹Ÿé‡åˆ°è¿‡åŒæ ·æ˜¯ä½¿ç”¨æœç´¢å¼•æ“ï¼Œä¸¤ä¸ªäººæœç´¢å‡ºæ¥çš„ç»“æœå‡ ä¹æ²¡æœ‰ç›¸åŒçš„ï¼ŒæŠ›å¼€æœç´¢å¼•æ“æ ¹æ®ä½ çš„å†å²è®°å½•è€Œäº§ç”Ÿçš„åå¥½æœç´¢ï¼Œæ›´ä¸ºå…³é”®æ˜¯ä½ è¾“å…¥çš„å…³é”®è¯ã€‚åœ¨ä¸Šé¢é‚£ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘æ›´æ”¹äº†ä¸€æ¬¡å…³é”®å­—ï¼Œæ˜¯å› ä¸ºç¬¬ä¸€æ¬¡è¾“å…¥çš„å…³é”®è¯ï¼Œæˆ‘åœ¨æ²¡æœ‰ç‚¹å¼€æœç´¢ç»“æœï¼Œä»…é æ¯ä¸ªæœç´¢ç»“æœçš„æ ‡é¢˜å°±å¾—å‡ºè¿™äº›ç»“æœä¸å¯ä¿¡çš„ç­”æ¡ˆã€‚äºæ˜¯ï¼Œæˆ‘æ›´æ”¹äº†å…³é”®è¯ã€‚</p>
<p>äº‹å®ä¸Šï¼Œé’ˆå¯¹äºæœç´¢å¼•æ“ï¼Œæˆ‘ä»¬åº”è¯¥åšåˆ°å°½é‡çš„å‡å°‘å…³é”®è¯çš„é•¿åº¦ï¼Œå­¦ä¼šå°†å…·ä½“çš„é—®é¢˜è¿›è¡Œæ¦‚æ‹¬ï¼Œèƒå–å‡ºå…³é”®è¯ï¼Œè¿™æ ·èƒ½æ›´ä¸ºå‡†ç¡®çš„å¾—åˆ°æœç´¢ç»“æœã€‚</p>
<blockquote>
<p>è°·æ­Œå’Œç™¾åº¦çš„æœç´¢å†…å®¹éƒ½æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ã€‚</p>
<p>å½“ä½ æ˜ç¡®çš„çŸ¥é“æœç´¢ç»“æœï¼Œæ¯”å¦‚æœä¸€ç¯‡åä¸ºï¼Œå®ç”¨å·¥å…·Wox çš„æ–‡ç« ï¼Œä½ å°±èƒ½åœ¨æœç´¢ç»“æœçš„ç¬¬ä¸€æ¡å¾—åˆ°ä½ æƒ³è¦çš„ç­”æ¡ˆã€‚</p>
</blockquote>
<p>æœ‰äº›æ—¶å€™ï¼Œæœç´¢å¼•æ“çš„æœç´¢ç»“æœå¹¶ä¸æ˜¯é‚£ä¹ˆå¥½ï¼Œæˆ‘ä»¬è‡ªå·±å¯èƒ½æœ‰ä¸€ä¸ªå¿ƒé‡Œçš„é¢„è®¾ï¼Œè§‰å¾—çŸ¥ä¹ä¸Šï¼Œæˆ–æ˜¯ stackoverflow ä¸Šå¯èƒ½ä¼šæœ‰ç­”æ¡ˆï¼Œä½†ç›´æ¥è¿™äº›ç½‘ç«™çš„æœç´¢çœŸçš„å¾ˆä¸å¥½ç”¨ï¼Œæ€ä¹ˆåŠï¼Ÿæ²¡å…³ç³»ï¼Œæœç´¢å¼•æ“è€ƒè™‘åˆ°äº†è¿™ä¸ªäº‹æƒ…ï¼Œæ‰€ä»¥æœ‰ä¸ªå…³é”®è¯ï¼Œsiteï¼Œå…·ä½“ä½¿ç”¨å°±æ˜¯ï¼Œåœ¨ä½ çš„å…³é”®è¯åé¢è¾“å…¥ <code>ç©ºæ ¼site:ç½‘ç«™åŸŸå</code>ã€‚è¯•è¯•å¤åˆ¶ä¸‹é¢çš„æ–‡å­—ï¼Œè¿›è¡Œæœç´¢ï¼Œæœç´¢å‡ºæ¥çš„æ‰€æœ‰ç»“æœéƒ½æ˜¯æ¥è‡ªçŸ¥ä¹ã€‚</p>
<blockquote>
<p>å¿«é—ª PPT site:zhihu.com</p>
</blockquote>
<p>å¦‚æœè®°ä¸ä½çš„è¿™æ ·çš„ä½¿ç”¨æ–¹å¼çš„è¯ï¼Œç™¾åº¦è¿˜å¯ä»¥é€šè¿‡è®¾ç½®è¿›è¡Œï¼Œç‚¹å‡»ä¸‹å›¾ä¸­çš„çº¢è‰²é€‰ä¸­åŒºåŸŸï¼Œä½ å°±èƒ½å‘ç°ï¼Œæ¥è‡ªæœç´¢å¼•æ“æ”¯æŒçš„å¤šç§æœç´¢æŠ€å·§ï¼ŒåŒ…æ‹¬å‡ºç°æ—¶é—´ï¼Œæœç´¢ç»“æœç±»å‹ï¼Œä»¥åŠæŸ¥è¯¢ç«™ç‚¹ã€‚è€Œ <code>site:zhihu.com</code> å°±æ˜¯åˆ©ç”¨äº†è®¾ç½®æŸ¥è¯¢ç«™ç‚¹ã€‚</p>
<p><img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/20190519182103.png" alt=""></p>
<p>çœ‹äº†è¿™ä¸ªä¹‹åä½ å°±å¯ä»¥é€šè¿‡ä½¿ç”¨å…³é”®è¯åŠ ç«™ç‚¹çš„æ–¹å¼æ‰¾åˆ°çŸ¥ä¹ä¸Šå…³äºå¦‚æœé«˜æ•ˆä½¿ç”¨æœç´¢å¼•æ“çš„æ–¹æ³•ï¼Œæ¥å­¦ä¹ æ›´å¤šå…³äºæœç´¢å¼•æ“çš„å°æŠ€å·§ã€‚</p>
<p>æœ¬æ–‡é¢˜å›¾ï¼šPhoto by <a href="https://unsplash.com/photos/I_LgQ8JZFGE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">JoÃ£o Silas</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[For Free]]></title>
        <id>https://cherrylover.github.io/post/for-free</id>
        <link href="https://cherrylover.github.io/post/for-free">
        </link>
        <updated>2019-05-13T15:50:27.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>å…è´¹çš„æ°¸è¿œæ˜¯æœ€è´µçš„ã€‚</p>
</blockquote>
<p>è¿™å¥è¯æœ€æ—©æ˜¯é©¬äº‘åœ¨ä¸€ä¸ªèŠ‚ç›®ä¸Šè¯´å‡ºæ¥çš„ï¼Œé‚£æ—¶å€™çš„æˆ‘è¿˜æ˜¯ä¸€ä¸ªè¿å¤§å­¦æ ¡é—¨éƒ½ä¸çŸ¥é“æœå“ªçš„é«˜ä¸­ç”Ÿã€‚å½“æ—¶åªè§‰å¾—å‘µå‘µï¼Œæœ‰é’±äººå°±æ˜¯ä¸ä¸€æ ·ï¼Œéå¾—è‡ªå·±èŠ±é’±å—ï¼Ÿç›´åˆ°æˆ‘ä½“ä¼šåˆ°ä»–æ‰€è¯´çš„çœŸæ­£å«ä¹‰ã€‚</p>
<p>ä»æˆ‘å¬è¯´è¿™å¥è¯ï¼Œåˆ°å†™ä¸‹è¿™ç¯‡æ–‡ç« ï¼Œä¹Ÿå·®ä¸å¤šæœ‰å‡ å¹´çš„æ—¶é—´äº†ï¼Œè¿™å‡ å¹´çš„æ—¶é—´ï¼Œæˆ‘æ…¢æ…¢çš„è¿›è¡Œäº†è½¬å˜ã€‚</p>
<p>å°è±¡è·Ÿæ„Ÿè§¦æœ€æ·±çš„æ˜¯ä¸¤ä»¶äº‹ã€‚å…ˆè¯´ç¬¬ä¸€ä»¶ï¼Œæˆ‘å¸®ä¸€ä¸ªæœ‹å‹ç¿»è¯‘æ–‡ç« ã€‚ä»–ç»™äº†æˆ‘ä¸€ç¯‡ PDF æ ¼å¼çš„æ–‡ç« ï¼Œé‡Œé¢çš„æ ¼å¼ä¸å¤ªå¥½ï¼Œæˆ‘è½¬æˆäº† Word ç„¶ååšäº†é‡æ–°æ’ç‰ˆï¼Œæƒ³ç€ç›´æ¥ä¸¢åˆ°è°·æ­Œç¿»è¯‘ä¸Šä¸å°±è¡Œäº†ï¼Œæ¯•ç«Ÿä»¥å‰ä¹Ÿåšè¿‡è¿™ä¸ªã€‚è¿˜æ˜¯æŒºå–œæ¬¢è°·æ­Œç¿»è¯‘çš„ï¼Œç¿»è¯‘å‡ºæ¥ä¹‹åï¼Œæˆ‘å°è¯•è¿›è¡Œå…¨é€‰å¤åˆ¶ï¼Œç„¶åå‘ç°å­—ä½“æ ·å¼å®åœ¨æ˜¯éš¾æã€‚æäº†ä¸€ä¼šä¹‹åï¼Œæˆ‘åœ¨æƒ³ï¼Œè°·æ­Œæ˜¯è¿™æ ·çš„ï¼Œæˆ‘å»çœ‹çœ‹å›½å†…çš„å¹³å°æ˜¯æ€ä¹ˆåšçš„ã€‚</p>
<p>æˆ‘å°±å»äº†æœ‰é“ç¿»è¯‘ï¼Œè¯•ç€æŠŠåŸæ–‡æ¡£ä¼ ä¸Šå»äº†ï¼Œç„¶åæƒŠå¥‡çš„å‘ç°ï¼Œæ•´ä½“çš„æ ¼å¼ï¼Œä»¥åŠä¸­è‹±æ–‡å¯¹ç…§ï¼Œåšçš„éƒ½å¾ˆä¸é”™ï¼Œè€Œä¸”å¾ˆè´´å¿ƒçš„ç»™äº†ä¸€ä¸ªä¸‹è½½ç¿»è¯‘åçš„æ–‡æ¡£çš„åŠŸèƒ½ï¼Œæˆ‘ç‚¹å‡»ä¸Šå»å‘ç°ï¼Œéœ€è¦ç™»å½•ï¼Œç„¶åä»˜æ¬¾ 5 å…ƒæ‰èƒ½ä¸‹è½½ã€‚</p>
<p>å¯¹æ¯”ä½¿ç”¨è°·æ­Œç¿»è¯‘çš„ä¸€æ­¥æ­¥æ“ä½œï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œæˆ‘åªè¦ä½ å¸®æˆ‘è§£å†³é—®é¢˜å³å¯ã€‚è°·æ­Œè™½ç„¶ä¹Ÿèƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯å´é™„å¸¦ç€ç»™æˆ‘å¸¦æ¥äº†ä¸€äº›æˆ‘æœ¬ä¸éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚è¿™ä¸€ç‚¹ä½“éªŒçœŸçš„ä¸å¤ªå¥½äº†ã€‚æ¯”å¦‚å½“æˆ‘å¯èƒ½æ—¶é—´ä¸å¤ªå……è£•ï¼Œç€æ€¥è¦ç»“æœï¼Œæˆ‘å¯èƒ½å°±ä¼šå»èŠ±é‚£ä¸ªé’±ç¿»è¯‘ä¸€ä¸‹ï¼Œè€Œä¸ä¼šä½¿ç”¨è°·æ­Œç¿»è¯‘ï¼Œè™½ç„¶æˆ‘æ—¥å¸¸ä½¿ç”¨éƒ½æ˜¯ç”¨è°·æ­Œç¿»è¯‘ï¼Œä½†ä¹Ÿä¸å¤ªä¼šåœ¨è¿™ä»¶äº‹æƒ…ä¸Šåå¿ƒã€‚</p>
<p>ç¬¬äºŒä»¶äº‹æƒ…ï¼Œæ˜¯å…³äºæˆ‘ä¸ªäººç½‘ç«™çš„å›¾åºŠã€‚å›¾åºŠå°±æ˜¯ä¸€ä¸ªç½‘ç»œä¸Šç”¨æ¥å­˜æ”¾å›¾ç‰‡çš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼Œä½ æŠŠä¸€å¼ å›¾ç‰‡æ”¾åœ¨å¾®åšä¸Šï¼Œç„¶åæ‹¿åˆ°é‚£ä¸ªå›¾ç‰‡çš„é“¾æ¥ï¼Œä½ å°±éšæ„çš„ä½¿ç”¨äº†ï¼Œä¸ç”¨æ‹…å¿ƒå ç”¨è‡ªå·±çš„ç©ºé—´ã€‚äº‹å®ä¸Šï¼Œæˆ‘æœ€æ—©ç”¨çš„å°±æ˜¯å¾®åšçš„å›¾åºŠï¼Œå¯æ˜¯ï¼Œæˆ‘æ€»æ‹…å¿ƒä¼šå‡ºä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘å°±æ³¨å†Œäº†ä¸ƒç‰›ï¼Œç„¶åå®åè®¤è¯é€ç©ºé—´ï¼Œä¹Ÿèƒ½å¥½å¥½çš„ç”¨ï¼Œç›´åˆ°æœ‰ä¸€å¤©ï¼Œä¸èƒ½å¥½å¥½ç”¨äº†ï¼Œä½†æ˜¯ï¼Œæˆ‘å¯ä»¥åšä¸€äº›è®¤è¯è®¾ç½®(æ·»åŠ è‡ªå®šä¹‰åŸŸåï¼ŒåŸŸåå¤‡æ¡ˆç­‰ç­‰)ç„¶åç»§ç»­ä½¿ç”¨ï¼Œæˆ‘ä¹Ÿå»åšäº†ï¼Œå¯æ˜¯è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ç›´åˆ°ç°åœ¨ä¹Ÿæ²¡å®Œå…¨ç»“æŸï¼Œè€Œä¸”ä¸­é—´è¿˜èŠ± 100+ å…ƒã€‚</p>
<p>æœ€åï¼Œæˆ‘æ”¾å¼ƒäº†ï¼Œæ‹¥æŠ±äº†é˜¿é‡Œäº‘ï¼Œåœ¨é˜¿é‡Œäº‘èŠ±é’±å¼€äº†å­˜å‚¨æœåŠ¡ï¼Œç„¶åä¸€ç›´åœ¨ç”¨ï¼Œå…¶å®ç”¨æ¥é˜¿é‡Œäº‘ä¸Šçš„é’±ä¹Ÿä¸å¤šï¼Œä¹‹å‰ï¼Œç²—ç•¥ä¼°è®¡ä¸€ä¸‹ä¹‹å‰èŠ±åœ¨è®¾ç½®ä¸ƒç‰›äº‘ä¸Šçš„ 100 å¤šå¦‚æœè€è€å®å®ç”¨é˜¿é‡Œäº‘çš„å›¾ç‰‡å­˜å‚¨æœåŠ¡çš„è¯ï¼Œä¼°è®¡èƒ½ç”¨ä¸€å¹´å¤šã€‚è¿™ä¸­é—´ï¼Œæˆ‘æ—¢èŠ±è´¹äº†æ—¶é—´ï¼ˆè‡³å°‘æœ‰ä¸€ä¸ªä¸‹åˆçš„æ—¶é—´èŠ±åœ¨ç ”ç©¶å¤‡æ¡ˆï¼ŒåŸŸåè¿™äº›é—®é¢˜ä¸Šï¼‰ï¼Œåˆæ­ä¸Šé’±ã€‚ç»“æœâ€¦â€¦</p>
<p>æˆ‘å¼„å®Œé˜¿é‡Œäº‘ä¹‹åï¼Œæˆ‘å°±æƒ³åˆ°äº†ï¼Œå…¶å®å…è´¹ï¼Œè¯´æ˜¯å…è´¹ï¼Œåªæ˜¯ä»£ä»·ä¸æ˜¯é‡‘é’±ï¼Œè€Œä¸”å…¶ä»–ä¸œè¥¿ï¼Œå¯èƒ½æ˜¯æ—¶é—´ï¼Œç²¾åŠ›ï¼Œç”šè‡³æ˜¯ä¸­å›½äººè®²çš„äººæƒ…ã€‚è€Œè¿™äº›ä¸œè¥¿æ°æ°éƒ½æ˜¯é‡‘é’±æ‰€ä¸èƒ½ç›´æ¥ç­‰ä»·ä»£æ¢çš„ã€‚å¯èƒ½åœ¨å…è´¹ï¼Œçœå»äº†ä½ çš„é‡‘é’±ï¼Œå¯æ˜¯ä½ åœ¨å…¶ä»–æ–¹é¢çš„æ”¯å‡ºè¿œè¿œè¶…è¿‡å…¶æ‰€å…·æœ‰çš„é‡‘é’±çš„ä»·å€¼ã€‚</p>
<p>æœ€åï¼Œå¯¹è±¡çœ‹åˆ°æˆ‘åœ¨æ‰¾æœ¬æ–‡é¢˜å›¾ï¼Œè¯´ä¸ºä»€ä¹ˆä¸æ”¾æˆ‘çš„ç…§ç‰‡ï¼Œç„¶åæˆ‘å°±æ”¾äº†æˆ‘å¯¹è±¡çš„ç…§ç‰‡ï¼ˆä»Šå¤©çš„é¢˜å›¾ä¹Ÿæ˜¯å¥¹ä¹‹å‰æ‹çš„ï¼‰ã€‚<br>
<img src="https://monster-image-backup.oss-cn-shanghai.aliyuncs.com/picgo/UNADJUSTEDNONRAW_thumb_19d.jpg" alt="æˆ‘å¯¹è±¡"></p>
]]></content>
    </entry>
</feed>